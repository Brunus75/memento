# MEMENTO FLUTTER


## RESSOURCES

**VEILLE**
* https://twitter.com/FlutterDev
* https://twitter.com/FlutterComm
* https://twitter.com/flutterwk
* https://twitter.com/fluttertap
* https://twitter.com/FlutterTip
* https://twitter.com/flutterize
* https://twitter.com/JohannesMilke
* https://twitter.com/biz84
* https://twitter.com/remi_rousselet
* https://twitter.com/csells
* https://medium.com/@durannumit
* https://www.reddit.com/r/FlutterDev/top/?t=week
* The top 45 must-follow Flutter experts on Twitter : https://blog.codemagic.io/top-flutter-developers-to-follow-on-twitter/

**DART & FLUTTER**
* Doc Dart : https://dart.dev/
* DartPad : https://dartpad.dev/dart
* Doc Flutter : https://flutter.dev/docs/get-started/install
* Page YT Flutter :  https://www.youtube.com/channel/UCwXdFgeE9KYzlDdR7TG9cMw/videos
* Palette des couleurs : https://api.flutter.dev/flutter/material/Colors-class.html
* Liste des ic√¥nes : https://material.io/resources/icons/?style=baseline
* Ic√¥nes : https://www.fluttericon.com/
* Material Palette (cr√©er une palette, voir les nuances des couleurs et chercher une icone) : https://www.materialpalette.com/
* The Flutter Cookbook : https://flutter.dev/docs/cookbook
* Une communaut√© francophone Flutter : http://fr.flutterdev.net/
* Communaut√© Flutter : https://gitter.im/flutter/flutter
* Widget catalog : https://flutter.dev/docs/development/ui/widgets
* Top Flutter packages : https://pub.dev/flutter/packages
* https://www.reddit.com/r/FlutterDev/
* https://github.com/flutter/flutter
* https://medium.com/flutter
* Catalogue d‚Äôapplications Flutter d√©velopp√©es par la communaut√© : https://github.com/flutter/samples/blob/master/INDEX.md
* Making Dart a Better Language for UI : https://medium.com/dartlang/making-dart-a-better-language-for-ui-f1ccaf9f546c
* What is unit of measurement in flutter : https://stackoverflow.com/questions/50596099/what-is-unit-of-measurement-in-flutter
* https://stackoverflow.com/questions/43854647/flutter-how-does-it-work-behind-the-scenes
* Flutter 1.20 ‚Äî What‚Äôs New In Flutter : https://medium.com/flutterdevs/flutter-1-20-whats-new-in-flutter-840d269f173e
* Announcing Flutter 1.20 : https://medium.com/flutter/announcing-flutter-1-20-2aaf68c89c75
* Google‚Äôs Flutter SDK can now make apps for Windows too : https://9to5google.com/2020/09/23/flutter-sdk-windows-alpha/
* Announcing Flutter 1.22 : https://medium.com/flutter/announcing-flutter-1-22-44f146009e5f
* Guides for migrating code across a breaking change : https://flutter.dev/docs/release/breaking-changes

**TO READ**
* ~ A Guide to Using Futures in Flutter for Beginners : https://medium.com/flutter-community/a-guide-to-using-futures-in-flutter-for-beginners-ebeddfbfb967
* ~ Flutter: Push, Pop, Push : https://medium.com/flutter-community/flutter-push-pop-push-1bb718b13c31
* ~ Flutter State Management at Google I/O 2019 : https://youtu.be/d_m5csmrf7I
* ~ Why Is My Future/Async Called Multiple Times? https://flutterigniter.com/future-async-called-multiple-times/
* ~ https://medium.com/saugo360/flutter-my-futurebuilder-keeps-firing-6e774830bc2
* New tools for Flutter developers, built in Flutter : https://medium.com/flutter/new-tools-for-flutter-developers-built-in-flutter-a122cb4eec86
* Dart DevTools : https://www.youtube.com/watch?v=nq43mP7hjAE&feature=youtu.be
* https://medium.com/@DavidMPotter/list-comprehensions-in-dart-a57d3a06b703
* https://medium.com/flutter-community/useful-list-methods-in-dart-6e173cac803d
* https://medium.com/flutter-community/detect-flutter-drawer-open-and-close-21a2250b3606
* https://medium.com/flutter-community/flutter-deep-dive-part-4-renderflex-children-have-non-zero-flex-77734ca0b5c
* Flutter: State Management using an MVC+S Architecture : https://blog.gskinner.com/archives/2020/09/flutter-state-management-with-mvcs.html
* Multiple Themes in Flutter | Dark and Light Theme Flutter Stacked : https://www.filledstacks.com/post/multiple-themes-in-flutter-dark-and-light-theme-flutter-stacked/
* https://medium.com/flutterpub/flutter-7-bottom-navigation-with-floating-button-9190648372fd
* https://codewithandrea.com/articles/2018-09-13-bottom-bar-navigation-with-fab/
* https://www.raywenderlich.com/6373413-state-management-with-provider
* Windows fun with Dart FFI : https://medium.com/@timsneath/windows-fun-with-dart-ffi-687c4619e78d
* Announcing Flutter Windows Alpha : https://medium.com/flutter/announcing-flutter-windows-alpha-33982cd0f433
* https://riverpod.dev/docs/getting_started
* Using two or more different versions of Flutter on single machine : https://medium.com/@sarbagyastha/using-two-or-more-different-versions-of-flutter-in-single-machine-484293c2a7ff
* https://github.com/flutter/flutter/issues/54776
* Learning Flutter‚Äôs new Navigation and Routing system : https://medium.com/flutter/learning-flutters-new-navigation-and-routing-system-7c9068155ade
* Internationalization in Flutter 1.22+ : https://pascalw.me/blog/2020/10/02/flutter-1.22-internationalization.html
* Make 2048 With Flutter : https://www.youtube.com/watch?v=QEqLobOif3Y&feature=emb_logo
* Day and Night Mood Animation - Flutter Animation - Speed Code : https://www.youtube.com/watch?v=uS_SoJWzRXY&feature=emb_logo
* Navigation done right: a case for hierarchical routing with Flutter : https://medium.com/flutter-community/navigation-done-right-a-case-for-hierarchical-routing-with-flutter-ca0aac1275ad
* dismissible_actions_example : https://github.com/JohannesMilke/dismissible_actions_example
* Use different versions of Flutter SDK at once in one laptop using FVM : https://medium.com/jeeapex/use-different-versions-of-flutter-sdk-at-once-in-one-laptop-using-fvm-edefa184a7d3
* Using Different Versions of Flutter Simultaneously with FVM : https://developermemos.com/posts/different-versions-flutter-fvm
* Flutter Forms Validation ‚Äî the Ultimate Guide : https://medium.com/flutter-community/flutter-forms-validation-the-ultimate-guide-1b469169ca6e
* Complete Movie App ‚Äî Language Management (8) : https://medium.com/flutter-community/complete-movie-app-language-management-8-1c3b8613156d
* Flutter Custom Paint - Made Easy with Flutter Shape Maker üéØ : https://retroportalstudio.medium.com/auto-generate-flutter-custom-paint-code-flutter-shape-maker-be51e41daf89
* Dart Beginners Course - Tutorial #07: Data Processing in Dart : https://www.youtube.com/watch?v=mBHsuyL_-NI


**TO UNDERSTAND**
* FutureBuilder performance issue
* When to use private variable
* Run multiple Flutter versions in the same project concurrently

**ROADMAP**
* https://github.com/DroidsOnRoids/flutter-roadmap
* https://github.com/olexale/flutter_roadmap

**TUTOS**
* https://www.udemy.com/course/flutter-bootcamp-with-dart/
* https://www.udemy.com/course/flutter-dart-creez-des-applications-pour-ios-et-android/
* #1 Fluter: T√©l√©charger, Installer et Configurer Flutter SDK sur Windows : https://www.youtube.com/watch?v=P4Ua8cK_TeA&

**DOCS**
* 100 awesome Flutter tips : https://github.com/erluxman/awesomefluttertips
* A list of Free Flutter resources that will help people get started with Flutter : https://github.com/FlutterTutorial/FlutterResources
* Tomek's Flutter Layout Cheat Sheet : https://medium.com/flutter-community/flutter-layout-cheat-sheet-5363348d037e
* Flutter-Course-Resources : https://github.com/londonappbrewery/Flutter-Course-Resources
* D√©bat Map vs. Switch : https://github.com/londonappbrewery/destini-challenge-completed/commit/69ed867992fc05f13a4fbef452173a956312993d
* Comment J‚Äôapprends Flutter ? : https://medium.com/@q.cornu/comment-japprends-flutter-412add79848c
list=PLjA66rpnHbWnTTzp3QYykoAHkCriViEDo  
* Roadmap des √©lements √† conna√Ætre : https://www.ambient-it.net/wp-content/uploads/pdf/Annexe-1-Fiche-descriptive-formation-flutter-dart.pdf
* ‚ÄúA month of Flutter‚Äù : https://bendyworks.com/blog/a-month-of-flutter
* https://www.facebook.com/pg/CodaBeeOfficial/posts/?ref=page_internal
* Codabee Flutter: le forum d'entraide : https://www.facebook.com/groups/225660591356238
* Dart Async Library : https://api.flutter.dev/flutter/dart-async/dart-async-library.html
* https://www.didierboelens.com/fr/
* CHEATSHEET TRANSPARENCY HEXADECIMAL : https://gist.github.com/lopspower/03fb1cc0ac9f32ef38f4
* Compiled List of Flutter Newsletters : https://medium.com/@bleyldev/compiled-list-of-flutter-newsletters-ee040a0b136f
* Flutter‚Äôs Stateful Widget cheat sheet : https://itnext.io/flutters-stateful-widget-cheat-sheet-2188f1dc3d07
* Flutter Hooks, say goodbye to StatefulWidget and reduce boilerplate code : https://medium.com/flutter-community/flutter-hooks-say-goodbye-to-statefulwidget-and-reduce-boilerplate-code-8573d4720f9a
* Size matters: Reducing Flutter App size best practices : https://medium.com/@suryadevsingh24032000/size-matters-reducing-flutter-app-size-best-practices-ca992207782
* Introduction to Animation in Flutter : https://medium.com/flutterdevs/introduction-to-animation-in-flutter-954dbaadc0eb
* How to implement autofill in your Flutter app : https://medium.com/swlh/how-to-implement-autofill-in-your-flutter-app-b43bddab1a97
* Cheatsheet Flutter : https://pbs.twimg.com/media/EjEe3drU4AIsHo5?format=jpg&name=large
* Learning Flutter‚Äôs new Navigation and Routing system : https://medium.com/flutter/learning-flutters-new-navigation-and-routing-system-7c9068155ade
* Parsing complex JSON in Flutter : https://medium.com/flutter-community/parsing-complex-json-in-flutter-747c46655f51
* Flutter Deep Dive : https://github.com/refactord/flutter-deep-dive
* How to secure API keys? : https://www.reddit.com/r/FlutterDev/comments/jhdwq8/how_to_secure_api_keys/
* Building a Movie App in 10 Minutes with Flutter : https://www.youtube.com/watch?v=soTEOI_rIIQ&feature=emb_logo
* Flutter Debugging 101 : https://www.youtube.com/watch?reload=9&v=Z0_bCYlgZlw&ab_channel=BleylDev

**TESTING**
* Flutter Testing For Beginners - The Ultimate Guide : https://www.reddit.com/r/FlutterDev/comments/j947hw/flutter_testing_for_beginners_the_ultimate_guide/
* https://flutter.dev/docs/cookbook#testing
* Flutter Automated Testing. Step-by-Step Guide : https://www.mobindustry.net/flutter-automated-testing-step-by-step-guide
* https://medium.com/flutterpub/writing-and-running-widget-tests-from-android-studio-d63b9fea21c5


**ANDROID STUDIO**
* Android Studio 4.0 s'accompagne d'une interface pour l'√©dition de mouvement, propose la validation de la mise en page : https://android.developpez.com/actu/304550/Android-Studio-4-0-s-accompagne-d-une-interface-pour-l-edition-de-mouvement-propose-la-validation-de-la-mise-en-page-et-apporte-la-prise-en-charge-de-Clangd-pour-le-developpement-Cplusplus/

**ASSETS**
* https://www.canva.com/fr_fr/
* https://icons8.com/
* https://fr.vecteezy.com/

**TOOLS**
* RGB to HEX > https://www.google.com/search?client=firefox-b-d&q=rgb+to+hex

**AWESOME PROJECTS**
* https://github.com/2d-inc/HistoryOfEverything

**JSON**
* Instantly parse JSON in any language : https://app.quicktype.io/#l=dart, exemple : https://app.quicktype.io/?share=4Ik8Upww0mN33e2CBVmq
* Json to Dart Converter : https://javiercbk.github.io/json_to_dart/


## SOMMAIRE

* [RESSOURCES](#ressources)
* [FLUTTER](#flutter)   
   * [GLOSSAIRE](#glossaire)
   * [GUIDELINES](#GUIDELINES)
   * [CONSEILS](#conseils)
   * [ASTUCES](#astuces)
   * [STRUCTURE](#structure)
   * [COMMANDES](#commandes)
   * [LIFECYCLE](#lifecycle)
* [INSTALLATION](#installation)
* [LANCER FLUTTER SUR LE MOBILE](#flutter-sur-mobile)
* [ANDROID STUDIO](#android-studio)   
   * [RACCOURCIS](#raccourcis)
   * [ERREURS](#erreurs)
* [MAIN.DART](#main-dart)
* [WIDGETS](#widgets)   
   * [WIDGETS DE BASE (1)](#widgets-de-base)   
      * [MATERIAL APP](#material-app)
      * [SCAFFOLD](#scaffold)
      * [APPBAR](#appbar)
      * [CONTAINER](#container)
      * [CENTER](#center)
      * [CARD](#card)
      * [IMAGE.NETWORK](#imagenetwork)
      * [IMAGE.ASSETS](#imageassets)
      * [TEXT](#text)
      * [COLUMN](#column)
      * [ROW](#row)
      * [ICON](#icon)
      * [ICON BUTTON](#icon-button)
      * [FLOATING ACTION BUTTON](#floating-action-button)
      * [FLAT BUTTON](#flat-button)
      * [RAISED BUTTON](#raised-button)
      * [OUTLINE BUTTON](#outline-button)
   * [POP-UP ET NAVIGATOR (2)](#pop-up-et-navigator)   
      * [AJOUT D'UN BODY EXTERNE](#ajout-d-un-body-externe)
      * [SNACKBAR](#snackbar)
      * [ALERTDIALOG](#alertdialog)
      * [SIMPLEDIALOG](#simpledialog)
      * [NAVIGUER VERS UN SECOND SCAFFOLD](#naviguer-vers-un-second-scaffold)
      * [PASSER DES ARGS AVEC PUSHNAMED](#passer-des-args-avec-pushnamed)
      * [NAVIGUER AVEC DES ROUTES](#naviguer-avec-des-routes)
      * [AUTRES POSSIBLIT√âS DE NAVIGATOR](#navigators)
      * [WILLPOPSCOPE](#willpopscope)
      * [ALERTDIALOG IN WILLPOPSCOPE](#ALERTDIALOG-IN-WILLPOPSCOPE)
      * [DRAWER](#drawer)
      * [SNACKBAR](#snackbar)
   * [WIDGETS INTERACTIFS (3)](#widgets-interactifs)   
      * [FORM](#form)
      * [VALIDATION FORMULAIRE A LA VOLEE](#validation-formulaire-a-la-volee)
      * [TEXTFIELD](#TEXTFIELD)
      * [TEXTFORMFIELD](#TEXTFORMFIELD)
      * [CHECKBOX](#CHECKBOX)   
         * [CHECKBOXLISTTILE](#CHECKBOXLISTTILE)
      * [RADIO](#RADIO)
      * [SWITCH](#SWITCH)
      * [SLIDER](#SLIDER)
      * [DATE TIME PICKERS](#DATE-TIME-PICKERS)
      * [DROPDOWNBUTTON](#DROPDOWNBUTTON)
      * [DROPDOWNBUTTONFORMFIELD](#DROPDOWNBUTTONFORMFIELD)
      * [URL_LAUNCHER](#url_laucher)
   * [WIDGETS SCROLLABLES (4)](#widgets-scrollables)   
      * [SINGLECHILDSCROLLVIEW](#SINGLECHILDSCROLLVIEW)
      * [LISTVIEW ET LISTTILE](#LISTVIEW-ET-LISTTILE)
      * [HORIZONTAL LISTVIEW INSIDE A VERTICAL SCROLLVIEW](#Horizontal-ListView-inside-a-Vertical-ScrollView)
      * [DISMISSIBLE](#DISMISSIBLE)
      * [CUSTOMTILE](#CUSTOMTILE)
      * [INKWELL](#INKWELL)
      * [VERIFIER ORIENTATION DEVICE](#VERIFIER-ORIENTATION-DEVICE)
      * [CHOISIR ORIENTATION DEVICE](#CHOISIR-ORIENTATION-DEVICE)
      * [GRIDVIEW](#GRIDVIEW)
      * [LISTE OU GRILLE SELON ORIENTATION](#LISTE-OU-GRILLE-SELON-ORIENTATION)
   * [WIDGETS LAYOUT](#widgets-layout)   
      * [STACK](#STACK)
      * [POSITIONED](#POSITIONED)
      * [BOTTOMNAVIGATIONBAR](#BOTTOMNAVIGATIONBAR)
      * [VISIBILTY](#VISIBILTY)
      * [EXPANDED](#EXPANDED)
      * [FLEXIBLE](#flexible)
  * [WIDGETS ANIMATION](#widgets-animation)   
     * [HERO](#hero)
  * [FORMES](#formes)   
     * [CERCLE](#cercle)
* [THEMES, COLORS](#themes)   
   * [CHEATSHEET TRANSPARENCY HEXADECIMAL](#CHEATSHEET-TRANSPARENCY-HEXADECIMAL)
   * [COLOR SHADE AS CONSTANT](#[COLOR-SHADE-AS-CONSTANT)
   * [FLUTTER COLOR GENERATOR](#FLUTTER-COLOR-GENERATOR)
* [INTERNATIONALISATION](#INTERNATIONALISATION)
* [PACKAGES](#packages)   
   * [FONCTIONNEMENT](#fonctionnement)   
   * [SHARED PREFERENCES](#shared-preferences)
   * [WEBVIEW](#webview)
   * [AFFICHER UN PDF VIA UNE URL AVEC PDFVIEW](#AFFICHER-UN-PDF-VIA-UNE-URL-AVEC-PDFVIEW)
   * [OUVRIR UN PDF VIA UNE URL AVEC ADVANCE_PDF_VIEWER](#OUVRIR-UN-PDF-VIA-UNE-URL-AVEC-ADVANCE_PDF_VIEWER)
   * [SPLASHSCREEN](#splashscreen)  
   * [BADGES](#badges)
* [API](#api)   
   * [Simulate an asynchronous web service](#Simulate-an-asynchronous-web-service)
   * [APPEL API LOCALHOST DEPUIS FLUTTER](#APPEL-API-LOCALHOST-DEPUIS-FLUTTER)
   * [Appel API avec les widgets interactifs](#Appel-API-avec-les-widgets-interactifs)
   * [Deserialize a list of objects from json](#Deserialize-a-list-of-objects-from-json)
   * [Transformer du JSON en List de String et List d'Object](#Transformer-du-JSON-en-List<String>-et-List<Object>)
   * [LIST IN FUTURE BUILDER](#list-in-future-builder)   
   * [FORM ET FUTURE BUILDER](#FORM-ET-FUTURE-BUILDER)   
   * [FORM FUTURE BUILDER avec condition](#FORM-FUTURE-BUILDER-avec-condition)   
   * [FUTURE DROPDOWN](#future-dropdown)
   * [AFFICHER UNE DONNEE API VIA UNE ROUTE](#AFFICHER-UNE-DONNEE-API-VIA-UNE-ROUTE)
   * [FUTURE DROPDOWN MAP](#FUTURE-DROPDOWN-MAP)
   * [REQUETE PUT AVEC BODY](#REQUETE-PUT-AVEC-BODY)
   * [STREAM BUILDER](#stream-builder)
* [FIREBASE](#firebase)
* [PERSONNALISATION](#personnalisation)   
   * [ICONE DE L'APPLI](#icone-de-lappli)
* [EX. D'APPLI (1) : CODAMUSIC](#codamusic)
* [EX. D'APPLI (2) : JEU DE QUIZZ](#coda-jeu-de-quizz)
* [EX. D'APPLI (3) : CALCUL DE CALORIES](#coda-calcul-calories)
* [EX. D'APPLI (4) : FLUX RSS](#coda-news)
* [EX D'APPLI (5) : Drawer, SharedPreferences, JSON et API](#coda-meteo)
* [EX D'APPLI (6) : SQFLITE](#coda-sqflite)
* [EX D'APPLI (7) : Factorisation, constantes, cr√©ation de Widgets](#bootcamp-bmi-calculator)
* [EX D'APPLI (8) : Future, async, await, API, Navigator](#bootcamp-clima-api)
* [EX D'APPLI (9) : API, DropdownButton, Cupertino Widgets, Maps, Platform](#bootcamp-bitcoin-api)
* [EX D'APPLI (10) : Animations, Firebase, Stream](#bootcamp-flash-chat)
* [EX D'APPLI (10) : State Management, BottomSheet, Callbacks, Provider](#bootcamp-todoey)



## FLUTTER

* SDK (kit de d√©veloppement) de Google, fond√© sur le principe des widgets (flexibilit√©, simplicit√© et rapidit√© d'utilisation), sorti en 2018
* Permet de cr√©er des applications Android ET IOS
* Construit autour du langage "fullstack" Dart
* Illustr√© par le Material Design d'Android ou IOS
* Material Design cr√©e des composants adapt√©s aux r√®gles de l'appareil souhait√©
* Le design s'adpate √† chaque appareil (Android ou IOS)
* Acc√®s facile √† la batterie, g√©olocalisation, appareil photo, ect.
* Les bases √† conna√Ætre sur les widgets : https://flutter.dev/docs/development/ui/widgets/basics
* Cr√©er une app avec Flutter = cr√©er une construction avec des legos ; les widgets s'empilent les uns sous les autres
* Comme tout est objet sur Dart, tout est objet sur Flutter
* Les widgets = des constructeurs(param1, param2, ect.)
* Un widget est par nature ‚Äúimmutable‚Äù, son contenu ne peut √™tre modifi√© sans reconstruire ce dernier
* Les propri√©t√©s d‚Äôun Widget qu‚Äôil soit avec ou sans √©tat, doivent √™tre immutables
* Architecture :
```
Scaffold (structure)
    AppBar (nav bar)
    Container (main section)
        Column
            Row
                Text
                Icon
    Texte, Image, ect.
```
* A chaque fois que setState() est appel√©, la m√©thode build() du widget est appel√©e et entra√Æne la reconstruction du widget tout en gardant le ¬´ state ¬ª
* The majority of widgets in Flutter are simply combinations of other simpler widgets. For example, the Container.padding property causes the container to build a Padding widget and the Container.decoration property causes the container to build a DecoratedBox widget.
* Rendering - Flutter Deep Dive : https://www.youtube.com/watch?v=3k70-1T_LPM&feature=emb_logo

### GLOSSAIRE
* State = ensemble des valeurs de toutes les variables qui cr√©ent l'interface de l'appli
* Local State = les valeurs restreintes √† un widget
* Global State = les valeurs ouvertes √† toute l'application (les valeurs des variables sont utilis√©es dans toute l'appli)
* Container = grosso modo une ```<div></div>```
* SizedBox = container qui ne changera pas de taille, quelle que soit la taille de son enfant (√©quivaut √† box-sizing : border-box)
```java
SizedBox(
  width: 200.0,
  height: 300.0,
  // la Card fera 200 x 300, d√ª aux contraintes impos√©es par la sized box
  child: const Card(child: Text('Hello World!')),
)
```
* Stateless Widgets = widget qui ne changera pas d'√©tat => widget descriptif et non interactif (les variables, fonctions, valeurs, evenements compris dans la classe du widget ne changeront pas) => le widget ne sera jamais recharg√© durant l'utilisation de l'application => **statique**
* Si le Stateless Widget doit changer (son code est modifi√©), il est d√©truit puis remplac√© par un autre
* Avantage = peu couteux en m√©moire
* Inconv√©nient = pas dynamique
```java
class MyApp extends StatelessWidget {
  @override 
  Widget build(BuildContext context) { // ne sera appel√©e qu'une seule fois
    return MaterialApp(
      title: 'Flutter Demo',
      // ...
    );
  }
}
```
* Stateful Widgets = widget qui poss√®de un √©tat (capacit√© √† se modifier selon les √©v√®nements de l'application) et qui sera recharg√© ou non durant l'application => **dynamique**
* Si le Stateful Widget doit changer (son code est modifi√©), son State change, mais le Widget ne change pas
* Avantage = dynamique
* Incov√©nient = plus lourd qu'un StateLess √† construire, car il utilise de la m√©moire (son State) et plusieurs fonctionnalit√©s
```java
class MyHomePage extends StatefulWidget { // cr√©ation d'un Stateful Widget

  // This widget is the home page of your application. It is stateful, meaning
  // that it has a State object (defined below) that contains fields that affect
  // how it looks.

  @override // de createState()
  _MyHomePageState createState() => _MyHomePageState(); // cr√©ation de l'√©tat de la classe
}

class _MyHomePageState extends State<MyHomePage> { // l'√©tat de la classe
  @override // de build()
  Widget build(BuildContext context) { // impl√©mentation du build
    return OneOrMoreWidgets; // qui retourne l'ensemble des widgets de l'appli
  }
}
```
* Material Design = langage visuel d√©velopp√© par Google qui reprend les principes d'un design de qualit√©, responsive et multi-plateforme
* MaterialApp : Widget englobant des fonctionnalit√©s requises pour les applications impl√©mentant le Material Design
```
The Material design language was created for any platform, not just Android. 
When you write a Material app in Flutter, it has the Material look and feel on all devices, even iOS.
```
* CupertinoApp : Widget pour que l'application ressemble √† une application IOS
```
If you want your app to look like a standard iOS-styled app, then you would use the Cupertino library
```
* Scaffold = template (√©quivalent du head + body en html)
* context = localisation du widget dans l'architecture de l'application. Permet √† Flutter de savoir o√π l'on est et o√π l'on veut aller
* slivers = parties d'une zone scrollable
* Hooks = objet qui g√®re le cycle de vie d'un Widget et qui permet le partage de code entre Widgets, √©vitant toute duplication
* Factory = https://medium.com/flutter-community/parsing-complex-json-in-flutter-747c46655f51
```
According to Dart documentation, we use the factory keyword when implementing a constructor 
that doesn‚Äôt always create a new instance of its class.
```
* Navigator : a widget that manages a stack of Route objects
* Route : an object managed by a Navigator that represents a screen, typically implemented by classes like MaterialPageRoute

### GUIDELINES
* https://medium.com/flutter-community/flutter-best-practices-and-tips-7c2782c9ebb5
* Classes, enums, typedefs, and extensions name should in UpperCamelCase.
```java
class MainScreen { ... }
enum MainItem { .. }
typedef Predicate<T> = bool Function(T value);
extension MyList<T> on List<T> { ... }
```
* Variables, constants, parameters, and named parameters should be in lowerCamelCase
```java
var item;
const bookPrice = 3.14;
final urlScheme = RegExp('^([a-z]+):');
void sum(int bookPrice) {
  // ...
}
```
* Use relative imports for files in lib
```java
// Don't
import 'package:demo/src/utils/dialog_utils.dart';

// Do
import '../../../utils/dialog_utils.dart';
```
* Always specify the type of member when it‚Äôs value type is known. Avoid using var when possible.
```java
//Don't
var item = 10;
final car = Car();
const timeOut = 2000;

//Do
int item = 10;
final Car bar = Car();
String name = 'john';
const int timeOut = 20;
```
* Avoid using ``as`` instead, use ``is`` operator
```java
// Usually, The as cast operator throws an exception if the cast is not possible. 
// To avoid an exception being thrown, one can use is.

//Don't
(item as Animal).name = 'Lion';

//Do
if (item is Animal)
  item.name = 'Lion';
```
* Use ``if`` condition instead of conditional expression
```java
//Don't
Widget getText(BuildContext context) {
  return Row(
    children: [
      Text("Hello"),
      Platform.isAndroid ? Text("Android") : null,
      Platform.isAndroid ? Text("Android") : SizeBox(),
      Platform.isAndroid ? Text("Android") : Container(),
    ]
  );
}

//Do
Widget getText(BuildContext context) {
  return Row(
      children: 
      [
        Text("Hello"), 
        if (Platform.isAndroid) Text("Android")
      ]
  );
}
```
* Use ?? and ?. operators
```java
// Prefer using ?? (if null) and ?. (null aware) operators instead of null checks 
//in conditional expressions.
//Don't
v = a == null ? b : a;

//Do
v = a ?? b;

//Don't
v = a == null ? null : a.b;

//Do
v = a?.b;
```
* Use spread collections
```java
//Don't
var y = [4,5,6];
var x = [1,2];
x.addAll(y);

//Do
var y = [4,5,6];
var x = [1,2,...y];
```
* Use Cascades Operator
```java
// If we wont to perform a sequence of operation on the same object then 
// we should use the Cascades(..) operator.
// Don't
var path = Path();
path.lineTo(0, size.height);
path.lineTo(size.width, size.height);
path.lineTo(size.width, 0);
path.close();  

// Do
var path = Path()
..lineTo(0, size.height)
..lineTo(size.width, size.height)
..lineTo(size.width, 0)
..close();
```
* Use raw string (discutable)
```java
// A raw string can be used to avoid escaping only backslashes and dollars.
//Don't
var s = 'This is demo string \\ and \$';

//Do
var s = r'This is demo string \ and $';
```
* Don‚Äôt explicitly initialize variables null
```java
// in Dart, the variable is automatically initialized to null when its value is not specified, 
// so is adding null is redundant and unneeded.

//Don't
int _item = null;

//Do
int _item;
```
* Use expression function bodies
```java
// For functions that contain just one expression, you can use an expression function. 
// The => (arrow) notation is used for expression function.
//Don't
get width {
  return right - left;
}
Widget getProgressBar() {
  return CircularProgressIndicator(
    valueColor: AlwaysStoppedAnimation<Color>(Colors.blue),
  );
}

//Do
get width => right - left;
Widget getProgressBar() => CircularProgressIndicator(
      valueColor: AlwaysStoppedAnimation<Color>(Colors.blue),
    );
```
* Avoid print() calls, prefer ``debugPrint()``
```
print() and debugPrint() both are used for logging in the console. 
If you are use print()and output is too much at once, then Android sometimes discards some log lines. To avoid this, use debugPrint()
```
* Split widget into different Widgets.
```java
// When setState() is called on a State, all descendent widgets will rebuild. 
// Therefore, Split widget into small widgets so the setState() call to the part
// of the subtree whose UI actually needs to change.
Scaffold(
  appBar: CustomAppBar(title: "Verify Code"), // Sub Widget
  body: Container(
    child: Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: <Widget>[
        TimerView( // Sub Widget
            key: _timerKey,
            resendClick: () {})
      ],
    ),
  ),
)
```
* Use ListView.builder for a long list = Default ListView constructor builds the whole list at once. ListView.builder creates a lazy list and when the user is scrolling down the list, Flutter builds widgets on-demand.
* Use ``const`` in Widgets
```java
// The widget which will not change when setState call we should define it as constant. 
// It will prevent widget to rebuild so it improves performance.
Container(
      padding: const EdgeInsets.only(top: 10),
      color: Colors.black,
      child: const Center(
        child: const Text(
          "No Data found",
          style: const TextStyle(fontSize: 30, fontWeight: FontWeight.w800),
        ),
      ),
    );
```

### CONSEILS
* renommer le dossier d'un projet flutter :   
   1. renommer
   2. importer de nouveau dans AS
* La factorisation est obligatoire, au risque d'avoir un code spaghetti
* Toujours finir les √©l√©ments d'un objet, m√™me le dernier, par une virgule
```java
MaterialApp(
  title: 'Flutter Demo',
  theme: ThemeData(
    primarySwatch: Colors.green,
    visualDensity: VisualDensity.adaptivePlatformDensity,
  ),
  home: MyHomePage(title: 'Flutter Demo Home Page'),
);
```
* Tous les nombres (li√©s aux √©l√©ments de Flutter) sont des double
```java
int _counter = 0, // variable perso
fontSize: 20.0, // variable Flutter
// exceptions :
maxLines: 2,
```
* String en single quotes (convention Dart), sauf si apostrophes dans le String
```java
String exemple = 'Je suis un string';
String exempleWithApostrophe = "Je m'appelle Jean D'York";
```
* Toujours pr√©f√©rer le pourcentage aux proportions pr√©cises + utiliser MediaQuery pour donner une taille aux widgets
```java
height: MediaQuery.of(context).size.height / 2,
textScaleFactor: 2.0, // fontSize 2 * plus grande

// tr√®s utile pour donner une taille √† des widgets
// notamment dans le cas d'une page scrollable
ListView(
  Widget1(
    height: MediaQuery.of(context).size.height * 0.2,
    // prendra 20% de l'√©cran
  ),
  Widget1(
    height: MediaQuery.of(context).size.height * 0.4,
    // prendra 40% de l'√©cran
  ),
  Widget1(
    height: MediaQuery.of(context).size.height * 0.4,
    // prendra 40% de l'√©cran
  ),
)
```
* Pas besoin d'importer async de Dart depuis sa version 2.1
```
After 2.1 the Future class was exported by dart core so you don't need to import async anymore
```
* Pour donner une width pr√©cise √† un widget qui ne peut en avoir (ex. Card), lui donner un Container() comme enfant
```java
Card(
  elevation: 7.5,
  child: Container( // pour que Card ait une width
    width: MediaQuery.of(context).size.width / 2.5,
    child: Image.network(item.enclosure.url, fit: BoxFit.fill,),
  ),
)

// m√™me solution pour un texte qui d√©borde
Container(
  width: MediaQuery.of(context).size.width / 2.5,
  child: TexteCodabee(item.title),
)
```
* D√©couper en fonctions les widgets qui se r√©p√®tent
```java
child: Column(
  children: <Widget>[
    padding(),
    Row(
      mainAxisSize: MainAxisSize.max,
      mainAxisAlignment: MainAxisAlignment.spaceBetween,
      children: <Widget>[
        TexteCodabee(item.author),
        TexteCodabee(new DateConvertisseur().convertirDate(item.pubDate), color: Colors.red,)
      ],
    ),
    padding(),
    // ....

Padding padding() {
  return Padding(padding: EdgeInsets.only(top: 10.0));
}
```
* Toujours sp√©cifier la ```^version``` de ses d√©pendances (ne pas les laisser vides)
* ```const``` ou ```final``` ? ```const``` n'a acc√®s √† aucune valeur durant l'√©x√©cution de l'application, contrairement √† ```final```, dont la valeur peut √™tre assign√© √† n'importe quel moment
```java
const dateNow = DateTime.now // impossible, l'assignation se fait apr√®s la compilation du code
// (qui lance ensuite l'√©x√©cution du code)
const = "valeur connue avant l'√©x√©cution du code";
final = "valeur qui n'est assign√©e qu'une fois, mais n'importe quand"
```
* Page qui d√©passera le viewport = ListView
* Page qui ne d√©passera pas le viewport mais qui aura besoin d'√™tre extensible (ex. ouverture du clavier) = SingleChildScrollView
* Cr√©er un nouveau widget personnalis√© => il vaut mieux le cr√©er from scratch que d'h√©riter un widget
* Les constantes sont en camelCase, commencent par un k, et sont regroup√©es dans un fichier commun (ex. constants.dart)
```java
const kOneConstant = TextStyle(...);
const kAnotherConstant = SizedBox(...);
```
* Les routes devraient √™tre une propri√©t√© statique de la page, pour √©viter les erreurs d'√©tourderie
```java
class LoginScreen extends StatefulWidget {
  static const String id = 'login_screen';
}

// main.dart
  Widget build(BuildContext context) {
    return MaterialApp(
      initialRoute: WelcomeScreen.id,
      // routes nominatives moins sujette √† l'erreur
      routes: {
        // static const String id = 'welcome_screen';
        // gr√¢ce √† static, pas besoin de cr√©er un objet WelcomeScreen()
        WelcomeScreen.id: (context) => WelcomeScreen(),
        LoginScreen.id: (context) => LoginScreen(),
      },
    );
  }

// autre page
RoundedButton(
  title: 'Log In',
  colour: Colors.lightBlueAccent,
  onPressed: () {
    Navigator.pushNamed(context, LoginScreen.id); // static property
  },
)
```
* Don't use Column for single child alignment. Use Align instead. : https://stackoverflow.com/a/50252634
```java
Align(
  alignment: Alignment.topCenter,
  child: GridView(),
)
```
* Use underscores for unused function arguments
```java
MaterialPageRoute(
  builder: (_) => DetailsPage(), // pr√©f√©rer (_) √† (context)
);
```

### ASTUCES
* IF dans un Widget
```java
Stack(
  alignment: Alignment.center,
  children: <Widget>[
    WidgetOne(),
    if (condition)
    WidgetTwo(),
  ]
),
```
* IF dans un Widget, pour plusieurs √©l√©ments
```java
Column(
  children: [
    if (book != null) ...[
      Text(book.title, style: Theme.of(context).textTheme.headline6),
      Text(book.author, style: Theme.of(context).textTheme.subtitle1),
    ],
  ],
),
```
* FOR dans un Widget
```java
ListView(
  children: [
    for (var book in books)
      ListTile(
        title: Text(book.title),
        subtitle: Text(book.author),
        onTap: () => onTapped(book),
      )
  ],
),
```
* infinity (100%)
```java
Container(
  width: double.infinity,
)
```
* Ajout de padding, margin, autrement que via les propri√©t√©s
* https://api.flutter.dev/flutter/widgets/Padding-class.html
* https://api.flutter.dev/flutter/widgets/SizedBox-class.html
```java
// Column ou Container = sizedBox
Column(
  children: <Widget>[
    Text(),
    // ‚Üì sorte de margin
    SizedBox(
      height: 20.0,
    )
    Card(),
    Container()
  ]
)

// Card n'a pas de propri√©t√© padding
// on utilise le widget padding comme child
// qui entoure le child de la Card
Card(
  child: Padding(
    padding: EdgeInsets.all(16.0),
    child: Text('Hello World!'),
  ),
)

// de m√™me si seulement le texte a besoin de padding :
Padding(
  padding: EdgeInsets.all(16.0),
  child: Text('Hello World!'),
)
```
* Ajouter une ligne
```java
SizedBox( // pour un padding
  height: 20.0,
  width: 150.0, // la ligne prendra cette longueur
  child: Divider( // ligne
    color: Colors.red,
  ),
)
```
* Ajouter un widget qui remplit l'espace disponible de la largeur de son parent
* https://api.flutter.dev/flutter/widgets/Expanded-class.html
```java
Container(
  Expanded(
    child: Image() // l'image prendra toute la largeur du Container
  )
)

Container(
  Expanded(
    flex: 2,
    child: Image() // l'image prendra 66% de la largeur du Container
  ),
    Expanded(
    flex: 1,
    child: Image() // l'image prendra 33% de la largeur du Container
  )
)
```
* Trouver les propri√©t√©s d'un widget => panneau Flutter Inspector
* Ajouter des commentaires TO DO et les retrouver
```java
//TO DO: commentaire
// le TO DO est retrouvable dans l'onglet TODO (bas gauche d'AS)
```
* Voir et s√©lectionner les modifications de notre code (historique) > Onglet VCS (Version Control) > Local History > Show History > Revert
* Factory : Use the factory ```keyword``` when implementing a constructor that doesn‚Äôt always create a new instance of its class
```java
factory Logger(String name) {
  return _cache.putIfAbsent(
      name, () => Logger._internal(name));
}
```
* Rendre un param√®tre obligatoire avec @required
```java
myWidget(@required this.property)
```
* Lier un widget √† un callback   
   * Exemple : afficher dans le header de l'appli des informations qui attendent la r√©ponse d'une API
```java
// ici la variable numberArticles est li√©e au retour d'une API
// le processus permet d'effectuer un setState dans un builder

// si retour non vide de l'API
if (snapshot.hasData) {

  WidgetsBinding.instance.addPostFrameCallback((_) => setState(() {
    // alors le state de l'appli est chang√©
    // et tous les widgets qui contiennent la variable numberArticles
    // seront chang√©s en cons√©quence
   numberArticles = snapshot.data.length;
  }));

}
```
* R√©cup√©rer les propri√©t√©s du Stateful Widget dans le State avec le mot-cl√© ```widget```
```java
class LocationScreen extends StatefulWidget {
  LocationScreen({this.locationWeather});

  // ‚Üì accessible dans le State avec widget.locationWeather
  final locationWeather;

  @override
  _LocationScreenState createState() => _LocationScreenState();
}

class _LocationScreenState extends State<LocationScreen> {

  @override
  void initState() {
    super.initState();
    // op√©ration possible gr√¢ce √† widget
    updateUI(widget.locationWeather);
  }
```
* Donner une taille √† un bouton
```java
SizedBox(
	width: MediaQuery.of(context).size.width * 0.6,
	child: RaisedButton(...)
)
```
* Container de background
```java
Stack(
  children: <Widget>[
  // container d'arri√®re plan, d√©coratif
  // part du bas pour remplir l'√©cran
  // se place en premier
  Positioned(
    left: 0,
    right: 0,
    bottom: 0,
    child: Container(
      height: MediaQuery.of(context).size.height * 0.6,
      color: kConfigBackgroundColor,
    ),
  ),
   ListView(),
)
```
* Quelle est la plateforme de l'appli (Android ou IOS)
```java
import 'dart:io' show Platform;

Platform.isIOS ? iOSWidget() : androidWidget();
```
* Personnaliser un InputDecoration
```java
const kTextFieldDecoration = InputDecoration(
  // ‚Üì valeur de base
  hintText: 'Enter a value',
  contentPadding: EdgeInsets.symmetric(vertical: 10.0, horizontal: 20.0),
  border: OutlineInputBorder(
    borderRadius: BorderRadius.all(Radius.circular(32.0)),
  ),
  enabledBorder: OutlineInputBorder(
    borderSide: BorderSide(color: Colors.blueAccent, width: 1.0),
    borderRadius: BorderRadius.all(Radius.circular(32.0)),
  ),
  focusedBorder: OutlineInputBorder(
    borderSide: BorderSide(color: Colors.blueAccent, width: 2.0),
    borderRadius: BorderRadius.all(Radius.circular(32.0)),
  ),
);


TextField(
  keyboardType: TextInputType.emailAddress,
  textAlign: TextAlign.center,
  onChanged: (value) {
    email = value;
  },
  decoration:
      // ‚Üì inputDecoration personnalis√©e
      kTextFieldDecoration.copyWith(hintText: 'Enter your email'),
),
```
* Afficher le contenu dans la partie visible de l'√©cran
```java
SafeArea(
  // contenu ici
)
```
* Cr√©er un callback entre deux fichiers
```java
// fichier 1, classe appelante
class TasksScreen extends StatelessWidget {

  List<Task> tasks = [
    Task(name: 'Buy milk'),
    Task(name: 'Buy eggs'),
    Task(name: 'Buy bread'),
  ]

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      floatingActionButton: FloatingActionButton(
        child: Icon(Icons.add),
          onPressed: () {
          // d√©clenche un modal BottomSheet
            showModalBottomSheet(
                context: context,
                builder: (context) => SingleChildScrollView(
                    child:Container(
                      child: AddTaskScreen( (newTaskTitle) { // 1) ajout d'un callback
                      // dans la classe ext√©rieure appel√©e
                        setState(() {
                          tasks.add(Task(name: newTaskTitle)); // 4) r√©cup√©ration des donn√©es du fichier 2
                          // + action sur le fichier 1
                          // possible car l'objet (et son callback) est construit dans le fichier 1
                          // il peut donc agir sur le fichier 1

                          // un objet AddTaskScreen est cr√©e, avec une fonction en propri√©t√©
                          // et il est gard√© en m√©moire dans le fichier 1
                          // AddTaskScreen() est mod√©lis√© dans le fichier 2,
                          // mais il vit dans le fichier 1
                          // quand la fonction est appel√©e, celle-ci s'ex√©cute
                          // et a acc√®s aux propri√©t√©s du fichier 1
                        })
                      }),
                    )
                )
            );
          }
      ),
      // body, ect.
    )
  }
}

// fichier 2, classe appel√©e
class AddTaskScreen extends StatelessWidget {

  final Function addTaskCallback;

  AddTaskScreen(this.addTaskCallback); // 2) ajout du callback aux propri√©t√©s de la classe appel√©e

  @override
  Widget build(BuildContext context) {

    String newTaskTitle; // saisie de l'utilisateur, √† r√©cup√©rer dans le fichier 1

    return Container(
      child: Container(
        child: Column(
          children: <Widget>[
            Text('Add Task'),
            TextField(
              // saisie de l'utilisateur
              onChanged: (newText) {
                newTaskTitle = newText;
              },
            ),
            FlatButton(
              child: Text('Add'),
              onPressed: () {
                addTaskCallback(newTaskTitle) // 3) ajout du callback √† une action
                // + ajout du param√®tre √† r√©cup√©rer dans le fichier 1
              },
            ),
          ],
        ),
      ),
    );
  }
}
```
* V√©rifier le type d'une variable avec ```is```
```java
labelText: label is String ? label : null,
icon: icon is IconData ? Icon(
  icon,
  color: Colors.grey[600],
) : null,
```
* Vertical viewport was given unbounded height for ListView/GridView : https://stackoverflow.com/a/57335217 + https://stackoverflow.com/questions/50252569/vertical-viewport-was-given-unbounded-height
```java
ListView(
  // Says to the `ListView` that it must wrap its
  // height (if it's vertical) and width (if it's horizontal).
  shrinkWrap: true,
),
```
* get name of current route
```java
void didChangeDependencies() {
    super.didChangeDependencies();
    final callingRoute = ModalRoute.of(context).settings.name;
}
```
* m√©langer des EdgeInsets
```java
body: Padding(
  padding: EdgeInset.all(16.0) + EdgeInsets.only(left: 2.0),
)
```
* Error: The getter 'length' was called on null > https://stackoverflow.com/questions/56991966/error-the-getter-length-was-called-on-null
```java
itemCount: _songs?.length ?? 0
// _songs peut √™tre null (null safety)
// si _songs est null, itemCount = 0
// sinon itemCount = _songs.length
```
* Utiliser Spacer pour remplir l'espace disponible d'un espace vide: https://stackoverflow.com/a/59527732
```java
Column(
children: <Widget>[
    Text('Title',
        style: TextStyle(fontWeight: FontWeight.bold)
    ),
    Text('Datetime',
        style: TextStyle(color: Colors.grey)
    ),
    Spacer(),
],
```
* Aligner un widget facilement :
```java
Align(
	alignment: Alignment.topCenter,
)
```
* Donner une taille √† un Widget (ex. du DrawerHeader)
* https://stackoverflow.com/questions/51768740/is-there-a-way-to-set-height-to-a-drawer-header
```java
// 1) wrap this with a Container widget.
Container(
  height: 10.0,
  child: DrawerHeader(
    child: Text('Categories', style: TextStyle(color: Colors.white)),
      decoration: BoxDecoration(
      color: Colors.black
    ),
    margin: EdgeInsets.all(0.0),
    padding: EdgeInsets.all(0.0)
  ),
);

// 2) use SizedBox widget for resize height DrawerHeader
SizedBox(
   height: 120.0, 
   child : DrawerHeader(
      child : Text('Categories', style: TextStyle(color: Colors.white)),
      decoration: BoxDecoration(color: Colors.black),
      margin: EdgeInsets.zero,
      padding: EdgeInsets.zero
   ),
);
```
* G√©rer les caract√®res non UTF-8
```java
// classe fonction
// functions.dart
import 'dart:convert' show utf8;

class Functions {
  /// convertit un String en un String UTF-8
  static String utf8convert(String text) {
    List<int> bytes = text.toString().codeUnits;
    return utf8.decode(bytes);
  }
}

// utilisation
// article.dart
import '../utilities/functions.dart';

class Article {
  String title;
  String content;

  Convive({this.title, this.content});

  factory Article.fromJson(Map<String, dynamic> json) {
    return Article(
      code: json['title'],
      nom: Functions.utf8convert(json['content']), // ++
    );
  }
}
```

### STRUCTURE
* Flutter File Structure for Big Projects : https://www.youtube.com/watch?v=Mt41FpSS-Vo&feature=emb_logo
* Flutter Folder Structure and Packages : https://www.youtube.com/watch?v=yJRpuTP156o&feature=emb_logo
* Structure g√©n√©rique :
```py
project_name/
  images/
  fonts/
  models/
  lib/
    main.dart
  widgets/
pubspec.yaml
```
* Structure complexe :
```py
Clima-Flutter-Completed/
  fonts/
    SpartanMB-Black.otf
  images/
    city_background.jpg
    location_background.jpg
  lib/
    models/
      task.dart
      task_data.dart
      dtos/
    screens/
      city_screen.dart
      loading_screen.dart
      location_screen.dart
    services/
      location.dart
      networking.dart # appel externe (API)
      weather.dart
    utilities/
      constants.dart
    widgets/
      task_tile.dart
      tasks_list.dart
  main.dart
pubspec.yaml
```
* Structure complexe 2
```py
lib/
	data/ # models (propri√©t√©s + m√©thodes JSON)
		dtos/ # models DTO (seulement propri√©t√©s + constructeur)
	pages/ # screens
	ressources/
		auth_provider.dart # login
		authorization.dart # gestion de la session utilisateur
		config.dart # constantes
		repository.dart # login de l'utilisateur
	services/
		api-article.dart # + autres appels API
		api-author.dart
		service-utils.dart
	widgets/ # composants autonomes et r√©p√©t√©s
```
* Structure gros projet (par feature, ou par "module")
```py
lib/
	settings/
    settings_controller.dart
    settings_page.dart
    settings_repository.dart
    settings_service.dart
  authentication/
    authentication_controller.dart
    authentication_page.dart
    authentication_repository.dart
    authentication_service.dart
```

### COMMANDES
* https://github.com/flutter/flutter/issues/65175
```java
flutter --version

flutter doctor
flutter doctor -v // verbose

flutter packages get // the package gets re-installed fresh
flutter clean // clear Build Cache

"package d√©fecteux" = flutter packages + flutter clean
"pas d'am√©liorations" = repair pub cache by running 'flutter pub cache repair'
"pas mieux" = relancer Android Studio
"pas mieux" = supprimer le "package"

"package d√©fectueux, round 2" :
1. "Relancer l'appli"
2. "flutter clean + flutter run"

// updates assets (images, etc.)
flutter clean
flutter packages get
flutter run

flutter upgrade // MAJ de version
// MAJ sur une version pr√©cise
flutter version // liste les versions
flutter version v1.9.1+hotfix.3 //remplace la version actuelle par la version v1.9.1+hotfix.3
// REVENIR A LA VERSION PRECEDENTE (si install√©e)
flutter downgrade

// retour sur une version pr√©cise
flutter downgrade flutter_version_name // flutter downgrade v1.17.0
```
### LIFECYCLE
* https://stackoverflow.com/questions/56395081/unhandled-exception-inheritfromwidgetofexacttype-localizationsscope-or-inheri
* StateLess Widget
```java
Widget build(BuildContext contex) {
  // called when the stateless widget gets built 
  // (every time the stateless widget changes)
}
```
* StateFul Widget
```java
// 1)
void InitState() {
  super.initState();
  // called when the stateful widget is created and inserted into the tree
}

// 2)
void didChangeDependencies() {
  super.didChangeDependencies();
  // called when a dependency of this State object changes (ex. : Theme.of, ModalRoute.of, ect.)
  // ex. : argument = ModalRoute.of(context).settings.arguments;
  // car √† ce moment, ModalRoute a en effet chang√©
  // bon endroit pour faire des op√©rations sur les widgets globals de l'appli, comme ModalRoute
}

// 3)
Widget build(BuildContext contex) {
  // called when the inner widgets gets changed (color, text, ect.)
}

// 4)
void deactivate() {
  // called when the stateful widget gets destroyed
}
```
* SystemChannels.lifecycle
* Listen to lifecycle events to trigger a function, a call, ect.
* Flutter: Update Widgets On Resume? : https://stackoverflow.com/questions/49869873/flutter-update-widgets-on-resume
```java
// exemple simple
void InitState() {
  super.initState();
  configureAppLifecycleStates();
}

// fonction qui g√®re les cycles de vie
void configureAppLifecycleStates() {
  SystemChannels.lifecycle.setMessageHandler((String msg) {
    print('SystemChannels> $msg'); // SystemChannels> AppLifecycleState.paused
    switch (msg) {
      case "AppLifecycleState.paused": // appli mise en pause
        break;
      case "AppLifecycleState.inactive": // appli inactive
        break;
      case "AppLifecycleState.detached": // appli termin√©e
        break;
      case "AppLifecycleState.resumed": // appli relanc√©e
        // ici, on √©crit nos instructions
        // par exemple, de checker si les notifications de l'utilisateur ont √©volu√©es
        checkUserNotifications();
        break;
      default:
    }
    return;
  });
}

// Update Widgets On Resume?
import 'package:flutter/material.dart';
import 'package:flutter/foundation.dart';

class LifecycleEventHandler extends WidgetsBindingObserver {
  final AsyncCallback resumeCallBack;
  final AsyncCallback suspendingCallBack;

  LifecycleEventHandler({
    this.resumeCallBack,
    this.suspendingCallBack,
  });

  @override
  Future<void> didChangeAppLifecycleState(AppLifecycleState state) async {
    switch (state) {
      case AppLifecycleState.resumed:
        if (resumeCallBack != null) {
          await resumeCallBack();
        }
        break;
      case AppLifecycleState.inactive:
      case AppLifecycleState.paused:
      case AppLifecycleState.detached:
        if (suspendingCallBack != null) {
          await suspendingCallBack();
        }
        break;
    }
  }
}

class AppWidgetState extends State<AppWidget> {
  void initState() {
    super.initState();

    WidgetsBinding.instance.addObserver(
      LifecycleEventHandler(resumeCallBack: () async => setState(() {
        // do something
      }))
    );
  }
  ...
}

// or
import 'package:flutter/material.dart';

abstract class LifecycleWatcherState<T extends StatefulWidget> extends State<T>
    with WidgetsBindingObserver {
  @override
  Widget build(BuildContext context) {
    return null;
  }

  @override
  void initState() {
    super.initState();
    WidgetsBinding.instance.addObserver(this);
  }

  @override
  void dispose() {
    WidgetsBinding.instance.removeObserver(this);
    super.dispose();
  }

  @override
  void didChangeAppLifecycleState(AppLifecycleState state) {
    switch (state) {
      case AppLifecycleState.resumed:
        onResumed();
        break;
      case AppLifecycleState.inactive:
        onPaused();
        break;
      case AppLifecycleState.paused:
        onInactive();
        break;
      case AppLifecycleState.detached:
        onDetached();
        break;
    }
  }

  void onResumed();
  void onPaused();
  void onInactive();
  void onDetached();
}
```


## INSTALLATION

### FLUTTER
* https://flutter.dev/docs/get-started/install
* https://flutter.dev/docs/get-started/install/windows
* Extraire le .zip vers C:\src\flutter (pas dans Program Files)
* Double clic sur flutter_console.bat
```
flutter --version
```
* Cr√©er une variable d'environnement : chercher "env" => "Modifier les variables d'environnement pour votre compte" => Variables utilisateur => s√©lectionner Path => Modifier => ajouter √† la fin : ";"C:\src\flutter\bin" (Nouveau sur W10) (clic+Maj sur /bin + copier le chemin d'acc√®s)
* V√©rifier si le processus s'est bien d√©roul√© => ouvrir une console, puis taper :
```
flutter --version
```
* Taper flutter doctor pour voir ce qu'il manque :
```
flutter doctor
```
### ANDROID STUDIO
* https://developer.android.com/studio
* Une fois install√©, suivre le ‚ÄòAndroid Studio Setup Wizard‚Äô
* Ouverture d'Android Studio => Configure => Settings => Plugins => Browser repo => "Flutter" + install => approuver tous les pop-up (installe Dart en m√™me temps)
### ANDROID EMULATOR
* Start a new Flutter project => "testing_app", "C:\src\flutter", "D:\Documents\DEV\FLUTTER" => OK => Finish
* Cliquer sur AVD Manager (haut √† droite de l'√©cran)
* Create New Virtual Device => choisir Nexus 6 (meilleures performances)
* Choisir le premier Operating System
* Changer Emulated Performance √† Hardware accelerated (l'√©mulateur sera plus rapide qu'en automatique)
### PREFERENCES
* Appearances => change background
* Editor => change Font size
* Editor => Code completion => Show the documentation popup
* Preferences/Settings => Languages & Frameworks => cocher "Perform Hot reload on save" + "Format code on save"
* Keymap pour changer les raccourcis clavier
### TROUBLESHOOTING
* https://www.udemy.com/course/flutter-bootcamp-with-dart/learn/lecture/17119662#bookmarks
* Licences Android Studio 
```
MAJ la version d'Android Studio
1. Open your terminal
2. type flutter doctor --android-licenses
3. press y to accept every license
```
### NOUVEAU PROJET FLUTTER
* package name = pour se diff√©rencier sur Play Store / Apple Store => com.mycompany.nom_projet (com.yourdomain.appname)
* D√©cocher Include Kotlin + Include Swift
### RECUPERER UN PROJET FLUTTER
* New > Project from Version Control (lien GitHub) 
* Clone in your directory
* Checkout > No
* Ouvrir un projet > ouvrir le projet clon√©

## FLUTTER SUR MOBILE
* Param√®tres > A propos du t√©l√©phone > Informations sur le logiciel > Taper 7 fois sur le Num√©ro de version
* *Mode developpeur activ√©*
* Param√®tres > Options de d√©veloppement > D√©bogage USB => true
* *Connecter le t√©l√©phone avec le cable usb*
* *Accepter les pop-up*
* *Lancer l'appli depuis Android Studio*
* Run/Debug your apps on a Physical Device Wirelessly > https://www.udemy.com/course/flutter-bootcamp-with-dart/learn/lecture/14485822#questions/11579700

## ANDROID STUDIO
* Fonctionnalit√©s : https://www.udemy.com/course/flutter-bootcamp-with-dart/learn/lecture/14481906#questions
* AVD Manager : lieu o√π l'on stocke tous nos appareils virtuels (diff√©rents t√©l√©phones)
* Probl√®me de Black Screen au d√©marrage du Nexus 6 > Wipe Data > Lancer Nexus 6
* Enlever le bandeau Debug => Flutter Inspector => More action => Hide Debug Mode Banner
* Probl√®me de rotation => effectuer la rotation => appuyer sur le bouton rotation qui s'affiche quelques secondes sur le bas du t√©l√©phone OU activer la rotation sur le t√©l√©phone (comme un vrai t√©l√©phone)

### RACCOURCIS
* Alt+Ins√©rer (Code => Generate) in the editor => generate the getter and setter methods for any fields of your class
* Clic-droit => Reformat
* Rester sur le widget => cliquer sur l'ampoule => Wrap with..., delete, ect. (intention actions)
* Alt + Enter pour faire aussi appara√Ætre les intention actions
* S√©lectionner les occurences => Edit => Find => Select All occurences (Ctrl+Maj+Alt+J)
* CTRL + / ==> To comment/uncomment a line .
* CTRL + Shift + / ==> To comment/uncomment block of code. */
* CTRL + Y ==> To delete a line
* stless => Stateless Widget
* stful => Stateful Widget
* FAB => FloatingActionButton
* cliquer sur l'√©l√©ment + Ctrl + Q = quick documentation
* Envelopper un widget par un Center(), Column(), Row(), ect. => cliquer sur le widget => ouvrir le panneau droite Flutter Outline, cliquer sur l'un des boutons en haut du panneau OU depuis le m√™me panneau, clic-droit sur l'√©l√©ment √† envelopper$
* Ctrl + clic sur la classe pour voir son fichier
* Renommer une variable dans tout le projet > Clic-droit > Refactor > Rename
* Ouvrir le debug paint => Flutter inspector => Debug paint
* If you do not remember how to call an action, press Ctrl+Maj+A and start typing the action name
* Transformer un widget en une classe (stless) => Clic sur le Widget > Refactor > Extract Flutter Widget

### ERREURS
* error: Future isn't a type android studio flutter > https://github.com/flutter/flutter/issues/24279
```
Android Studio File>Invalidate Caches / Restart
```

## MAIN DART
```java
import 'package:flutter/material.dart'; // import des packages de material dart

void main() { // fonction principale
  runApp(MyApp()); // lance l'application
}

class MyApp extends StatelessWidget {
  // This widget is the root of your application.
  @override // on r√©-√©crit la m√©thode de la classe m√®re
  Widget build(BuildContext context) { 
  // ‚Üë m√©thode qui sera appel√©e √† chaque chargement de l'appli
  // + √† chaque nouvelle version des widgets compris dans le widget
  // + √† chaque fois que setState() sera appel√©e
    return MaterialApp( // widget de base = squelette de l'application
      title: 'Flutter Demo',
      theme: ThemeData(
        primarySwatch: Colors.blue, // couleur principale de l'appli
        visualDensity: VisualDensity.adaptivePlatformDensity,
      ),
      home: MyHomePage(title: 'Flutter Demo Home Page'), // page principale
    );
  }
}

class MyHomePage extends StatefulWidget { // page principale
  MyHomePage({Key key, this.title}) : super(key: key); // constructeur

  final String title; // propri√©t√©

  @override
  _MyHomePageState createState() => _MyHomePageState(); // √©tat de la classe
}

class _MyHomePageState extends State<MyHomePage> {
  int _counter = 0;

  void _incrementCounter() { // action sur le compteur
    setState(() { // setState = une variable va √™tre modifi√©e
    // et donc tous les widgets associ√©es √† cette variable
    // vont √™tre modifi√©s en cons√©quence
      _counter++;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold( // structure principale, conteneur de tous les √©l√©ments
      appBar: AppBar( // nav vbar
        title: Text(widget.title),
      ),
      body: Center( // widget qui centre un autre widget, son child (ici, Column)
        child: Column( // widget colonne
          mainAxisAlignment: MainAxisAlignment.center,
          children: <Widget>[ // a des enfants de type Widget
            Text(
              'You have pushed the button this many times:',
            ),
            Text(
              '$_counter', // variable _counter
              style: Theme.of(context).textTheme.headline4, // style = celui du th√®me
            ),
          ],
        ),
      ),
      floatingActionButton: FloatingActionButton( // le bouton
        onPressed: _incrementCounter, // l'√©v√®nement, associ√© √† la m√©thode
        tooltip: 'Increment', // √† quoi sert notre bouton ? (pense-b√™te)
        child: Icon(Icons.add),
      ), // This trailing comma makes auto-formatting nicer for build methods.
    );
  }
}
```

### MODIFICATION DE CODE
```java
import 'package:flutter/material.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Flutter Demo',
      theme: ThemeData(
        primarySwatch: Colors.green,
        visualDensity: VisualDensity.adaptivePlatformDensity,
      ),
      home: MyHomePage(title: 'Flutter Demo Home Page'),
    );
  }
}

class MyHomePage extends StatefulWidget {
  MyHomePage({Key key, this.title}) : super(key: key);
  final String title;
  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {
  String name = ''; // ++
  int _counter = 0;

  void _incrementCounter() {
    setState(() {
      _counter++;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.spaceEvenly, // pr√©c√©demment .center
          // r√©partie de fa√ßon √©gale les √©l√©ments sur la longueur de l'√©cran
          children: <Widget>[
            Text(
              'Salut $name, vous avez appuy√© tant de fois sur le bouton :', // ++
              textAlign: TextAlign.center, // ++
              style: TextStyle( // ajout d'un style ++ (plus besoin de new pour instancier un objet)
                color: Colors.red,
                fontSize: 20.0,
              ),
            ),
            Text(
              '$_counter',
              style: Theme.of(context).textTheme.headline4,
            ),
            TextField( // cr√©ation d'un input text
              onChanged: (String string) { // quand le texte change ++
                setState(() { // change tous les widgets associ√©s √† la variable
                  this.name = string; // le texte renseign√© => var name
                });
              },
              onSubmitted: (String string) { // quand le texte est envoy√©
                setState(() {
                  this.name = string; // le texte renseign√© => var name
                });
              },
              decoration: InputDecoration(
                labelText: "Entrez votre pr√©nom : "
              ),
            )
          ],
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: _incrementCounter,
        tooltip: 'Increment',
        child: Icon(Icons.add),
      ),
    );
  }
}
```

## WIDGETS

* https://flutter.dev/docs/development/ui/widgets

### WIDGETS DE BASE

* https://flutter.dev/docs/development/ui/widgets/basics

#### MATERIAL APP
* Structure de l'application, bas√©e sur le Material Design
* https://api.flutter.dev/flutter/material/MaterialApp-class.html
```java
import 'package:flutter/material.dart'; // obligatoire

void main() {
  runApp(MyApp()); // lance l'appli
}

class MyApp extends StatelessWidget { // l'appli

  @override // obligatoire
  Widget build(BuildContext context) {
    return MaterialApp( // ce qui est √† renvoyer
      // regarder MaterialApp sur la doc pour impl√©menter le constructeur
      title: "Les widgets basiques",
      theme: ThemeData(
        primarySwatch: Colors.red, // couleur de base
      ),
      debugShowCheckedModeBanner: false, // true dans le constructeur de la doc
      home: // √† impl√©menter, page principale de l'appli
    );
  }
}
```
#### SCAFFOLD
* Equivalent du template
```java
import 'package:flutter/material.dart'; // obligatoire

void main() {
  runApp(MyApp()); // lance l'appli
}

class MyApp extends StatelessWidget { // l'appli

  @override // obligatoire
  Widget build(BuildContext context) {
    return MaterialApp( // ce qui est √† renvoyer
      // regarder MaterialApp sur la doc pour impl√©menter le constructeur
      title: "Les widgets basiques",
      theme: ThemeData(
        primarySwatch: Colors.red, // couleur de base
      ),
      debugShowCheckedModeBanner: false, // true dans le constructeur de la doc
      home: Home(), // ++
    );
  }
}

class Home extends StatefulWidget { // page principale
  @override
  State<StatefulWidget> createState() { // cr√©ation de son √©tat
    return _Home();
  }
}

class _Home extends State<Home> { // convention pour indiquer qu'il s'agit du state de Home
  // h√©rite du state de Home 
  // (generic type = le <Home> est un param√®tre de la classe g√©n√©rique State)

  @override
  Widget build(BuildContext context) {
    return Scaffold( // notre template
      // on y renseigne tous les widgets que l'on ajouter √† notre template
      backgroundColor: Colors.teal,
    );
  }
}
```
#### APPBAR
* Equivalent d'une nav bar
```java
class _Home extends State<Home> { 
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar( // widget AppBar
        title: Text("Mon menu de navigation"),
        leading: Icon(Icons.account_circle), // extr√©mit√© gauche de la nav bar
        actions: <Widget>[ // liste d'actions, extr√©mit√© droite de la nav bar
          Icon(Icons.navigation),
          Icon(Icons.menu),
        ],
        elevation: 10.0, // effet de profondeur, demand√© double dans la doc
        centerTitle: true,
      ),
      backgroundColor: Colors.teal,
    );
  }
}
```
#### CONTAINER
* Un conteneur qui ne peut contenir qu'un enfant (widget)
* But : pouvoir ajouter background-color, d√©corations, padding et margin au widget
```java
class _Home extends State<Home> { 
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      // ...
      body: Container( // ++ body du template
        // color: Colors.blue,
        // height: 30.0,
        // height divis√©e par 2 :
        height: MediaQuery.of(context).size.height / 2,
        margin: EdgeInsets.all(10.0), // √©quivalent de margin = 10
        padding: EdgeInsets.only(top: 15.0, bottom: 5.0), // padding-top = 15
        decoration: BoxDecoration( // ajouter des bordures, un box-shadow, ect.
          color: Colors.blue, // remplace color du container
          borderRadius: BorderRadius.circular(20.0), // bords arrondis
          borderRadius: BorderRadius.only(
        topLeft: Radius.circular(30.0), topRight: Radius.circular(30.0)), // bords arrondis personnalis√©s
          border: Border.all(
            color: Colors.white, // si pas de decoration, renseigner simplement la propri√©t√© seule (comme height)
            width: 2.0,
          ),
          borderRadius: BorderRadius.all(Radius.circular(20.0)),
          // une ombre (elevation) au container
          boxShadow: [
          BoxShadow(color: Colors.black.withOpacity(0.3), spreadRadius: 5, blurRadius: 7, offset: Offset(3.0, 3.0))
            ],
        ),
        child:
          // √©l√©ment contenu dans le container
      ),
    );
  }

}
```
#### CENTER
* Container qui centre l'enfant qu'il contient
```java
class _Home extends State<Home> { @override
  Widget build(BuildContext context) {
    return Scaffold(
      // ...
      body: Container( // body du template
        // color: Colors.blue,
        // height: 30.0,
        // height divis√©e par 2 :
        height: MediaQuery.of(context).size.height / 2,
        margin: EdgeInsets.all(10.0), // √©quivalent de margin = 10
        padding: EdgeInsets.only(top: 15.0, bottom: 5.0), // padding-top = 15
        decoration: BoxDecoration( // ajouter des bordures, un box-shadow, ect.
          color: Colors.blue, // remplace color du container
          border: Border.all(
            color: Colors.white,
            width: 2.0,
          ),
          borderRadius: BorderRadius.all(Radius.circular(20.0)),
        ),
        child: // √©l√©ment contenu dans le container
          Center(
            child: Container(
              color: Colors.red,
              width: 20.0,
              height: 20.0,
            )
          )
      ),
    );
  }
}
```
#### CARD
* Container avec des bords arrondis et une ombre
```java
class _Home extends State<Home> { 
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Container( 
        child: // √©l√©ment contenu dans le container
          Center(
            child: Card( // ++
              elevation: 5.0,
              color: Colors.teal,
              shape: RoundedRectangleBorder(
                borderRadius: BorderRadius.all(Radius.circular(10.0))),
              child: Container(
                width: MediaQuery.of(context).size.width / 2,
                height: 250.0,
              ),
            )
          )
      ),
    );
  }
}
```
#### IMAGE.NETWORK
* R√©cup√©rer une image sur le web
```java
class _Home extends State<Home> { 
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Container( 
        child: // √©l√©ment contenu dans le container
          Center(
            child: Card(
              elevation: 5.0,
              color: Colors.teal,
              child: Container(
                width: MediaQuery.of(context).size.width / 2,
                height: 250.0,
                // accepte liens http √©galement ‚Üì
                child: Image.network("https://flutter.dev/assets/flutter-lockup-c13da9c9303e26b8d5fc208d2a1fa20c1ef47eb021ecadf27046dea04c0cebf6.png",
                fit: BoxFit.cover)
              ),
            )
          )
      ),
    );
  }
}
```
#### IMAGE.ASSETS
* Utiliser une image en local
* Sur AS, clic-droit sur le projet (ici "basic_widgets") => New directory => images
* Copier-coller l'image dans le dossier cr√©√© sur AS
* pubspec.yaml
```yaml
# To add assets to your application, add an assets section, like this:
assets:
# ne pas mettre d'INDENTATION !
- images/computer.jpg # Copy Path => Path from content root
- images/ # plus simple et √† privil√©gier, r√©cup√®re toutes les images
```
en haut du fichier => pub get
* main.dart
```java
class _Home extends State<Home> {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Container(
        child: // √©l√©ment contenu dans le container
          Center(
            child: Card(
              elevation: 5.0,
              color: Colors.teal,
              child: Container(
                width: MediaQuery.of(context).size.width / 2,
                height: 250.0,
                child: Image.asset("images/computer.jpg", // ++
                fit: BoxFit.cover),
              ),
            )
          )
      ),
    );
  }
}
```
#### TEXT
* Text wrap : https://stackoverflow.com/questions/51930754/flutter-wrapping-text
```java
class _Home extends State<Home> { 
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Container(
        // √©l√©ment contenu dans le container ‚Üì
        child: Center(
          child: Text(
            "Apprentissage de Flutter : si j'utilise plusieurs lignes, le text-align fait son effet",
            textAlign: TextAlign.end, // la deuxi√®me ligne est coll√©e √† gauche
            textAlign: TextAlign.center,
            textScaleFactor: 2.0, // fontSize 2 * plus grande
            style: TextStyle(
              color: Colors.white,
              fontSize: 20.0,
              fontStyle: FontStyle.italic,
            ),
            maxLines: 2, // nombre de lignes maximum diffus√©es
          ),
        )
        // autre possibilit√© : un texte non centr√© :
        child: Text(
          "Aprentissage de Flutter", // le container s'adapte √† la taille de son enfant
        ),
        // ‚Üì text wrap
        // wrap en fade
        Expanded(
          child: Text('Texte tr√®s loooooooong', overflow: TextOverflow.fade, softWrap: false,),
        ),
        // wrap[...]
        Text("This is a long text", overflow: TextOverflow.ellipsis,),
      ),
    );
  }

}
```
#### COLUMN
* widget qui affiche ses enfants en colonne
* √©l√©ments ordonn√©s en colonne, verticalement
* reprend les principes du flexbox column
* Probl√®me d'espace : utiliser ListView √† la place
```java
class _Home extends State<Home> {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
        body: Center(
          child: Column(
            crossAxisAlignment: // flexbox vertical
            mainAxisAlignment: MainAxisAlignment.center, // principe du flexbox
            // .end = tout √† la fin, .start = tout au d√©but
            // .spaceEvenly = √©l√©ments espac√©s harmonieusement
            // .spaceBetween = √©l√©ments au d√©but, au centre, √† la fin
            // .spaceAround = spaceEvenly (distribu√©s harmonieusement)
            children: <Widget>[
              Text(
                "Apprentissage du widget Column",
                textAlign: TextAlign.center,
                style: TextStyle(
                  color: Colors.deepOrange[100], // cf palette de couleurs Flutter
                  fontSize: 30.0,
                  fontStyle: FontStyle.italic,
                ),
              ),
              // ‚Üì sorte de margin
              SizedBox(
                height: 20.0,
              )
              Card(
                elevation: 10.0,
                child: Container(
                  width: 250.0,
                  height: 250.0,
                  child: Image.asset(
                      "images/computer.jpg",
                      fit: BoxFit.cover,
                  ),
                ),
              ),
              Container(
                color: Colors.red[800],
                height: 100.0, // la largeur prend tout l'√©cran
              )
            ],
          ),
        ));
  }
}
```
#### ROW
* widget qui affiche ses enfants en rang√©e
* √©l√©ments ordonn√©s en rang√©e, horizontalement
* reprend les principes du flexbox row
* Probl√®me d'espace : utiliser ListView √† la place
```java
class _Home extends State<Home> {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      // ....
        body: Center(
          child: Column(
            // ...
              Container(
                color: Colors.red[800],
                height: 100.0, // la largeur prend tout l'√©cran
                margin: EdgeInsets.only(left: 20.0, right: 20.0),
                child: Row(
                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                  children: <Widget>[
                    Container(
                      height: 65.0,
                      width: 65.0,
                      color: Colors.amber
                    ),
                    Container(
                        height: 65.0,
                        width: 65.0,
                        color: Colors.blue
                    ),
                    Container(
                        height: 65.0,
                        width: 65.0,
                        color: Colors.lightGreenAccent
                    ),
                    Container(
                        height: 65.0,
                        width: 65.0,
                        color: Colors.deepPurple
                    ),
                  ],
                ),
              ),
            ],
          ),
        ));
  }
}

// probl√®me : si l'on rajoute des container dans la row, cela d√©borde
// avec une erreur √† l'√©cran
// solution : les pourcentages
// 1) on r√©cup√®re la largeur de l'√©cran (haut du code)

class _Home extends State<Home> {
  @override
  Widget build(BuildContext context) {

    var appWidth = MediaQuery.of(context).size.width; // ++ r√©cup√®re la largeur de l'app
    
    return Scaffold(
      // ...
        body: Center(
          child: Column(
            // ...
              Container(
                color: Colors.red[800],
                height: appWidth / 5, // ++ hauteur mall√©able
                margin: EdgeInsets.only(left: 20.0, right: 20.0),
                child: Row(
                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                  children: <Widget>[
                    Container(
                      height: appWidth / 8,
                      width: appWidth / 8, // divis√© par 8
                        // car 6 containers
                        // mais il faut aussi compter les margins
                        // plus d'erreur, les 6 rentrent sur une ligne
                      color: Colors.amber
                    ),
                    Container(
                        height: appWidth / 8,
                        width: appWidth / 8,
                        color: Colors.blue
                    ),
                    Container(
                        height: appWidth / 8,
                        width: appWidth / 8,
                        color: Colors.lightGreenAccent
                    ),
                    Container(
                        height: appWidth / 8,
                        width: appWidth / 8,
                        color: Colors.deepPurple
                    ),
                    Container(
                        height: appWidth / 8,
                        width: appWidth / 8,
                        color: Colors.lightGreenAccent
                    ),
                    Container(
                        height: appWidth / 8,
                        width: appWidth / 8,
                        color: Colors.deepPurple
                    ),
                  ],
                ),
              ),
            ],
          ),
        ));
  }
}
```
#### ICON
```java
class _Home extends State<Home> {@override
  Widget build(BuildContext context) {
    var appWidth = MediaQuery.of(context).size.width; // r√©cup√®re la largeur de l'app
    return Scaffold(
        body: Center(
          // ...
              Container(
                color: Colors.red[800],
                height: appWidth / 5, // ++ hauteur mall√©able
                margin: EdgeInsets.only(left: 20.0, right: 20.0),
                child: Row(
                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                  children: <Widget>[
                    Icon(
                      Icons.airport_shuttle,
                      color: Colors.white,
                      size: appWidth / 10,
                      semanticLabel: "Un camion roulant vers la droite",
                    ),
                    Icon(
                      Icons.timeline,
                      color: Colors.white,
                      size: appWidth / 10,
                      semanticLabel: "Une ligne marqu√©e de jalons",
                    ),
                    Icon(
                      Icons.thumb_up,
                      color: Colors.white,
                      size: appWidth / 10,
                      semanticLabel: "Un pouce lev√© vers le haut",
                    ),
                    Icon(
                      Icons.flag,
                      color: Colors.white,
                      size: appWidth / 10,
                      semanticLabel: "Un drapeau flottant",
                    ),
                  ],
                ),
              ),
            ],
          ),
        ));
  }
}
```
#### ICON BUTTON
* Icone cliquable
```java
class _Home extends State<Home> {
  // convention pour indiquer qu'il s'agit du state de Home
  // h√©rite du state de Home (generic type = le <Home> est un param√®tre de la classe g√©n√©rique State)
  
  bool changedToWhite = false; // ++
  
  @override
  Widget build(BuildContext context) {
    return Scaffold(
        body: Center(
          child: Column(
            children: <Widget>[
              IconButton(
                  icon: Icon( // ++
                    Icons.calendar_today,
                    color: Colors.amberAccent,
                    size: 50.0,
                  ),
                  onPressed: () {
                    print("J'ai appuy√© sur le bouton !");
                    // on avertit tous les widgets
                    // du changement interne de l'application
                    setState(() {
                      changedToWhite = !changedToWhite; // alterne les couleurs
                    });
                  }
              ),
              // ...
                  ],
                ),
              ),
            ],
          ),
        ));
  }
```
#### FLOATING ACTION BUTTON
* Bouton circulaire qui flotte au-dessus du body
```java
class _Home extends State<Home> {

  bool changedToWhite = false; // ++

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      // ...
      floatingActionButton: FloatingActionButton(
        onPressed: pressButton, // ajout de la m√©thode
        elevation: 8.0,
        tooltip: "Change text color of main text",
        child: Icon(
            Icons.autorenew
        ),
      ),
      floatingActionButtonLocation: FloatingActionButtonLocation.centerFloat,
    );
  }

  void pressButton() {
    print("J'ai appuy√© sur le bouton !");
    setState(() {
      changedToWhite = !changedToWhite;
    });
  }
}
```
#### FLAT BUTTON
* Bouton plat, sans relief
```java
class _Home extends State<Home> {
  bool changedToWhite = false; // ++
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.spaceEvenly,
          children: <Widget>[
            FlatButton( // ++
              onPressed: pressButton,
              child: Text("Appuyez-moi !"),
              color: Colors.cyanAccent,
              shape: RoundedRectangleBorder(
                borderRadius: BorderRadius.all(Radius.circular(10.0))),
              padding: EdgeInsets.only(
                left: 20.0, top: 10.0, right: 20.0, bottom: 10.0),
            )
                ],
              ),
            ),
          ],
        ),
    );
  }

  void pressButton() {
    print("J'ai appuy√© sur le bouton !");
    setState(() {
      changedToWhite = !changedToWhite;
    });
  }

}
```
#### RAISED BUTTON
* Bouton avec effet de profondeur
```java
class _Home extends State<Home> {
  bool changedToWhite = false; // ++
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.spaceEvenly,
          children: <Widget>[
            FlatButton(
              onPressed: pressButton,
              child: Text("Appuyez-moi !"),
              color: Colors.cyanAccent,
            ),
            RaisedButton( // ++
              onPressed: pressButton,
              child: Text("Je suis un RaisedButton !"),
              elevation: 10.5, // diff√©rence avec le Flat Button
              color: Colors.lightGreen,
              textColor: Colors.teal[900],
            ),
            Tooltip( // affiche un message quand le widget est appuy√© longtemps
              message: "Bouton pour changer la couleur du texte principal",
              child: RaisedButton(
                onPressed: pressButton,
                child: Text("Je suis un RaisedButton !"),
                elevation: 10.5, // diff√©rence avec le Flat Button
                color: Colors.lightGreen,
                textColor: Colors.teal[900],
              ),
            ),
          ],
        ),
      ),
    ),
  }

  void pressButton() {
    print("J'ai appuy√© sur le bouton !");
    setState(() {
      changedToWhite = !changedToWhite;
    });
  }

}
```
#### OUTLINE BUTTON
* OutlineButton
```java
OutlineButton(
// personnalisation de la bordure
  borderSide: BorderSide(
    color: Colors.grey[300],
    width: 2.0,
    style: BorderStyle.solid,
  ),
  child: Text(
    'Mon texte',
    textScaleFactor: 1.2,
  ),
  textColor: Colors.grey[600],
  highlightedBorderColor: Colors.grey[300], // couleur de la bordure √† la touche
  shape: RoundedRectangleBorder(
      borderRadius: BorderRadius.all(Radius.circular(30.0))),
  padding: EdgeInsets.only(
      left: 20.0, top: 5.0, right: 20.0, bottom: 5.0),
  onPressed: () => Navigator.pop(context),
),

```

### POP-UP ET NAVIGATOR

#### AJOUT D UN BODY EXTERNE
* body.dart (autre fa√ßon d'ajouter un body)
```java
import 'package:flutter/material.dart';

class Body extends StatefulWidget {
  @override
  _BodyState createState() => _BodyState();
}

// √©tat de notre classe, qui contient tous les champs
class _BodyState extends State<Body> {
  @override
  Widget build(BuildContext context) {
    return Center(
      child: RaisedButton(
        onPressed: pressButton,
        child: Text(
          "Je suis un bouton",
          style: TextStyle(
            color: Colors.white,
            fontSize: 20.0,
          ),
        ),
        color: Colors.red,
        elevation: 10.0,
      ),
    );
  }

  void pressButton() {
    print("Bouton appuy√© !");
  }
}
```
* main.dart
```java
import 'package:flutter/material.dart';
import 'body.dart'; // on importe notre classe Body

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  // This widget is the root of your application.
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Flutter Demo',
      theme: ThemeData(
        primarySwatch: Colors.blue,
        visualDensity: VisualDensity.adaptivePlatformDensity,
      ),
      home: MyHomePage(title: 'Flutter Demo Home Page'),
    );
  }
}

class MyHomePage extends StatefulWidget {
  MyHomePage({Key key, this.title}) : super(key: key);

  final String title;

  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Body(), // on ajoute notre classe body
    );
  }
}
```
#### SNACKBAR
* Barre informative et √©ph√©m√®re qui remonte du footer puis dispara√Æt
```java
import 'package:flutter/material.dart';

class Body extends StatefulWidget {
  @override
  _BodyState createState() => _BodyState();
}

// √©tat de notre classe, qui contient tous les champs
class _BodyState extends State<Body> {
  @override
  Widget build(BuildContext context) {
    return Center(
      child: RaisedButton(
        onPressed: callSnack, // ++ on appelle la snackbar
        child: Text(
          "Je suis un bouton",
          style: TextStyle(
            color: Colors.white,
            fontSize: 20.0,
          ),
        ),
        color: Colors.red,
        elevation: 10.0,
      ),
    );
  }

  // il faut cr√©er un widget hors du Scaffold
  // pour r√©cup√©rer son contexte
  void callSnack() {
    SnackBar snackbar = SnackBar(
      // ‚Üì The primary content of the snack bar
        content: Text(
          "Je suis une SnackBar !",
          textScaleFactor: 2.5,
          textAlign: TextAlign.center,
        ),
      duration: Duration(seconds: 5),
    );
    // doc : To display a snack bar, call Scaffold.of(context).showSnackBar(),
    // passing an instance of SnackBar that describes the message
    Scaffold.of(context).showSnackBar(snackbar);
  }
}
```
#### ALERTDIALOG
* Modale d'alerte
* Renvoie une Future (promesse) => programmation asynchrone
* A SimpleDialog is designed to show options in a list (as opposed to an AlertDialog, which is meant to notify the user of something)
```java
import 'package:flutter/material.dart';

class Body extends StatefulWidget {
  @override
  _BodyState createState() => _BodyState();
}

// √©tat de notre classe, qui contient tous les champs
class _BodyState extends State<Body> {
  @override
  Widget build(BuildContext context) {
    return Center(
      child: RaisedButton(
        onPressed: callAlert, // ++ on appelle l'alerte
        child: Text(
          "Je suis un bouton",
          style: TextStyle(
            color: Colors.white,
            fontSize: 20.0,
          ),
        ),
        color: Colors.red,
        elevation: 10.0,
      ),
    );
  }

  // m√©thode asynchrone
  // ici marche sans l'import de async
  Future<Null> callAlert() async {
    // contexte (emplacement) de notre widget
    return showDialog(
      context: context,
      barrierDismissible: false, // obligation d'appuyer sur un bouton
      // ‚Üë si true, un appui n'importe o√π ferme la fen√™tre
      builder: (BuildContext context) {
        return AlertDialog(
          title: Text(
            "Ceci est une alerte !",
            textScaleFactor: 1.5,
          ),
          content: Text("Nous avons un probl√®me avec l'application."
              "Souhaitez-vous continuer ?"), // """ pour les string sur plusieurs lignes """
          contentPadding: EdgeInsets.all(5.0),
          actions: <Widget>[
            FlatButton(
              onPressed: () {
                print("Refus√© !");
                // ‚Üì on referme et on revient en arri√®re
                Navigator.pop(context);
              },
              child: Text(
                "Annuler",
                style: TextStyle(
                  color: Colors.red,
                ),
              )
            ),
            FlatButton(
                onPressed: () {
                  print("Accept√© !");
                  // ‚Üì on referme et on revient en arri√®re
                  Navigator.pop(context);
                },
                  child: Text(
                  "Continuer",
                  style: TextStyle(
                    color: Colors.green,
                  ),
                ),
            )
          ],
        );
      }
    );
  }

// alertDialog customis√©
void callAlert({int quizzId}) {
    showDialog(
      context: context,
      barrierDismissible: false,
      builder: (BuildContext context) {
        // retourne un objet de type Dialog
        return AlertDialog(
          title: Text(
            "Arr√™t du quizz",
            textScaleFactor: 1.2,
            textAlign: TextAlign.center,
          ),
          // ‚Üì alertDialog shape
          shape: RoundedRectangleBorder(
              borderRadius: BorderRadius.all(Radius.circular(20.0))),
          content: Column(
            mainAxisSize: MainAxisSize.min,
            children: <Widget>[
              Row(
                mainAxisAlignment: MainAxisAlignment.center,
                children: <Widget>[
                  Expanded(
                    child: Text(
                      "Souhaitez-vous mettre en pause le quizz ?",
                      textAlign: TextAlign.center,
                    ),
                  )
                ],
              ),
              SizedBox(
                height: 20.0,
              ),
              Row(
                children: <Widget>[
                  Expanded(
                    child: OutlineButton(
                      child: Text(
                        'Non',
                        textScaleFactor: 1.2,
                      ),
                      textColor: Colors.grey[600],
                      shape: RoundedRectangleBorder(
                          borderRadius:
                              BorderRadius.all(Radius.circular(30.0))),
                      padding: EdgeInsets.only(
                          left: 20.0, top: 5.0, right: 20.0, bottom: 5.0),
                      onPressed: () => Navigator.pop(context),
                    ),
                  ),
                  SizedBox(
                    width: 10.0,
                  ),
                  Expanded(
                    child: FlatButton(
                      child: Text(
                        "Oui",
                        textScaleFactor: 1.2,
                      ),
                      color: kButtonColor,
                      textColor: kButtonTextColor,
                      shape: RoundedRectangleBorder(
                          borderRadius:
                              BorderRadius.all(Radius.circular(30.0))),
                      padding: EdgeInsets.only(
                          left: 20.0, top: 5.0, right: 20.0, bottom: 5.0),
                      onPressed: () async {
                        ApiQuizz().pauseQuizz(quizzId: quizzId).then((value) {
                          Navigator.pushNamed(
                            context,
                            urlHome,
                            arguments: value,
                          );
                        }, onError: (error) {
                          showDialog(
                            context: context,
                            builder: (BuildContext context) {
                              return AlertDialog(
                                title: Text('Arr√™t du quizz'),
                                content: Text(error.toString()),
                                actions: [
                                  FlatButton(
                                    child: Text("OK"),
                                    onPressed: () => Navigator.pop(context),
                                  ),
                                ],
                              );
                            },
                          );
                        });
                      },
                    ),
                  ),
                ],
              )
            ],
          ),
        );
      },
    );
  }
}
```
* appeler le showDialog au lancement de la page
```java
void InitState() {
  super.initState();
  SchedulerBinding.instance.addPostFrameCallback((_) => callDialog();
  // addPostFrameCallback: Schedule a callback for the end of this frame
}
```
* Difference between AlertDialog & SimpleDialog : https://medium.com/flutteropen/flutter-widgets-17-simpledialog-1cf5bfd83f5f
```
The main difference between AlertDialog & SimpleDialog is that the AlertDialog has more parameters, 
which are the titleTextStyle, content, contentTextStyle, and actions, than the SimpleDialog.

A SimpleDialog is designed to show options in a list 
(as opposed to an AlertDialog, which is meant to notify the user of something)
```
* Flutter: Alert Dialog vs Dialog in your Flutter Application : https://medium.com/flutter-community/flutter-alert-dialog-vs-dialog-in-your-flutter-application-11be20a2af
#### SIMPLEDIALOG
* Un modal qui renseigne sur plusieurs choix
* Renvoie une Future (promesse) => programmation asynchrone
* A SimpleDialog is designed to show options in a list (as opposed to an AlertDialog, which is meant to notify the user of something)
```java
import 'package:flutter/material.dart';

class Body extends StatefulWidget {
  @override
  _BodyState createState() => _BodyState();
}

// √©tat de notre classe, qui contient tous les champs
class _BodyState extends State<Body> {
  @override
  Widget build(BuildContext context) {
    return Center(
      child: RaisedButton(
        // ‚Üì pour √©viter l'erreur de type 'Future<Null>' can't be assigned to the parameter type 'void Function()'
        // on le transforme en fonction fl√©ch√©e
        onPressed: () => callSimple("Ceci est le titre", "Ceci est la description"), // ++
        child: Text(
          "Je suis un bouton",
          style: TextStyle(
            color: Colors.white,
            fontSize: 20.0,
          ),
        ),
        color: Colors.red,
        elevation: 10.0,
      ),
    );
  }

  Future<Null> callSimple(String title, String description) async {
    return showDialog(
      context: context,
      barrierDismissible: true, // true par d√©faut
      builder: (BuildContext context) {
        return SimpleDialog(
          title: Text(title, textScaleFactor: 1.4,),
          children: <Widget>[
            Text(description),
            // ‚Üì pour cr√©er un espace
            Container(height: 20.0),
            RaisedButton(
              color: Colors.teal,
              textColor: Colors.white,
              child: Text("OK"),
              onPressed: () {
                print("Appuy√© !");
                Navigator.pop(context);
              }
            )
          ],
        );
      }
    );
  }

// un Simple Dialog avec des options :
Future<void> _askedToLead() async {
  switch (await showDialog<Department>(
    context: context,
    builder: (BuildContext context) {
      return SimpleDialog(
        title: const Text('Select assignment'),
        children: <Widget>[
          SimpleDialogOption(
            onPressed: () { Navigator.pop(context, Department.treasury); },
            child: const Text('Treasury department'),
          ),
          SimpleDialogOption(
            onPressed: () { Navigator.pop(context, Department.state); },
            child: const Text('State department'),
          ),
        ],
      );
    }
  )) {
    case Department.treasury:
      // Let's go.
      // ...
    break;
    case Department.state:
      // ...
    break;
  }
}
```
* ListView in a SimpleDialog
* https://stackoverflow.com/a/56355962
```java
// Wraping the ListView in a Container and giving it a width: double.maxFinite, 
// solves the problem with iOS/Android having trouble with ListView inside a dialog:
showDialog(
   context: context,
   builder: (BuildContext context) {
      return AlertDialog(
         content: Container(
            width: double.maxFinite,
            child: ListView(
               children: <Widget>[]
            ),
         ),
      );
   }
);

// In the case of a ListView inside a Column that is inside an AlertDialog:
showDialog(
   context: context,
   builder: (BuildContext context) {
      return AlertDialog(
         content: Container(
            width: double.maxFinite,
            child: Column(
               mainAxisSize: MainAxisSize.min,
               children: <Widget>[
                  Expanded(
                     child: ListView(
                        shrinkWrap: true,
                        children: <Widget>[]
                     )
                  )
               ]
            ),
         ),
      );
   }
);
```

#### NAVIGUER VERS UN SECOND SCAFFOLD
* https://flutter.dev/docs/cookbook#navigation
* https://api.flutter.dev/flutter/widgets/Navigator-class.html
* https://api.flutter.dev/flutter/widgets/Navigator/pop.html
* nouvelle_page.dart
```java
import 'package:flutter/material.dart';

class NouvellePage extends StatelessWidget {
  String title;

  NouvellePage(this.title);

  @override
  Widget build(BuildContext context) {
    // pas besoin de StatefulWidget si les √©l√©ments sont statiques
    return Scaffold(
      appBar: AppBar(
        title: Text(title), // title dynamique
      ),
      body: Center(
        child: Text(
          "Je suis une nouvelle page !",
          textScaleFactor: 2.0,
          textAlign: TextAlign.center,
          style: TextStyle(
            color: Colors.teal,
            fontStyle: FontStyle.italic,
          )
        ),
      ),
    );
  }
}
```
* body.dart
```java
import 'package:flutter/material.dart';
import 'nouvelle_page.dart'; // ++

class Body extends StatefulWidget {
  @override
  _BodyState createState() => _BodyState();
}

// √©tat de notre classe, qui contient tous les champs
class _BodyState extends State<Body> {
  @override
  Widget build(BuildContext context) {
    return Center(
      child: RaisedButton(
        onPressed: toNouvellePage, // ++
        child: Text(
          "Je suis un bouton",
          style: TextStyle(
            color: Colors.white,
            fontSize: 20.0,
          ),
        ),
        color: Colors.red,
        elevation: 10.0,
      ),
    );
  }
  
  void toNouvellePage() {
    Navigator.push(context, MaterialPageRoute(
        builder: (BuildContext context) {
          return NouvellePage("Je suis la nouvelle page !");
        }
    ));
  }
```
#### PASSER DES ARGS AVEC PUSHNAMED
```java
// un seul argument
Navigator.pushNamed(
	context,
	"/urlDestination",
	arguments: Object(arg1: value1, arg2: value2),
);
// exemple
// fichier expediteur
Navigator.pushNamed(context, urlPageDestinataire, arguments: objet)
// fichier receveur
mon_objet = ModalRoute.of(context).settings.arguments;

// avec plusieurs arguments
// fichier expediteur
Navigator.pushNamed(context, urlPageDestinataire, 
  arguments: {'journal': journal, 'article': article});
// fichier receveur
class _ArticleScreenState extends State<ArticleScreen> {
  Journal journal;
  Article article;

  @override
  void didChangeDependencies() {
    // called when a dependency of this State object changes (ex. : Theme.of, ModalRoute.of, ect.)
    // car √† ce moment, ModalRoute a en effet chang√©
    super.didChangeDependencies();
    final Map arguments = ModalRoute.of(context).settings.arguments as Map;
    journal = arguments['journal'];
    article = arguments['article'];
  }
}
```
#### NAVIGUER AVEC DES ROUTES
* https://flutter.dev/docs/cookbook/navigation/named-routes
```java
// constants.dart
const String kRouteHome = "/home";
const String kRoutePage2 = "/page2";

// main.dart
MaterialApp(
  initialRoute: kRouteHome,
  routes: {
    kRouteHome: (context) => HomeScreen(),
    kRoutePage2: (context) => Page2(),
  },
  debugShowCheckedModeBanner: false,
);
```
#### NAVIGATORS
* revenir en arri√®re (si posible)
```java
// page 3
canPop(); // return true 
maybePop(); // s'ex√©cute => revient √† la page 2
// page 1
canPop(); // return false
maybePop(); // ne s'ex√©cute pas (car pas de page pr√©c√©dente)
```
* Force Flutter navigator to reload state when popping > https://stackoverflow.com/questions/49804891/force-flutter-navigator-to-reload-state-when-popping
* se diriger vers une route et supprimer la route appelante du stack
```java
Navigator.popAndPushNamed(context, UrlSecondePage, arguments: objetArgument);
```
* pushReplacementNamed vs. popAndPushNamed
```java
// m√™me objectif : se diriger vers une route et supprimer la route appelante du stack
Navigator.of(context).pushReplacementNamed('/screen4'); // will execute the enter animation
Navigator.popAndPushNamed(context, '/screen4'); // will execute the exit animation

// le cas du Drawer
Navigator.popAndPushNamed(context, kRoutePreferences); // supprime le Drawer du stack
// retour en arri√®re sur la page appelante
Navigator.of(context).pushReplacementNamed(kRoutePreferences); // supprime le Drawer + la page appelante du stack
// retour en arri√®re sur la page avant la page appelante
```
* se diriger vers une route et supprimer un certain nombre de routes derri√®re elle
* https://stackoverflow.com/a/52689158
```java
  _navPaymentSuccessful(){
    Navigator.pushAndRemoveUntil(
      context, 
      MaterialPageRoute(
        builder: (context) => PaymentSuccessful()
      ), 
     ModalRoute.withName("/Home")
    );
  }

// avec arguments
Navigator.pushNamedAndRemoveUntil(context, urlSecondePage, ModalRoute.withName(urlDernierePageDansLeStack), arguments: objetArgument);
```
* remove all routes : https://stackoverflow.com/questions/45889341/flutter-remove-all-routes
```java
Navigator.of(context)
    .pushNamedAndRemoveUntil('/login', (Route<dynamic> route) => false);

// The secret here is using a RoutePredicate that always returns false (Route<dynamic> route) => false. 
// In this situation it removes all of the routes except for the new /login route I pushed
```
* revenir √† une route en supprimant les autres routes du stack
```java
Navigator.popUntil(context, ModalRoute.withName('/screen2'));
```

#### WILLPOPSCOPE
```java
// ‚Üì emp√™che l'utilisateur de revenir en arri√®re
return WillPopScope(
        // ‚Üì expulse l'utilisateur de l'application s'il revient en arri√®re
        onWillPop: () => SystemNavigator.pop(),
        appBar: AppBar(
          // ‚Üì enl√®ve l'icone
          automaticallyImplyLeading: false,
        ),
        child: Scaffold( //...)
      )
```
#### ALERTDIALOG IN WILLPOPSCOPE
```java
return WillPopScope(
      onWillPop: callAlert,
      child: Scaffold(...)
);

Future<bool> callAlert() async {
  return showDialog<void>(
    context: context,
    barrierDismissible: false,
    builder: (BuildContext context) {
      return AlertDialog(
        title: Text("Vous √™tes sur le point de quitter l'application"),
        content: Text("Que souhaitez-vous faire ?"),
        actions: <Widget>[
          FlatButton(
              // l'utilisateur reste sur la page
              onPressed: () => Navigator.pop(context),
              child: Text('Rester sur la page')),
          FlatButton(
              // l'utilisateur revient sur la page d'accueil
              onPressed: () => Navigator.pushNamed(context, "/home",),
              child: Text("Revenir sur la page d'accueil")),
          FlatButton(
              // l'utilisateur est expuls√© de l'application
              onPressed: () => SystemNavigator.pop(),
              child: Text("Quitter l'application")),
        ],
      );
    }) ?? false; // important car onWillPop demande un bool√©en (ici false par d√©faut)
  }
```
#### DRAWER
* https://flutter.dev/docs/cookbook/design/drawer
```java
Widget build(BuildContext context) {
  return Scaffold(
    appBar: AppBar(
      centerTitle: true,
      title: Text(widget.title),
    ),
    // ‚Üì notre drawer √† gauche (voir endDrawer pour la droite), menu coulissant
    drawer: Drawer(
      child: Container(
        child: ListView.builder(
            itemCount: villes.length + 2, // car ajout d'un header + ville actuelle
            // qui seront compris dans la liste
            itemBuilder: (context, i) {
              if (i == 0) { // 1er √©l√©ment de la liste => header du Drawer
                return DrawerHeader(
                  child: Column(
                    mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                    children: <Widget>[
                      texteAvecStyle("Mes Villes", fontSize: 22.0),
                      RaisedButton(
                          color: Colors.white,
                          elevation: 8.0,
                          child: texteAvecStyle("Ajouter une ville", color: Colors.blue),
                          onPressed: ajoutVille
                      )
                    ],
                  ),
                );
              } else if (i == 1) { // => 2√®me √©l√®ment de la liste => ville actuelle
                return ListTile(
                  title: texteAvecStyle(widget.villeDeLutilisateur),
                  onTap: () {
                    setState(() {
                      villeChoisie = null;
                      appelApi();
                      Navigator.pop(context);
                    });
                  },
                );
              } else { // autres √©l√©ments de la liste = les villes repertori√©es
                String ville = villes[i - 2];
                return ListTile(
                  title: texteAvecStyle(ville),
                  trailing: IconButton(
                      icon: Icon(Icons.delete, color: Colors.white,),
                      onPressed: (() => supprimer(ville))),
                  onTap: () {
                    setState(() {
                      villeChoisie = ville;
                      appelApi();
                      Navigator.pop(context);
                    });
                  },
                );
              }
            }),
        color: Colors.blue,
      ),
    ),
    endDrawer: // drawer √† droite
```
* autre exemple
```java
// fichier appelant
Scaffold(
  endDrawer: MenuDrawer(),
)

// menu_drawer.dart
import 'package:flutter/material.dart';
import 'package:font_awesome_flutter/font_awesome_flutter.dart';

import 'package:mon_projet/constants.dart';

class MenuDrawer extends StatelessWidget {
  const MenuDrawer({
    Key key,
  }) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return Drawer(
      child: ListView(
        padding: EdgeInsets.zero,
        children: [
          SizedBox(
            height: 210.0,
            child: DrawerHeader(
              child: Padding(
                padding: EdgeInsets.only(left: 15.0),
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Image.asset("assets/images/mon_image.png", height: 100.0,),
                    SizedBox(height: 20.0,),
                    Text('Mon appli', style: TextStyle(color: Colors.white), textScaleFactor: 1.6,),
                  ],
                ),
              ),
              decoration: BoxDecoration(
                color: kPrimaryColor,
              ),
            ),
          ),
          Padding(
            padding: EdgeInsets.only(left: 15.0),
            child: Column(
              children: [
                ListTile(
                  leading: Icon(FontAwesomeIcons.house),
                  title: Text('Accueil', textScaleFactor: 1.3),
                  onTap: () {
                    Navigator.of(context).pushNamedAndRemoveUntil(
                        kRouteHome, (Route<dynamic> route) => false);
                  },
                ),
                Divider(
                  height: 2.0,
                  thickness: 1.0,
                  color: kLightGreen,
                ),
                ListTile(
                  leading: Icon(FontAwesomeIcons.logOut),
                  title: Text('Quitter', textScaleFactor: 1.3),
                  onTap: () {
                    Navigator.pop(context);
                  },
                ),
                Divider(
                  height: 2.0,
                  thickness: 1.0,
                  color: kLightGreen,
                ),
                ListTile(
                  leading: Icon(FontAwesomeIcons.contact),
                  title: Text('Contact', textScaleFactor: 1.3),
                  onTap: () {
                    // supprime le drawer du stack
                    // et emp√™che un retour en arri√®re sur le drawer
                    Navigator.popAndPushNamed(context, UrlContact, arguments: objetArgument);
                  },
                ),
              ],
            ),
          ),
        ],
      ),
    );
  }
}
```
#### SNACKBAR
* https://stackoverflow.com/a/49932085
```java
class MainPageState extends State<MainPage> {                                                BuildContext scaffoldContext; // context pour le SnackBar

@override  
Widget build(BuildContext context) {
return Scaffold(
    backgroundColor: Colors.grey,         
    appBar: AppBar(                   
      title: const Text(APP_TITLE),                                 
    ),                               
    body: Builder(builder: (BuildContext context) { // Builder pour cr√©er le context        
      scaffoldContext = context; // context pour le SnackBar
      return Center(
        child: Text('Hello World', style: TextStyle(fontSize: 32.0)),
      );
    })
  );
}

// une fois la fonction appel√©e, le snackBar s'affichera
void showSnackBar(String message) {
  final snackBar = SnackBar(content: Text(message),
  backgroundColor: Colors.red);
  // Find the Scaffold in the Widget tree and use it to show a SnackBar!
  Scaffold.of(scaffoldContext).showSnackBar(snackBar);
  }
}
```

### WIDGETS INTERACTIFS

#### FORM
* https://flutter.dev/docs/cookbook/forms/validation
* https://flutter.dev/docs/cookbook/forms/text-field-changes
```java
import 'package:flutter/material.dart';

void main() => runApp(MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final appTitle = 'Form Validation Demo';

    return MaterialApp(
      title: appTitle,
      home: Scaffold(
        appBar: AppBar(
          title: Text(appTitle),
        ),
        body: MyCustomForm(),
      ),
    );
  }
}

// Create a Form widget.
class MyCustomForm extends StatefulWidget {
  @override
  MyCustomFormState createState() {
    return MyCustomFormState();
  }
}

// Create a corresponding State class.
// This class holds data related to the form.
class MyCustomFormState extends State<MyCustomForm> {
  // Create a global key that uniquely identifies the Form widget
  // and allows validation of the form.
  //
  // Note: This is a GlobalKey<FormState>,
  // not a GlobalKey<MyCustomFormState>.
  final _formKey = GlobalKey<FormState>();

  @override
  Widget build(BuildContext context) {
    // Build a Form widget using the _formKey created above.
    return Form(
      key: _formKey,
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: <Widget>[
          TextFormField(
            onChanged: (value) => _formKey.currentState.validate(), 
            // valide le formulaire √† la vol√©e
            // utilise pour supprimer le message d'erreur en continuant la saisie
            validator: (value) {
              if (value.isEmpty) {
                return 'Please enter some text';
              }
              return null;
            },
          ),
          Padding(
            padding: const EdgeInsets.symmetric(vertical: 16.0),
            child: RaisedButton(
              onPressed: () {
                // Validate returns true if the form is valid, or false
                // otherwise.
                if (_formKey.currentState.validate()) {
                  // If the form is valid, display a Snackbar.
                  Scaffold.of(context)
                      .showSnackBar(SnackBar(content: Text('Processing Data')));
                }
              },
              child: Text('Submit'),
            ),
          ),
        ],
      ),
    );
  }
}
```

### VALIDATION FORMULAIRE A LA VOLEE
```java
class _XState extends State<X> {
  final _formKey = GlobalKey<FormState>();
  bool _autovalidate = false;

Form(
  key: _formKey,
  autovalidate: _autovalidate,
	onPressed: submitForm,
)

void submitForm() {
    if (_formKey.currentState.validate()) {
      // validation
    } else {
      // valide le formulaire √† la vol√©e
      // et permet d'enlever les messages d'erreur
      setState(() => _autovalidate = true);
    }
  }
```

#### TEXTFIELD
* Tip: Use 'LengthLimitingTextInputFormatter(n)' instead of 'maxLength' property to hide the restricting input numbers label below TextField : https://twitter.com/dhruvashastri12/status/1314572917737500672
```java
class _MyHomePageState extends State<MyHomePage> {

  String changed;
  String submitted;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: <Widget>[
            TextField(
              // ‚Üì apparence du clavier
              // .number pour juste des nombres
              // .emailAddress pour les mails
              keyboardType: TextInputType.text,
              obscureText: true, // textfield secret ‚Ä¢‚Ä¢‚Ä¢‚Ä¢
              autofocus: true, // l'utilisateur est automatiquement dirig√© dans le TextField
              // ce qui ouvre instantan√©ment le clavier
              textAlign: TextAlign.center, // texte et curseur au milieu
              // expand a textField in Flutter looks like a textarea
              maxLines: null, // or 20, for limit
              keyboardType: TextInputType.multiline,
              // ‚Üì plut√¥t que maxLength
              inputFormatters: LengthLimitingTextInputFormatter(10),
              onChanged: (String value) {
                setState(() {
                  // ‚Üì changement √† la vol√©e
                  changed = value;
                });
              },
              onSubmitted: (String value) {
                setState(() {
                  // ‚Üì changement √† la soumission du formulaire
                  submitted = value;
                });
              },
              decoration: InputDecoration(
                labelText: "Entrez votre nom",
              ),
            ),
            Text(changed ?? ""),
            Text(submitted ?? ""),
          ],
        )
      ),
    );
  }
}

// (!) number avec IOS
class _MyHomePageState extends State<MyHomePage> {

  String changed;
  String submitted;

  @override
  Widget build(BuildContext context) {
    // ‚Üì palier l'abscence de submit pour les numbers chez IOS
    // rentre le clavier quand l'utilisateur touche l'√©cran
    // (sinon il ne peut pas quitter le clavier)
    return GestureDetector( // A widget that detects gestures
      onTap: () {
        Focus.of(context).requestFocus(FocusNode());
      },
      child: Scaffold(
        appBar: AppBar(
          title: Text(widget.title),
        ),
        body: Center(
            child: Column(
              mainAxisAlignment: MainAxisAlignment.center,
              children: <Widget>[
                TextField(
                  // ‚Üì apparence du clavier
                  // .number pour juste des nombres
                  keyboardType: TextInputType.number,
                  onChanged: (String value) {
                    setState(() {
                      // ‚Üì changement √† la vol√©e
                      changed = value;
                    });
                  },
                  onSubmitted: (String value) {
                    setState(() {
                      // ‚Üì changement √† la soumission du formulaire
                      submitted = value;
                    });
                  },
                  decoration: InputDecoration(
                    labelText: "Entrez votre nom",
                  ),
                ),
                Text(changed ?? ""),
                Text(submitted ?? ""),
              ],
            )
        ),
      ),
    );
  }
}

// How to expand a textField in flutter looks like a text Area
TextField(
  maxLines: null,
  keyboardType: TextInputType.multiline,
)

// scrollable TextField avec padding
SingleChildScrollView(
  child: TextField(
    maxLines: 5, // max lignes affich√©es (scrolle si + de 5 lignes)
    keyboardType: TextInputType.multiline,
    decoration: InputDecoration(
        contentPadding: EdgeInsets.all(10.0), // padding
        filled: true,
        fillColor: Colors.white,
        border: OutlineInputBorder(),
        hintText:
            "Vous pouvez ici d√©crire l'√©v√®nement en d√©tails..."),
  ),
),
```
#### TEXTFORMFIELD
```java
TextFormField(
  style: TextStyle(fontSize: 18.0),
  decoration: InputDecoration(
    border: OutlineInputBorder(),
    labelText: 'Mot de passe',
    prefixIcon: Icon(
      Icons.lock,
      color: Colors.grey[700],
    ),
  ),
  validator: (value) => value.length < 7
      ? 'Le mot de passe doit contenir au moins 8 caract√®res.'
      : null,
  onSaved: (value) => password = value,
  obscureText: true, // cache la saisie utilisateur
),
```

#### CHECKBOX
```java
class _MyHomePageState extends State<MyHomePage> {

  Map check = {
    'Carottes': false,
    'Bananes': false,
    'Yaourt': false,
    'Pain': false,
  };

  // m√©thode qui cr√©e nos widgets <row>checkbox</row>
  List<Widget> checkList() {
    // ajouter = [] pour palier l'erreur de type
    // The method 'add' was called on null
    List<Widget> myList = [];
    check.forEach((key, value) {
      Row row = Row(
        mainAxisAlignment: MainAxisAlignment.center,
        children: <Widget>[
          Text(key,
          style: TextStyle(
            // change l'apparence du texte √† la vol√©e
            color: value ? Colors.blue : Colors.red,
          )),
          Checkbox(
              value: value,
              onChanged: (bool answer) {
                setState(() {
                  check[key] = answer;
                });
              }
          )
        ],
      );
      myList.add(row);
    });
    return myList;
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: checkList(),
        )
      ),
    );
  }
}
```
##### CHECKBOXLISTTILE
* ListTile + Chechbox = une Row checkbox
* https://stackoverflow.com/questions/55265313/remove-space-top-and-bottom-listtile-flutter
```java
  Map messagesPreferences = {
    'choix1': true,
    'choix2': true,
  };

// dans le build
...messagesPreferencesList()

List<Widget> messagesPreferencesList() {
  List<Widget> myList = [];
  // avec checkboxListTile
  messagesPreferences.forEach((key, value) {
    CheckboxListTile checkboxListTile = CheckboxListTile(
        value: value, // true
        dense: true, // annule le spacing vertical
        controlAffinity: ListTileControlAffinity.leading, // place le checkbox au d√©but
        title: Text(key), // choix1
        onChanged: (bool answer) { // true or false
          setState(() {
            messagesPreferences[key] = answer; // choix1 = answer
          });
        });
    // √©quivalent en Row
    Row row = Row(
      children: [
        Checkbox(
            value: value,
            onChanged: (bool answer) {
              setState(() {
                messagesPreferences[key] = answer;
              });
            }),
        Text(key),
      ],
    );
    myList.add(checkboxListTile); // ajoute chaque checkboxListTile √† la liste renvoy√©e
  });
  return myList;
}
```

#### RADIO
* https://api.flutter.dev/flutter/material/Radio-class.html
* Exemple : ListTile = https://api.flutter.dev/flutter/material/ListTile-class.html
* ListTile permet de faire des row homog√®nes avec 3 √©l√©ments
* To change the default color of Radio Button, wrap it inside Theme as it uses unselectedWidgetColor property of ThemeData : https://twitter.com/dhruvashastri12/status/1305498160685625345
```java
class _MyHomePageState extends State<MyHomePage> {

  int itemSelected;

  List<Widget> radios() {
    List<Widget> myList = [];
    for (int i = 0; i < 4; i++) {
      Row row = Row(
        children: <Widget>[
          Text("Choix num√©ro ${i + 1}"),
          Radio(
            value: i,
            groupValue: itemSelected, // valeur choisie
            onChanged: (int answer) {
              setState(() {
                itemSelected = answer;
              });
          })
        ],
      );
      myList.add(row);
    }
    return myList;
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: radios(), // ++
        )
      ),
    );
  }
}

// ‚Üì avec ListTile
enum SingingCharacter { lafayette, jefferson }

// ...
// ‚Üì les ListTile poss√®de le m√™me groupValue
SingingCharacter _character = SingingCharacter.lafayette;

Widget build(BuildContext context) {
  return Column(
    children: <Widget>[
      ListTile( // premi√®re row avec checkbox
        title: const Text('Lafayette'),
        leading: Radio(
          value: SingingCharacter.lafayette,
          groupValue: _character,
          onChanged: (SingingCharacter value) {
            setState(() { _character = value; });
          },
        ),
      ),
      ListTile( // deuxi√®me row avec checkbox
        title: const Text('Thomas Jefferson'),
        leading: Radio(
          value: SingingCharacter.jefferson,
          groupValue: _character,
          onChanged: (SingingCharacter value) {
            setState(() { _character = value; });
          },
        ),
      ),
    ],
  );
}
```
#### SWITCH
* Choix True/False
* Equivalent de Toggle Switch de Bootstrap
```java
class _MyHomePageState extends State<MyHomePage> {

  bool interrupteur = false;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: <Widget>[
            Text("Aimez-vous le gras ?",
              style: TextStyle(
                // ‚Üì change le texte selon la r√©ponse du switch
                color: interrupteur ? Colors.green : Colors.red,
              )
            ),
            Switch(
              value: interrupteur,
              // ‚Üì interrupteur = false
              inactiveTrackColor: Colors.red,
              // ‚Üì interrupteur = true
              activeColor: Colors.green,
              onChanged: (bool answer) {
                setState(() {
                  interrupteur = answer;
                });
              }
            )
          ],
        )
      ),
    );
  }
}
```
#### SLIDER
* Principe = curseur coulissant sur une ligne
* But = s√©lectionner une rang√©e de valeurs
```java
class _MyHomePageState extends State<MyHomePage> {

  double numSlider = 0.0;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: <Widget>[
            Text("Valeur du slider : $numSlider",
              style: TextStyle(
                color: interrupteur ? Colors.green : Colors.red,
              )
            ),
            Slider(
              value: numSlider,
              min: 0.0,
              max: 10.0,
              // ‚Üì partie devant le curseur (inexplor√©e)
              inactiveColor: Colors.black,
              // ‚Üì partie derri√®re le curseur (explor√©e)
              activeColor: Colors.pinkAccent,
              // ‚Üì points d'arr√™ts
              divisions: 5,
              onChanged: (double mouse) {
                setState(() {
                  numSlider = mouse;
                });
              }
            )
          ],
        )
      ),
    );
  }
}
```
#### DATE TIME PICKERS
```java
import 'package:flutter/material.dart';
import 'package:flutter_localizations/flutter_localizations.dart'; // supporter les locales

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  // This widget is the root of your application.
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Flutter Demo',
      localizationsDelegates: [ // ++
        GlobalMaterialLocalizations.delegate,
        GlobalWidgetsLocalizations.delegate,
      ],
      supportedLocales: [ // ++
        const Locale('en', 'US'),
        const Locale('ru', 'RU'),
        const Locale('fr', 'FR'),
      ],
      theme: ThemeData(
        primarySwatch: Colors.blue,
        visualDensity: VisualDensity.adaptivePlatformDensity,
      ),
      home: MyHomePage(title: 'Flutter Demo Home Page'),
    );
  }
}

class _MyHomePageState extends State<MyHomePage> {

  DateTime myDate; // ++
  TimeOfDay myTime; // ++

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: <Widget>[
            FlatButton(
              onPressed: () {
                showCalendar();
              },
              child: Text((myDate == null) ? 'Choisir une date' : myDate.toString())
            ),
            FlatButton(
              onPressed: () {
                showHour();
              },
              child: Text((myTime == null) ? 'Choisir une heure' : myTime.toString())
            ),
          ],
        )
      ),
    );
  }

  Future<void> showCalendar() async {
    // DateTime today = DateTime.now();
    // ‚Üì affichage d'un calendrier
    DateTime choice = await showDatePicker(
        helpText: 'SELECTIONNEZ UNE DATE',
        context: context,
        // ‚Üì choix de l'ann√©e PUIS choix du mois/jour
        initialDatePickerMode: DatePickerMode.year,
        initialDate: DateTime.now(), // date √† l'ouverture du calendrier
        firstDate: DateTime(2018), // d√©but du calendrier
        // firstDate: today.subtract(Duration(days: 60)),
        lastDate: DateTime(2022), // fin du calendrier
        // lastDate: today.add(Duration(days: 60)),
        locale: const Locale('fr', 'FR'), // nomination fr
        // ‚Üì personnalisation
        builder: (BuildContext context, Widget child) {
          return Theme(
            data: ThemeData.light().copyWith(
              accentColor: Theme.of(context).primaryColor,
              colorScheme: ColorScheme.light(
                  primary: Theme.of(context).primaryColor,
                  onSurface: Theme.of(context).primaryColor, // couleur des nombres
                  secondary: Theme.of(context).primaryColor),
              buttonTheme: ButtonThemeData(
                textTheme: ButtonTextTheme.accent,
              ),
            ),
            child: child,
          );
        });

    if (choice != null) {
      setState(() {
        myDate = choice;
      });
    }
  }

  Future<void> showHour() async {
    // ‚Üì affichage d'une horloge
    TimeOfDay hour = await showTimePicker(
      context: context,
      initialTime: TimeOfDay.now()
    );

    if (hour != null) {
      setState(() {
        myTime = hour;
      });
    }
  }
}
```
* pubspec.yaml :
```yaml
dependencies:
  flutter:
    sdk: flutter
  flutter_localizations: # ++
    sdk: flutter
```
#### DROPDOWNBUTTON
* Dropdown overflow : https://stackoverflow.com/a/61896777
```java
// √©viter le overflow d'un dropdownbutton
DropdownButton(
  isExpanded: true, // Step 1
  items: [
      DropdownMenuItem(
          child: Text("Long text that overflow the size.. wrapped or ellipsized", 
          overflow: TextOverflow.ellipsis),  // Step 2
      ),
  ],
  onChanged: (val) { }
)

// ajouter du style au texte
DropdownButton(
  style: TextStyle(fontSize: 14.0),
)

// personnaliser l'apparence d'un dropdownbutton
// ici le dropdown est dans une Row
Row(
  mainAxisAlignment: MainAxisAlignment.center,
  children: [
    Expanded(
      // personnalisation
      child: Container(
        padding: EdgeInsets.only(left: 10.0, top: 4.0, bottom: 4.0),
        decoration: BoxDecoration(
          border: Border.all(color: Colors.grey[300]),
          borderRadius: BorderRadius.all(Radius.circular(6.0)),
          color: Colors.grey[300],
        ),
        // suppresion de la ligne basse
        child: DropdownButtonHideUnderline(
          child: DropdownButton(
              value: elementDeMaListe,
              isExpanded: true,
              items: maListe.map<DropdownMenuItem<String>>(
                  (String value) {
                return DropdownMenuItem<String>(
                  value: value,
                  child: Text(value, overflow: TextOverflow.ellipsis),
                );
              }).toList(),
              onChanged: (value) {
                setState(() {
                  elementDeMaListe = value;
                });
              }),
        ),
      ),
    ),
    SizedBox(
      width: 15.0,
    ),
    Text("Item2"),
  ],
),
```

##### DROPDOWNBUTTON WITH MAP
* https://stackoverflow.com/questions/52030797/making-a-dropdown-menu-in-flutter-with-a-map
```java
Map<String, String> myMap = {
"code1": "value1",
"code2": "value2"
}

String selectedValue = "value1";

DropdownButton(
  value: selectedValue,
  isExpanded: true,
  style: TextStyle(fontSize: 14.0),
  items: myMap
      .map((String code, String value) {
        return MapEntry(
            code,
            DropdownMenuItem<String>(
              value: value,
              child: Text(
                value,
                overflow: TextOverflow.ellipsis,
                style: TextStyle(color: kTitleColor),
              ),
            ));
      })
      .values
      .toList(),
  onChanged: (value) {
    setState(() {
      selectedValue = value;
      var keyValue = myMap.keys.firstWhere(
              (key) => myMap[key] == value,
          orElse: () => null);
    });
  }
);
```

#### DROPDOWNBUTTONFORMFIELD
* DropdownButton with validation
* https://stackoverflow.com/questions/52926335/how-validate-dropdown-in-flutter
* Bouton d√©sactivit√© avec placeholder : https://stackoverflow.com/a/61659089
```java
import 'package:flutter/material.dart';

class FormValidationWithDropdown extends StatefulWidget {
  @override
  _FormValidationWithDropdownState createState() =>
      _FormValidationWithDropdownState();
}

class _FormValidationWithDropdownState extends State<FormValidationWithDropdown> {
  final _formKey = GlobalKey<FormState>();
  bool _autovalidate = false;
  String selectedSalutation;
  String name;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Form(
        key: _formKey,
        autovalidate: _autovalidate,
        child: Column(
          children: <Widget>[
            DropdownButtonFormField<String>(
              value: selectedSalutation,
              hint: Text(
                'Salutation',
              ),
              disabledHint: Text(defaultValue), // activ√© si onChanged = null
              // peut √™tre utilis√© pour afficher du texte si le button est d√©sactiv√©
              onChanged: (salutation) =>
                  setState(() => selectedSalutation = salutation),
              validator: (value) => value == null ? 'field required' : null,
              items:
                  ['MR.', 'MS.'].map<DropdownMenuItem<String>>((String value) {
                return DropdownMenuItem<String>(
                  value: value,
                  child: Text(value),
                );
              }).toList(),
            ),
            TextFormField(
              decoration: InputDecoration(hintText: 'Name'),
              validator: (value) => value.isEmpty ? 'Name is required' : null,
              onSaved: (value) => name = value,
            ),
            FlatButton(
              child: Text('PROCEED'),
              color: Colors.green,
              onPressed: () {
                if (_formKey.currentState.validate()) {
                  //form is valid, proceed further
                  _formKey.currentState.save();//save once fields are valid, onSaved method invoked for every form fields

                } else {
                  setState(() {
                    _autovalidate = true; //enable realtime validation
                  });
                }
              },
            )
          ],
        ),
      ),
    );
  }
}

// exemple g√©n√©rique
// ‚Üì encapsul√© dans un widget Form, avec sa key
// + v√©rification de la validt√© du bouton avec formKey.currentState.validate
DropdownButtonFormField(
  // ‚Üì enl√®ve le underline
  decoration: InputDecoration.collapsed(),
  hint: Text('Placeholder'),
  value: _valueUser,
  items: maListe.map((data) {
      return DropdownMenuItem(
        child: Text(data),
        value: data,
      );
    }).toList(),
  onChanged: (value) {
      setState(() {
        _valueUser = value;
      });
    },
  validator: (value) => value == null ? 'Message d\'erreur' : null,
);
```
#### URL_LAUNCHER
* Diriger l'utilisateur vers un lien (Youtube), ouvir un message SMS, taper un num√©ro de t√©l√©phone, ect.
* https://pub.dev/packages/url_launcher


### WIDGETS SCROLLABLES

#### SINGLECHILDSCROLLVIEW
* Permet de rendre son contenu scrollable
* Design trop grand pour l'√©cran, mais pas une liste
* Ex. une page qui demande l'ouverture du clavier
* https://api.flutter.dev/flutter/widgets/SingleChildScrollView-class.html
```java
class _MyHomePageState extends State<MyHomePage> {

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      // ‚Üì avant Center() mais message d'erreur si trop d'√©l√©ments
      body: SingleChildScrollView(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: <Widget>[
            Container(height: 100.0, color: Colors.red,),
            Container(height: 100.0, color: Colors.blue,),
            Container(height: 100.0, color: Colors.yellow,),
            Container(height: 100.0, color: Colors.green,),
            Container(height: 100.0, color: Colors.red,),
            Container(height: 100.0, color: Colors.blue,),
            Container(height: 100.0, color: Colors.yellow,),
            Container(height: 100.0, color: Colors.green,),
          ],
        ),
      ),// This trailing comma makes auto-formatting nicer for build methods.
    );
  }
}
```
#### LISTVIEW ET LISTTILE
* Cr√©ation d'une liste scrollable
* Page scrollable qui d√©passe le viewport = utiliser ListView
* Vertical viewport was given unbounded height for ListView/GridView : https://stackoverflow.com/a/57335217 + https://stackoverflow.com/questions/50252569/vertical-viewport-was-given-unbounded-height
```java
ListView(
  // Says to the `ListView` that it must wrap its
  // height (if it's vertical) and width (if it's horizontal).
  shrinkWrap: true,
),
```java
class _MyHomePageState extends State<MyHomePage> {

  List<Activite> activites = [
    Activite("V√©lo", Icons.directions_bike),
    Activite("Peinture", Icons.palette),
    Activite("Golf", Icons.golf_course),
    Activite("Arcade", Icons.gamepad),
    Activite("Bricolage", Icons.build),
    // en ajouter pour pouvoir scroller
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: ListView.builder(
          // ‚Üì rend le Listview scrollable
          scrollDirection: Axis.vertical, // optionnel
          shrinkWrap: true, // permet de scroller
          physics: ScrollPhysics(), // permet de scroller hors du viewport

          reverse: true, // affichage de la liste focalis√© sur la fin de liste

          itemCount: activites.length, // nombre d'√©l√©ments dans la liste
          // ‚Üì cr√©ateur de la liste (boucle)
          itemBuilder: (context, index) {
            return ListTile(
              leading: Icon(Icons.add, color: Colors.blue), // gauche de la liste
              title: Text('Activit√© ${activites[index].nom}'), // centre de la liste
              trailing: Icon(activites[index].icone), // droite de la liste
            );
          }
        ),
      ),// This trailing comma makes auto-formatting nicer for build methods.
    );
  }
}

class Activite {
  String nom;
  IconData icone;

  Activite(this.nom, this.icone);
}
```
* LIST VIEW NON SCROLLABLE
```java
ListView.builder(
	physics: NeverScrollableScrollPhysics(),
)
```
* N'AFFICHER QU'UN NOMBRE PRECIS D'ELEMENTS
```java
ListView.builder(
// n'affiche que les 3 premiers √©l√©ments de ma liste
	itemCount: maListe.length < 4 ? maListe.length : 3,
)
```
* ListTile avec elevation
```java
Card(
  child: ListTile(
  leading: Icon(
    FontAwesomeIcons.mapMarkerAlt,
    color: kMainColor,
  ),
  title: Text(kLabelAddress),
  onTap: () {},
))
```
#### HORIZONTAL LISTVIEW INSIDE A VERTICAL SCROLLVIEW
* https://stackoverflow.com/questions/54512171/horizontal-listview-inside-a-vertical-scrollview-in-flutter
```java
body: ListView(
        children: [
          Container(
            child: Container(
              child: Column(
                children: [
                  // ‚Üì r√®gle le probl√®me du unbounded height for ListView/GridView
                  SizedBox(
                    height: MediaQuery.of(context).size.height * 0.2,
                    child: ListView.builder(
                        shrinkWrap: true,
                        itemCount: selectedMenu.getEntrees.length,
                        itemBuilder: (context, index) {
                            return Card(
                              child: Container(
                                  width: MediaQuery.of(context).size.width * 0.5,
                                    child: Text(selectedMenu.getEntrees[index].type)),
                              );
                        },
                        scrollDirection: Axis.horizontal,
                      ),
                	)
		            ]
	            )
            )
          )
        ]
      )
```
#### DISMISSIBLE
* Supprimer une tile en la coulissant (swipe)
```java
class _MyHomePageState extends State<MyHomePage> {

  List<Activite> activites = [
    Activite("V√©lo", Icons.directions_bike),
    Activite("Peinture", Icons.palette),
    Activite("Golf", Icons.golf_course),
    Activite("Arcade", Icons.gamepad),
    Activite("Bricolage", Icons.build),
    // en ajouter pour pouvoir scroller
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: ListView.builder(
          itemCount: activites.length, // nombre d'√©l√©ments dans la liste
          // ‚Üì cr√©ateur de la liste (boucle)
          itemBuilder: (context, index) {
            Activite activite = activites[index];
            String key = activite.nom;
            return Dismissible(
              key: Key(key),
              child: ListTile(
                leading: Icon(Icons.add, color: Colors.blue), // gauche de la liste
                title: Text('Activit√© ${activite.nom}'), // centre de la liste
                trailing: Icon(activite.icone), // droite de la liste
              ),
              background: Container(
                color: Colors.red, // couleur quand on fait coulisser l'√©l√©ment
                padding: EdgeInsets.only(right: 20.0),
                child: Row(
                  mainAxisAlignment: MainAxisAlignment.end,
                  children: <Widget>[
                    Text("Supprimer", style: TextStyle(color: Colors.white)),
                    Icon(Icons.delete, color: Colors.white,)
                  ],
                ),
              ),
              // action √† faire lors du swipe
              onDismissed: (direction) {
                setState(() {
                  print(activite.nom);
                  activites.removeAt(index); // suppression de la liste
                });
              },
            );
          }
        ),
      ),// This trailing comma makes auto-formatting nicer for build methods.
    );
  }
}
```
#### CUSTOMTILE
* Cr√©er une tile personnalis√©e
```java
class _MyHomePageState extends State<MyHomePage> {

  List<Activite> activites = [
    Activite("V√©lo", Icons.directions_bike),
    Activite("Peinture", Icons.palette),
    Activite("Golf", Icons.golf_course),
    Activite("Arcade", Icons.gamepad),
    Activite("Bricolage", Icons.build),
    // en ajouter pour pouvoir scroller
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: ListView.builder(
          itemCount: activites.length, // nombre d'√©l√©ments dans la liste
          // ‚Üì cr√©ateur de la liste (boucle)
          itemBuilder: (context, index) {
            Activite activite = activites[index];
            String key = activite.nom;
            return Dismissible(
              key: Key(key),
              // ‚Üì Custom Tile
              child: Container(
                padding: EdgeInsets.all(5.0),
                height: 125.0,
                child: Card(
                  elevation: 7.5,
                  child: Container(
                    child: Row(
                      mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                      children: <Widget>[
                        // sur la gauche : grosse icone de l'activite
                        Icon(activite.icone, color: Colors.blue, size: 75.0,),
                        // sur la droite :
                        // <h3>Activite<h3>
                        // <h2>nom de l'activite<h2>
                        Column(
                          mainAxisAlignment: MainAxisAlignment.center,
                          children: <Widget>[
                            Text("Activit√©",
                              style: TextStyle(
                                  color: Colors.blue,
                                  fontSize: 20.0,
                                  fontWeight: FontWeight.bold
                              ),
                            ),
                            Text(activite.nom,
                            style : TextStyle(
                              color: Colors.blue[800],
                              fontSize: 30.0,
                            )),
                          ],
                        )
                      ],
                    ),
                  ),
                ),
              ),
              background: Container(
                color: Colors.red, // couleur quand on fait coulisser l'√©l√©ment
                padding: EdgeInsets.only(right: 20.0),
                child: Row(
                  mainAxisAlignment: MainAxisAlignment.end,
                  children: <Widget>[
                    Text("Supprimer", style: TextStyle(color: Colors.white)),
                    Icon(Icons.delete, color: Colors.white,)
                  ],
                ),
              ),
              onDismissed: (direction) {
                setState(() {
                  print(activite.nom);
                  activites.removeAt(index);
                });
              },
            );
          }
        ),
      ),
    );
  }
}
```
#### INKWELL
* Un container qui r√©pond au toucher
* https://api.flutter.dev/flutter/material/InkWell-class.html
* https://stackoverflow.com/questions/56725308/flutter-inkwell-vs-gesturedetector-what-is-the-difference
```java
class _MyHomePageState extends State<MyHomePage> {

  List<Activite> activites = [
    Activite("V√©lo", Icons.directions_bike),
    Activite("Peinture", Icons.palette),
    Activite("Golf", Icons.golf_course),
    Activite("Arcade", Icons.gamepad),
    Activite("Bricolage", Icons.build),
    // en ajouter pour pouvoir scroller
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: ListView.builder(
          itemCount: activites.length, // nombre d'√©l√©ments dans la liste
          // ‚Üì cr√©ateur de la liste (boucle)
          itemBuilder: (context, index) {
            Activite activite = activites[index];
            String key = activite.nom;
            return Dismissible(
              key: Key(key),
              // ‚Üì Custom Tile
              child: Container(
                padding: EdgeInsets.all(5.0),
                height: 125.0,
                child: Card(
                  elevation: 7.5,
                  // ‚Üì le Card devient cliquable
                  child: InkWell(
                    onTap: () => print("${activite.nom} tapped"),
                    onLongPress: () => print("${activite.nom} pressed"),
                    child: Container(
                      child: Row(
                        mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                        children: <Widget>[
                          Icon(activite.icone, color: Colors.blue, size: 75.0,),
                          Column(
                            mainAxisAlignment: MainAxisAlignment.center,
                            children: <Widget>[
                              Text("Activit√©",
                                style: TextStyle(
                                    color: Colors.blue,
                                    fontSize: 20.0,
                                    fontWeight: FontWeight.bold
                                ),
                              ),
                              Text(activite.nom,
                                  style : TextStyle(
                                    color: Colors.blue[800],
                                    fontSize: 30.0,
                                  )),
                            ],
                          )
                        ],
                      ),
                    ),
                  ),
                ),
              ),
              background: Container(
                color: Colors.red, // couleur quand on fait coulisser l'√©l√©ment
                padding: EdgeInsets.only(right: 20.0),
                child: Row(
                  mainAxisAlignment: MainAxisAlignment.end,
                  children: <Widget>[
                    Text("Supprimer", style: TextStyle(color: Colors.white)),
                    Icon(Icons.delete, color: Colors.white,)
                  ],
                ),
              ),
              onDismissed: (direction) {
                setState(() {
                  print(activite.nom);
                  activites.removeAt(index);
                });
              },
            );
          }
        ),
      ),
    );
  }
}
```
#### VERIFIER ORIENTATION DEVICE
```java
class _MyHomePageState extends State<MyHomePage> {

  @override
  Widget build(BuildContext context) {
    // ‚Üì orientation de l'appareil
    Orientation orientation = MediaQuery.of(context).orientation;
    print(orientation); // Orientation.portrait
    // autre choix = Orientation.landscape
```
#### CHOISIR ORIENTATION DEVICE
```java
import 'package:flutter/material.dart';
import 'package:flutter/services.dart'; // ++

void main() {
  SystemChrome.setPreferredOrientations([
    DeviceOrientation.portraitUp, // force le mode portrait
    // DeviceOrientation.landscapeLeft,
    // DeviceOrientation.landscapeRight,
    // DeviceOrientation.portraitDown
  ]);
  runApp(MyApp());
}
```
#### GRIDVIEW
* Cr√©ation d'une grille de contenu qui s'adapte √† l'orientation de l'appareil
* Vertical viewport was given unbounded height for ListView/GridView : https://stackoverflow.com/a/57335217 + https://stackoverflow.com/questions/50252569/vertical-viewport-was-given-unbounded-height
```java
ListView(
  // Says to the `ListView` that it must wrap its
  // height (if it's vertical) and width (if it's horizontal).
  shrinkWrap: true,
),
```java
class _MyHomePageState extends State<MyHomePage> {

  List<Activite> activites = [
    Activite("V√©lo", Icons.directions_bike),
    Activite("Peinture", Icons.palette),
    Activite("Golf", Icons.golf_course),
    Activite("Arcade", Icons.gamepad),
    Activite("Bricolage", Icons.build),
    // en ajouter pour pouvoir scroller
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        // ‚Üì container de notre grille
        // s'adapate √† l'orientation de l'appareil
        child: GridView.builder(
          // autre possiblit√© : SliverGridDelegateWithMaxCrossAxisExtent
          // 3 items par ligne
          gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(crossAxisCount: 3),
          itemCount: activites.length,
          // ‚Üì constructeur de notre grille
          itemBuilder: (context, index) {
            return Container(
              margin: EdgeInsets.all(2.5),
              child: Card(
                elevation: 10.0,
                child: Column(
                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                  children: <Widget>[
                    Text("Activit√©", style: TextStyle(color: Colors.teal, fontSize: 15.0),),
                    Text(activites[index].nom, style: TextStyle(color: Colors.teal[600],
                        fontSize: 20.0, fontWeight: FontWeight.bold), ),
                    Icon(activites[index].icone, color: Colors.teal, size: 45.0,)
                  ],
                ),
              ),
            );
          }
        ),
      ),
    );
  }
```
##### Center a GridView
* https://stackoverflow.com/questions/49528520/flutter-layout-with-grid-at-center
```java
body: Center(
  child: GridView.count(
    shrinkWrap: true,
    crossAxisCount: 4,
    children: childrenWidgets,
    childAspectRatio: r,
  ),
),
```
#### LISTE OU GRILLE SELON ORIENTATION
```java
class _MyHomePageState extends State<MyHomePage> {

  List<Activite> activites = [
    Activite("V√©lo", Icons.directions_bike),
    Activite("Peinture", Icons.palette),
    Activite("Golf", Icons.golf_course),
    Activite("Arcade", Icons.gamepad),
    Activite("Bricolage", Icons.build),
    // en ajouter pour pouvoir scroller
  ];

  @override
  Widget build(BuildContext context) {
    // ‚Üì orientation de l'appareil
    Orientation orientation = MediaQuery.of(context).orientation;
    print(orientation); // Orientation.portrait
    // autre choix = Orientation.landscape

    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        // ‚Üì un ternaire selon l'orientation
        child: (orientation == Orientation.portrait) ? liste() : grille(),
      ),
    );
  }

  Widget grille() {
    return GridView.builder(
      // autre possiblit√© : SliverGridDelegateWithMaxCrossAxisExtent
      // 3 items par ligne
        gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(crossAxisCount: 4),
        itemCount: activites.length,
        // ‚Üì constructeur de notre grille
        itemBuilder: (context, index) {
          return Container(
            margin: EdgeInsets.all(2.5),
            child: Card(
              elevation: 10.0,
              // ‚Üì ajout du InkWell
              child: InkWell(
                onTap: () => print("Grid tapped !"),
                child: Column(
                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                  children: <Widget>[
                    Text("Activit√©", style: TextStyle(color: Colors.teal, fontSize: 15.0),),
                    Text(activites[index].nom, style: TextStyle(color: Colors.teal[600],
                        fontSize: 20.0, fontWeight: FontWeight.bold), ),
                    Icon(activites[index].icone, color: Colors.teal, size: 45.0,)
                  ],
                ),
              ),
            ),
          );
        }
    );
  }

  Widget liste() {
    return ListView.builder(
        itemCount: activites.length, // nombre d'√©l√©ments dans la liste
        // ‚Üì cr√©ateur de la liste (boucle)
        itemBuilder: (context, index) {
          Activite activite = activites[index];
          String key = activite.nom;
          return Dismissible(
            key: Key(key),
            // ‚Üì Custom Tile
            child: Container(
              padding: EdgeInsets.all(5.0),
              height: 125.0,
              child: Card(
                elevation: 7.5,
                child: InkWell(
                  onTap: () => print("${activite.nom} tapped"),
                  onLongPress: () => print("${activite.nom} pressed"),
                  child: Container(
                    child: Row(
                      mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                      children: <Widget>[
                        Icon(activite.icone, color: Colors.blue, size: 75.0,),
                        Column(
                          mainAxisAlignment: MainAxisAlignment.center,
                          children: <Widget>[
                            Text("Activit√©",
                              style: TextStyle(
                                  color: Colors.blue,
                                  fontSize: 20.0,
                                  fontWeight: FontWeight.bold
                              ),
                            ),
                            Text(activite.nom,
                                style : TextStyle(
                                  color: Colors.blue[800],
                                  fontSize: 30.0,
                                )),
                          ],
                        )
                      ],
                    ),
                  ),
                ),
              ),
            ),
            background: Container(
              color: Colors.red, // couleur quand on fait coulisser l'√©l√©ment
              padding: EdgeInsets.only(right: 20.0),
              child: Row(
                mainAxisAlignment: MainAxisAlignment.end,
                children: <Widget>[
                  Text("Supprimer", style: TextStyle(color: Colors.white)),
                  Icon(Icons.delete, color: Colors.white,)
                ],
              ),
            ),
            onDismissed: (direction) {
              setState(() {
                print(activite.nom);
                activites.removeAt(index);
              });
            },
          );
        }
    );
  }
}
```

### WIDGETS LAYOUT

#### STACK
* Permet de superposer des containers
* https://api.flutter.dev/flutter/widgets/Stack-class.html
* Peut-√™tre utilis√© avec le widget Positioned : https://api.flutter.dev/flutter/widgets/Positioned-class.html
```java
class StackDemo extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Stack(
      // ‚Üì aligne les widgets au centre du Stack
      alignment: Alignment.center,
      children: <Widget>[
        // The containers in the background
        Column(
          children: <Widget>[
            Container(
              height: MediaQuery.of(context).size.height * .65,
              color: Colors.blue,
            ),
            Container(
              height: MediaQuery.of(context).size.height * .35,
              color: Colors.white,
            )
          ],
        ),
        // The card widget with top padding, 
        // incase if you wanted bottom padding to work, 
        // set the `alignment` of container to Alignment.bottomCenter
        Container(
          alignment: Alignment.topCenter,
          padding: EdgeInsets.only(
              top: MediaQuery.of(context).size.height * .58,
              right: 20.0,
              left: 20.0),
          child: Container(
            height: 200.0,
            width: MediaQuery.of(context).size.width,
            child: Card(
              color: Colors.white,
              elevation: 4.0,
            ),
          ),
        )
      ],
    );
  }
}
```
```java
// CONTAINER DE BACKGROUND
Stack(
  children: <Widget>[
  // container d'arri√®re plan, d√©coratif
  // part du bas pour remplir l'√©cran
  // se place en premier
  Positioned(
    left: 0,
    right: 0,
    bottom: 0,
    child: Container(
      height: MediaQuery.of(context).size.height * 0.6,
      color: kConfigBackgroundColor,
    ),
  ),
   ListView(),
)
```
#### POSITIONED
* Permet de placer l'enfant dans le Stack
```java
// placer le widget 2 comme footer du Stack
Stack (
	Widget1(),
  // ‚Üì widget positionn√© dans le Stack
  Positioned(
    left: 0,
    right: 0,
    // permet la position en bas
    bottom: 0,
    child: Widget2(),
  ),
)
```
#### BOTTOMNAVIGATIONBAR
* Equivalent du footer
* Footer au bords arrondis : https://stackoverflow.com/questions/56577265/how-to-set-border-radius-to-bottom-app-bar-in-a-flutter-app
```java
class HomePage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Some Text'),
      ),
      body: Stack(
        children: <Widget>[
          bodyContent,
          // ‚Üì permet sa place en bas de l'√©cran
          Positioned(
            left: 0,
            right: 0,
            bottom: 0,
            child: bottomNavigationBar,
          ),
        ],
      ),
    );
  }

  Widget get bodyContent {
    return Container(color: Colors.red);
  }

  // alternative un Container() personnalis√©
  Widget get bottomNavigationBar {
    // ‚Üì permet les bords arrondis
    return ClipRRect(
      borderRadius: BorderRadius.only(
        topRight: Radius.circular(40),
        topLeft: Radius.circular(40),
      ),
      child: BottomNavigationBar(
        items: [
          BottomNavigationBarItem(icon: Icon(Icons.home), title: Text('1')),
          BottomNavigationBarItem(icon: Icon(Icons.usb), title: Text('2')),
          BottomNavigationBarItem(
              icon: Icon(Icons.assignment_ind), title: Text('3')),
          BottomNavigationBarItem(
              icon: Icon(Icons.multiline_chart), title: Text('4')),
        ],
        unselectedItemColor: Colors.grey,
        selectedItemColor: Colors.black,
        showUnselectedLabels: true,
      ),
    );
  }
}
```
#### VISIBILTY
* Display = none/block;
```java
Visibility(
  visible: storyBrain.buttonShouldBeVisible(), // true or false
  child: FlatButton(
    onPressed: () {
      //Choice 2 made by user.
      //TODO: Step 19 - Call the nextStory() method from storyBrain and pass the number 2 as the choice made by the user.
      setState(() {
        storyBrain.nextStory(2);
      });
    },
    color: Colors.blue,
    child: Text(
      //TODO: Step 14 - Use the storyBrain to get the text for choice 1.
      storyBrain.getChoice2(),
      style: TextStyle(
        fontSize: 20.0,
      ),
    ),
  ),
),
```
#### EXPANDED
* Permettre √† son enfant de prendre toute la place disponible
* https://api.flutter.dev/flutter/widgets/Expanded-class.html
* doit forc√©ment se trouver dans un Widget Row, Column ou Flex (pour pouvoir d√©terminer l'axe)
* peut importe le type des enfants
```java
Row(
	// prendra l'espace disponible de la Row
	Expanded(
		Container(...)
	),
	Column(...)
)
```
#### FLEXIBLE
* Permettre √† son enfant d'avoir de la place et de s'adapter s'il manque de place
* Sorte de max-width, max-height
```java
children: <Widget>[
  // ‚Üì si 200px n'est pas disponible, alors le widget s'adapte
  Flexible(
    child: Hero(
      tag: 'logo',
      child: Container(
        height: 200.0,
        child: Image.asset('images/logo.png'),
      ),
    ),
  ),
  // ...
```

### WIDGETS ANIMATION

#### HERO
* Hero Animations : https://flutter.dev/docs/development/ui/animations/hero-animations
```java
// Hero 1 (page d'accueil)
Hero(
  // tag permet l'association avec le 2√®me Hero
  tag: 'logo',
  child: Container(
    child: Image.asset('images/logo.png'),
    height: 60.0,
  ),
),

// le lien entre les 2
RoundedButton(
  title: 'Register',
  colour: Colors.blueAccent,
  onPressed: () {
    // pushNamed + id property
    Navigator.pushNamed(context, RegistrationScreen.id);
  },
)

// Hero 2 (page d'enregistrement) (l'image est grossie de fa√ßon fluide)
Flexible(
  child: Hero(
    tag: 'logo',
    child: Container(
      height: 200.0,
      child: Image.asset('images/logo.png'),
    ),
  ),
),                
```
### FORMES

#### CERCLE
* Cercle
```java
Container(
  width: 24.0,
  height: 24.0,
  decoration: BoxDecoration(
      color: Colors.grey,
      shape: BoxShape.circle)
),

// or
CircleAvatar(
  child: Icon(
    Icons.list,
    size: 30.0,
    color: Colors.lightBlueAccent,
  ),
  backgroundColor: Colors.white,
  radius: 30.0,
),
```
* CircleAvatar with border : https://github.com/flutter/flutter/issues/13566
```java
Container(
  width: diameter,
  height: diameter,
  decoration: BoxDecoration(
    // Circle shape
    shape: BoxShape.circle,
    color: backgroundColor,
    // The border you want
    border: Border.all(
      width: 2.0,
      color: Colors.white,
    ),
    // The shadow you want
    shadow: [
      BoxShadow(
        color: Colors.black.withOpacity(0.2),
        blurRadius: 5.0,
      ),
   ]
  ),
  child: contentInCircle,
);
```

## THEMES
* https://flutter.dev/docs/cookbook/design/themes
* https://api.flutter.dev/flutter/material/ThemeData-class.html
* https://stackoverflow.com/questions/22239803/how-does-hexadecimal-color-work
```java
// syst√®me d√©cimal (base 10)
// on multiple par 10^n le chiffre suivant en allant de droite √† gauche
// n commence √† 0
13 = 1 * 10 + 3; // 13 = 1 * 10^1 + 3 * 10^0
113 = 1 * 10 * 10 + 1 * 10 + 3; // 113 = 1* 10^2 + 1 * 10^1 + 3 * 10^0

// syst√®me hexad√©cimal (base 16)
// on multiple par 16^n le chiffre suivant en allant de droite √† gauche
// n commence √† 0
// 0 1 2 3 4 5 6 7 8 9 A(10) B(11) C(12) D(13) E(14) F(15)
4C = 4 * 16 + 12 = 76; // 4 * 16^1 + 12 * 16^0
FF = 15 * 16 + 15 = 255;
CC9 = (12 * 16 * 16) + (12 * 16) + 9;
```
```java
MaterialApp(
  title: title,
  theme: ThemeData(
    // ‚Üì Define the default brightness and colors.
    brightness: Brightness.dark,
    // ‚Üì couleur personnalis√©e = {#}0A0E21 => {0xFF}0A0E21
    primaryColor: Color(0xFF0A0E21),
    // ‚Üì FloatingButton
    accentColor: Colors.cyan[600],
    // ‚Üì body background
    scaffoldBackgroundColor: Color(0xFF0A0E21),
    // ‚Üì button color
    buttonColor: Colors.teal,
    // ‚Üì Define the default font family.
    fontFamily: 'Georgia',
    // ‚Üì appBar theme :
    appBarTheme: AppBarTheme(
      color: Colors.red,
      iconTheme: IconThemeData(color: Colors.white, size: 16.0),
    )

    // Define the default TextTheme. Use this to specify the default
    // text styling for headlines, titles, bodies of text, and more.
    textTheme: TextTheme(
      button: TextStyle(color: Colors.white),
      // ‚Üì default text style of body
      body1: TextStyle(color: Colors.white),
      headline1: TextStyle(fontSize: 72.0, fontWeight: FontWeight.bold),
      headline6: TextStyle(fontSize: 36.0, fontStyle: FontStyle.italic),
      bodyText2: TextStyle(fontSize: 14.0, fontFamily: 'Hind'),
    ),
  ),
  // h√©riter d'un theme dark et le modifier :
  theme: ThemeData.dark().copyWith(
    primaryColor: Color(0xFF0A0E21),
    scaffoldBackgroundColor: Color(0xFF0A0E21),
  ),
);


// changer le th√®me d'un widget
floatingActionButton: Theme(
  data: ThemeData.light(),
  data: ThemeData(accentColor: Colors.purple),
  child: FloatingActionButton( // 1) sera bleu clair 2) mauve
    child: Icon(Icons.add),
  )
)

// utiliser un param√®tre de Theme
Container(
  color: Theme.of(context).accentColor,
  child: Text(
    'Text with a background color',
    style: Theme.of(context).textTheme.headline6,
  ),
);
```
### CHEATSHEET TRANSPARENCY HEXADECIMAL
* https://gist.github.com/lopspower/03fb1cc0ac9f32ef38f4
```java
// Black
Color(0xFF000000)
// Black 20%
Color(0x33000000)
```
### COLOR SHADE AS CONSTANT
```java
const Color kTitleColor = Color(0xFF616161); // Colors.grey[700] (la valeur hexad√©cimale est donn√©e au survol)
```
### FLUTTER COLOR GENERATOR
* This simple tool can be used to generate main color and its shades for Flutter : https://tltemplates.com/tool/color/flutter-color

## INTERNATIONALISATION
* id√©e = cr√©er des dates en fran√ßais
* https://flutter.dev/docs/development/accessibility-and-localization/internationalization
1. pubspec.yaml
```yaml
dependencies:
  flutter:
    sdk: flutter

  cupertino_icons: ^0.1.3
  intl: ^0.16.1 # pour le formattage

  flutter_localizations: # pour l'internationalisation
    sdk: flutter
```
2. main.dart ou app.dart
```java
import 'package:flutter_localizations/flutter_localizations.dart';

class MyApp extends StatelessWidget {
  // This widget is the root of your application.
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      localizationsDelegates: [
        GlobalMaterialLocalizations.delegate,
        GlobalWidgetsLocalizations.delegate,
        GlobalCupertinoLocalizations.delegate,
      ],
      supportedLocales: [
        const Locale('en'),
        const Locale('fr'),
        const Locale('fr', 'BE'),
        const Locale('fr', 'CA'),
      ],
      locale: const Locale('fr'),
```
3. fichier qui utilise la locale
```java
DateTime today = DateTime.now();
final df = DateFormat('EEEE d MMMM', 'fr');
String newDate = df.format(today);
```

## PACKAGES

### FONCTIONNEMENT
* https://flutter.dev/docs/development/packages-and-plugins/using-packages
* Deep Dive Into The Pubspec.yaml File : https://medium.com/flutter-community/deep-dive-into-the-pubspec-yaml-file-fb56ac8683b9
* Cheatsheet :
```yaml
dependencies:
  url_launcher: ^5.4.0    # Good, any 5.4.x version where x >= 0 works.
  image_picker: '5.4.3'   # Not so good, only version 5.4.3 works.
  url_launcher: '>=5.4.0 <6.0.0' # range versions
  plugin: # derni√®re version stable
```
* Imports
```java
import 'package:intl/intl.dart'; // ALL
import 'package:http/http.dart' as http; // ALIAS for the package => http.get(apiUrl)
import 'dart:io' show Platform; // ONLY
import 'dart:io' hide Platform; // ALL, EXCEPT
```
* Formater une date avec intl
```java
import 'package:intl/intl.dart';
import 'package:intl/date_symbol_data_local.dart';

final df = DateFormat('EEEE d MMMM', 'fr');
String formattedDate = df.format(dateToFormat);
```
### SHARED PREFERENCES
* ajout des shared preferences dans toute l'application : https://dev.to/simonpham/using-sharedpreferences-in-flutter-effortlessly-3e29
* https://medium.com/flutterdevs/using-sharedpreferences-in-flutter-251755f07127
```java
// utils/shared_prefs.dart ou services/shared_prefs.dart
import 'package:shared_preferences/shared_preferences.dart';
import 'package:mon_app/constants.dart';

class SharedPrefs {
  static SharedPreferences _sharedPrefs;

  init() async {
    if (_sharedPrefs == null) {
      _sharedPrefs = await SharedPreferences.getInstance();
    }
  }

  String get username => _sharedPrefs.getString(keyUsername) ?? "";

  set username(String value) {
    _sharedPrefs.setString(keyUsername, value);
  }

  bool get isUserConnected => _sharedPrefs.getBool(kUserConnection) ?? false;

  isConnected() {
    _sharedPrefs.setBool(kUserConnection, true);
  }
}

final sharedPrefs = SharedPrefs(); // cr√©√© une seule instance de classe (singleton)

// constants.dart
// mots-cl√©s utilis√©s dans les SharedPreferences
const String keyUsername = "key_username";
const String kUserConnection = "user_connected";

// main.dart
Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();
  // initialise, via une instance de notre classe, les SharedPreferences avant de lancer l'application
  await sharedPrefs.init();
  runApp(
    MyApp(),
  );
}

// classe 1
import 'package:mon_projet/services/shared_prefs.dart';

class MyApp extends StatelessWidget {

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: Scaffold(
        body: Text("Hi ${sharedPrefs.username}"),
      ),
    );
  }
}

// classe 2
import 'package:mon_projet/services/shared_prefs.dart';

class MyApp extends StatefulWidget {

@override
  void initState() {
    super.initState();
    // appel du dialog selon les SharedPreferences
    // si l'utilisateur se connecte pour la premi√®re fois
    WidgetsBinding.instance.addPostFrameCallback((_) {
      if (!sharedPrefs.isUserConnected) callWelcomeMessage();
    });
  }
}

// interaction
build {
	onPressed: () {
    sharedPrefs.isConnected();
  },
}
```

### WEBVIEW
* Fonctionnalit√© : afficher une page web directement dans l'appli
* https://pub.dev/packages/webview_flutter
* https://medium.com/flutter/the-power-of-webviews-in-flutter-a56234b57df2
```java
import 'package:webview_flutter/webview_flutter.dart';

  @override
  void initState() {
    super.initState();
    if (Platform.isAndroid) WebView.platform = SurfaceAndroidWebView();
  }

  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(),
      ),
      body: WebView(
        initialUrl: "https://stackoverflow.com/",
        javascriptMode: JavascriptMode.unrestricted,
      ),
    );
  }
```

### AFFICHER UN PDF VIA UNE URL AVEC PDFVIEW
* https://stackoverflow.com/questions/62476108/how-to-load-and-present-a-pdf-file-from-the-web-in-flutter
* https://www.reddit.com/r/FlutterDev/comments/bu14p4/flutter_pdf_viewer_tutorial_android_ios_from_url/
* Probl√®me de page blanche avec IOS
* pubspec.yaml
```yaml
dependencies:
  flutter:
    sdk: flutter

  # The following adds the Cupertino Icons font to your application.
  # Use with the CupertinoIcons class for iOS style icons.
  flutter_pdfview: ^1.0.3+5
  path_provider: any
```
* fichier receveur
```java
import 'dart:io';

import 'package:flutter/material.dart';
import 'package:flutter_pdfview/flutter_pdfview.dart';
import 'package:http/http.dart' as http;
import 'package:path_provider/path_provider.dart';

import 'package:mon_projet/models/book.dart';
import '../constants.dart';

class BookPDF extends StatefulWidget {
  @override
  _BookPDFState createState() => _BookPDFState();
}

class _BookPDFState extends State<BookPDF> {
  Book book;
  String urlPDFPath;
  int _totalPages = 0;
  int _currentPage = 0;
  bool pdfReady = false;
  bool loaded = false;
  bool exists = false;

  @override
  void didChangeDependencies() {
    super.didChangeDependencies();
    book = ModalRoute.of(context).settings.arguments;
    getFileFromUrl(book.url).then((file) => {
      setState(() {
        if (file != null) {
          urlPDFPath = file.path;
          loaded = true;
          exists = true;
        } else {
          exists = false;
        }
      })
    });
  }

  Future<File> getFileFromUrl(String url) async {
    try {
      var data = await http.get(url);
      var bytes = data.bodyBytes;
      var dir = await getApplicationDocumentsDirectory();
      File file = File("${dir.path}/mypdfonline.pdf");
      File urlFile = await file.writeAsBytes(bytes);
      return urlFile;
    } catch (e) {
      throw Exception("Erreur lors de l'ouverture du fichier");
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title:
        Text(book.title, style: TextStyle(color: Colors.white)),
      ),
      body: loaded ? PDFView(
        filePath: urlPDFPath,
        enableSwipe: true,
        swipeHorizontal: true,
        autoSpacing: false,
        pageFling: false,
        onError: (error) {
          print(error.toString());
        },
        onRender: (_pages) {
          setState(() {
            _totalPages = _pages;
            pdfReady = true;
          });
        },
      ) : Center(
        child: CircularProgressIndicator(
          backgroundColor: kPrimaryColor,
        ),
      ),
    );
  }
}
```
### OUVRIR UN PDF VIA UNE URL AVEC ADVANCE_PDF_VIEWER
* https://pub.dev/packages/advance_pdf_viewer
* Aucune permission Android/IOS, car l'appli utilise le dossier du cache pour charger le pdf
* Tr√®s simple d'utilisation
* Marche avec IOS
* Ajoute des indicateurs pour le d√©filement des pages
```java
import 'package:flutter/material.dart';

import 'package:advance_pdf_viewer/advance_pdf_viewer.dart'; // ++

import 'package:mon_projet/models/book.dart';
import '../constants.dart';

class BookPDF extends StatefulWidget {
  @override
  _BookPDFState createState() => _BookPDFState();
}

class _BookPDFState extends State<BookPDF> {
  Book book;
  PDFDocument document;
  bool isDocumentLoaded = false;
  bool errorOnLoading = false;
  String errorMessage = "";

  @override
  void didChangeDependencies() {
    super.didChangeDependencies();
    book = ModalRoute.of(context).settings.arguments;
    loadPDFDocument(url: book.url);
  }

  loadPDFDocument({String url}) async {
    try {
      document = await PDFDocument.fromURL(url);
    } on Exception catch (e) {
      setState(() {
        errorOnLoading = true;
        errorMessage = e.toString();
      });
    } finally {
      setState(() {
        isDocumentLoaded = true;
      });
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
        appBar: AppBar(
          title: Text(book.description,
              style: TextStyle(color: Colors.white)),
        ),
        body: displayBody());
  }

  Widget displayBody() {
    if (isDocumentLoaded) {
      if (errorOnLoading) {
        return Center(
            child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Text("Erreur lors du chargement du pdf"),
            Text(
              errorMessage,
              style: TextStyle(color: Colors.red),
            )
          ],
        ));
      }
      return PDFViewer(
        document: document,
        showPicker: false,
      );
    }
    return Center(
      child: CircularProgressIndicator(
        backgroundColor: kPrimaryColor,
      ),
    );
  }
}
```
### SPLASHSCREEN
* https://stackoverflow.com/a/59709679
* https://pub.dev/packages/splashscreen
```java
// main.dart
MaterialApp(
      home: SplashScreen(),
      routes: {},
);

// splashscreen.dart
import 'package:flutter/material.dart';

import 'package:splashscreen/splashscreen.dart';

class SplashScreen extends StatefulWidget {
  @override
  _SplashScreenState createState() => _SplashScreenState();
}

class _SplashScreenState extends State<SplashScreen> {
  @override
  Widget build(BuildContext context) {
    return SplashScreen(
      seconds: 3,
      navigateAfterSeconds: HomeScreen(),
      image: Image.asset(
        "assets/images/image.png",
      ),
      photoSize: 60.0,
      backgroundColor: kPrimaryColor,
      loaderColor: Colors.white,
      loadingText: Text(
        "Chargement...",
        style: TextStyle(color: Colors.white, fontSize: 24.0),
      ),
    );
  }
}
```
### BADGES
* Ajouter un badge de notification √† un Widget
* https://pub.dev/packages/badges
```java
// Basic usage
Badge(
  badgeContent: Text('3'),
  child: Icon(Icons.settings),
)

// Badge + FutureBuilder
User user;
Future<int> counter; // nombre de notifications

@override
void initState() {
  super.initState();
  getUserCounter();
}

void getUserCounter() async {
  user = sharedPrefs.getUserProfile();
  counter = ApiNotification.fetchNumberOfNotifications(user: user);
}

FutureBuilder<int>(
  future: counter,
  builder: (context, snapshot) {
    // si le user a des notifications
    if (snapshot.hasData) {
      return Badge(
        badgeContent: Text(
          snapshot.data.toString(),
          style: TextStyle(color: Colors.white),
        ),
        showBadge: (snapshot.data != 0), // affiche le badge seulement s'il y a au moins 1 notification
        child: Icon(
          FontAwesomeIcons.solidBell,
          color: Colors.green,
        ),
      );
    // si la requ√™te retourne une erreur
    } else if (snapshot.hasError) {
      print("${snapshot.error}");
    }
    // par d√©faut, on affiche l'ic√¥ne sans les notifications
    return Icon(
      FontAwesomeIcons.solidBell,
      color: Colors.green,
    );
  }
),
```

## API

* Fetching Data from the Internet : https://flutter.dev/docs/cookbook/networking/fetch-data
* HTTP Status Codes : https://www.restapitutorial.com/httpstatuscodes.html

### Simulate an asynchronous web service
* https://stackoverflow.com/questions/18449846/how-can-i-sleep-a-dart-program
```java
import 'dart:io';

sleep(const Duration(seconds:1)); // sync code

// async code
Future sleep1() {
  return Future.delayed(Duration(seconds: 1), () => "Retour 1");
}

Future sleep2() {
  return Future.delayed(Duration(seconds: 2), () => "Retour 2");
}
```
* exemple, avec l'appel d'un menu
```java
class _MenuScreenState extends State<MenuScreen> {
Future<Menu> futureSelectedMenu;

  @override
  void initState() {
    futureSelectedMenu = fetchMenu(); // appel simul√©
  }

  // simule un appel API
  Future<Menu> fetchMenu() async {
    return Future.delayed(Duration(seconds: 3), () {
      return Menu(title: "Mon Menu");
    });
  }

  @override
  Widget build(BuildContext context) {
		FutureBuilder<Menu>(
      future: futureSelectedMenu,
        builder: (context, snapshot) {
          if (snapshot.hasData) {
            return Text('${snapshot.data.title}'); // Mon Menu
            // ne pas oublier le return !
          } else if (snapshot.hasError) {
            return Text("${snapshot.error}");
          }
          // By default, show a loading spinner.
          return Center(
            child: CircularProgressIndicator(
              backgroundColor: kPrimaryColor,
            ),
          );
        }
    ),
  }
}
```

### APPEL API LOCALHOST DEPUIS FLUTTER
```
http.get("http://10.0.2.2:3001/menu"); // http.get("http://10.0.2.2:port/url");
```

### Appel API avec les widgets interactifs
* id√©e = modifier la propri√©t√© responsable de l'affichage dans un setState()
```java
// datetime picker
if (choice != null) {
  setState(() {
    selectedDate = choice;
    futureSelectedMenu = fetchMenu(); // appel API
  });
}

// dropdown button
onChanged: (value) {
  setState(() {
    selectedProfile = value;
    futureSelectedMenu = fetchMenu(); // appel API
  });
});
```

### Deserialize a list of objects from json
* https://stackoverflow.com/a/58132148
```java
class ApiArticle {

  Future<List<Article>> fetchArticles() async {
    // appel API
    final response = await http.get(urlApi);
    // si appel concluant
    if (response.statusCode == 200) {
      var responseBody = response.body;
      var listMapArticle = json.decode(responseBody) as List; // [{"auteur": "untel", "titre": "truc"}, {"auteur": "machin", "titre": "trucmuche"}]
      List<Article> listObjectArticle = listMapArticle.map((e) => Article.fromJson(e)).toList(); // toList because Dart's map returns a kind of Iterable
      return listObjectArticle; // [instance of Article, instance of Article, ect.]
    } else {
      throw Exception('Erreur lors du chargement des articles');
    }
  }
}
```

### Transformer du JSON en List<String> et List<Object>
* https://medium.com/flutter-community/parsing-complex-json-in-flutter-747c46655f51
```java
// models/journal.dart
class Journal {
  String title;
  List<String> authors;
  List<Article> articles;

  Journal({this.title, this.authors, this.articles});

  factory Journal.fromJson(Map<String, dynamic> json) {
    var authorsFromJson = json['authors'];
    List<String> authorsList = authorsFromJson.cast<String>(); // convertit en une liste de String

    var articlesFromJson = json['articles'] as List;
    List<Article> articlesList = articlesFromJson.map((article) => Article.fromJson(article)).toList();

    return Journal(
      title: json['title'],
      type: authorsList,
      articles: articlesList,
    );
  }
}

// models/article.dart
class Article {
  String title;
  String author;
  String content;

  Dish({this.title, this.author, this.content});

  factory Article.fromJson(Map<String, dynamic> json) {
    return Article(
      title: json['title'],
      type: json['author'],
      articles: json['content'],
    );
  }
}

// api-journal
import 'dart:convert';
import 'package:http/http.dart' as http;

import 'package:mon_projet/models/journal.dart';

class ApiJournal {

  static Future<Journal> fetchJournal({params}) async {
    final response = await http.get("urlAPI");
    if (response.statusCode == 200) {
      return Journal.fromJson(json.decode(response.body));
    } else {
      return Future.error('Erreur lors du chargement du journal');
    }
  }
}
```

### LIST IN FUTURE BUILDER
```java
class _ArticlesState extends State<Articles> {

  Future<List<Article>> articles;

  @override
  void didChangeDependencies() {
    super.didChangeDependencies();
    articles = ApiJournal.fetchArticles();
  }

    FutureBuilder<List<Article>>(
      future: articles,
      builder: (context, snapshot) {
        if (snapshot.hasData) {
          return ListView.builder(
            shrinkWrap: true,
              itemCount: snapshot.data.length,
              itemBuilder: (context, index) {
                return rowArticle(article: snapshot.data[index]);
              },
          );
        } else if (snapshot.hasError) {
          return Text("${snapshot.error}");
        }
        // By default, show a loading spinner.
        return CircularProgressIndicator();
      },
    ),
}
```

### FORM ET FUTURE BUILDER
* peupler un formulaire avec des donn√©es r√©cup√©r√©es en API
* https://stackoverflow.com/questions/59353637/flutter-populate-form-with-async-data
* https://flutter.dev/docs/cookbook/networking/update-data
```java
FutureBuilder<Article>(
  future: futureArticle,
  builder: (context, snapshot) {
    if (snapshot.hasData) {
      return Form( 
              Widget(
                author: snapshot.data.author, 
                date: snapshot.data.date, 
                ect.
              )
            );
    }
  }
),
```

# FORM FUTURE BUILDER avec condition
* https://stackoverflow.com/questions/56122522/how-to-render-data-from-request-inside-a-futurebuilder
```java
bool isCool; // propri√©t√© de classe

FutureBuilder<Article>(
  future: futureArticle,
  builder: (context, snapshot) {
    if (snapshot.hasData) {

      // si c'est le premier appel API (isCool = null) et que la condition est r√©unie
      if (isCool == null && snapshot.data.mood == 'COOL')
        {
          isCool = true;
        }

      return Form( 
        key: key,
        child: Column(
          children: <Widget>[
            WidgetSimple(
              onChanged: (value) {
                setState(() {
                  if (value == 'COOL') {
                    isCool = true;
                  } else {
                    isCool = false;
                  }
                });
              }
            ),
            // si isCool = true alors on affiche WidgetCool
            // condition remplie soit lors du premier appel API
            // soit par le setState() de WidgetSimple()
            // if possible car dans un array <Widget>[]
            if (isCool) 
            WidgetCool()
          ] // <Widget>[]
        ) // Column
      ) // Form
    }
  }
) // FutureBuilder<Article>
```

### FUTURE DROPDOWN
* https://stackoverflow.com/questions/55571328/how-to-implement-a-drop-down-list-in-flutter
```java
//This is the state of your class
/// Is a good practice initialize the selection value.
/// I'am doing this after dataFetch is completed.
String _selectedLocation;

/// we make the future object part of the state to avoid data fetching
/// from web every time that build method is called¬∑
Future<List<ProductCategory>> _future;
/// and now we store the category list as cache in widget state
List<String> _categoryList;

initState(){
  // in initState we trigger the network call for load the dropdown menu options.
  // this is part of trying to avoid recall data fetching from network every time
  // that we need rebuild the widget.
  _future = DataFetch().fetchCategoryList(
      AppNavigation.getAPIUrl() + "productCategory/getAllProductCategories",
      ProductCategory);
}

Widget _dropDownMenu() {
  // if we haven't load the options from network yet... we await the future
  // completes to create dropdown menu.
  if (_categoryList == null) {
    return FutureBuilder<List<ProductCategory>>(
        future: _future,
        builder: (context, snapshot) {
          if (snapshot.hasError)
            print(snapshot.error);

          else if (snapshot.hasData) {
            for (int i = 0; i < snapshot.data.length; i++)
              _categoryList.add(snapshot.data[i].categoryName);

            // I put this line just to grant that the initial option of
            //dropdown menu has some valid value. You can erase if not needed.
            _selectedLocation = snapshot.data[0].categoryName);
            return _createDropDownMenu();
          }
          // ‚Üì ce qu'affiche l'appli le temps du chargement (obligatoire)
          else return CircularProgressIndicator();
        },);
  }
  // other way if we already load the options data we just create the dropdown menu
  // we just populate the dropdown menu options with _categoryList values.
  return _createDropDownMenu();
}

Widget _createDropDownMenu(){
  return DropdownButton<String>(
    hint: Text('Please choose'), // Not necessary for Option 1
    value: _selectedLocation,
    onChanged: (newValue) {
      setState(() {
        _selectedLocation = newValue;
      });
    },
    items: _categoryList.map((data) {
      return DropdownMenuItem<String>(
          child: Text(data),
          value: data,
      );
    }).toList(),
  );
}
```
### AFFICHER UNE DONNEE API VIA UNE ROUTE
```java
import 'package:http/http.dart' as http;
import 'package:mon_appli/src/data/article.dart';

class ApiArticle {

  Future<Article> fetchAuthor({int authorId}) async {
    final response = await http.get(apiUrl);

    if (response.statusCode == 200) {
      return Author.fromJson(json.decode(response.body));
    } else {
      throw Exception("Erreur lors du chargement de l'auteur");
    }
  }

}
```
```java
// r√©cup√©ration de l'objet envoy√© via Navigator.push
final Article article = ModalRoute.of(context).settings.arguments;
// appel API gr√¢ce √† l'objet r√©cup√©r√©
futureAuthor = ApiArticle().fetchAuthor(id: article.authorId)

FutureBuilder<Author>(
  future: futureAuthor,
  builder: (context, snapshot) {
    if (snapshot.hasData) {
      return Text('Auteur : ${snapshot.data.prenom} ${snapshot.data.nom}');
    } else if (snapshot.hasError) {
      return Text("${snapshot.error}");
    } // message by default
    return Text('Auteur introuvable');
  },
)
```
### FUTURE DROPDOWN MAP
```java
import 'package:http/http.dart' as http;
import 'package:my_app/src/data/author.dart';

class ApiAuthor {

  Future<List<Author>> fetchAuthorsByGenre({String genre}) async {

    final response = await http.get(urlApiAuthorsByGenre);

    if (response.statusCode == 200) {
      return compute(parseAuthor, response.body);
    } else {
      throw Exception('Erreur lors du chargement des auteurs');
    }
  }

  List<Author> parseAuthor(String responseBody) {
    final parsed = jsonDecode(responseBody).cast<Map<String, dynamic>>();
    return parsed.map<Author>((json) => Author.fromJson(json)).toList();
  }

}
```
```java
  String _selectedAuthorName;
  String _selectedAuthorId;
  Future<List<Author>> _futureListAuthors;
  Map<String, String> _authorList;

  @override
  void initState() {
    // appel √† l'API de l'ensemble des auteurs de SCIFI
    _futureListAuthors = ApiAuthor().fetchAuthorsByGenre(genre: 'SF');
    super.initState();
  }

// ‚Üì cr√©ation d'une map (id, name) d'auteurs
Widget authorDropDownMenu() {
  if (_authorList == null) {
    _authorList = HashMap<String, String>();
    return FutureBuilder<List<Author>>(
      future: _futureListAuthors,
      builder: (context, snapshot) {
        if (snapshot.hasError) {
          print(snapshot.error);
        } else if (snapshot.hasData) {
          for (int i = 0; i < snapshot.data.length; i++) {
            if (snapshot.data[i].name != null) {
              _authorList.putIfAbsent(snapshot.data[i].id.toString(),
                  () => snapshot.data[i].name);
            }
          }
          return authorDropDownButton();
          // ‚Üì on affiche du texte vide le temps du chargement des donn√©es
        } else
          return DropdownMenuItem(child: Text('Chargement des auteurs...'));
      },
    );
  } // si les donn√©es sont d√©j√† charg√©es, on les affiche
  return authorDropDownButton();
}

// ‚Üì cr√©ation des items du DropDownButton
// le choix de l'auteur s'accompagne du choix de son id
Widget authorDropDownButton() {
  return DropdownButtonFormField(
    decoration: InputDecoration.collapsed(),
    hint: Text('Choisissez votre auteur'),
    value: _selectedAuthorName,
    items: _authorList
        .map((id, name) {
          return MapEntry(
              id,
              DropdownMenuItem<String>(
                child: Text(name),
                value: name,
              ));
        })
        .values
        .toList(),
    onChanged: (value) {
      setState(() {
        _selectedAuthorName = value;
        _selectedAuthorId = _authorList.keys.firstWhere(
            (k) => _authorList[k] == _selectedAuthorName,
            orElse: () => null);
      });
    },
    validator: (value) =>
        value == null ? 'Veuillez renseigner un auteur' : null,
  );
}

// AVEC INITIAL VALUE
// author.dart
class Author {
  String code;
  String nom;

  Author({this.code, this.nom});

  factory Author.fromJson(Map<String, dynamic> json) {
    return Author(
      code: json['code'],
      nom: json['nom']
    );
  }
}

// api-author.dart
import 'dart:convert';

import 'package:http/http.dart' as http;

import 'package:mon_projet/models/author.dart';

class ApiAuthor {
  static Future<List<Author>> fetchAuthors() async {
    final response = await http.get("http://10.0.2.2:3001/authors");
    if (response.statusCode == 200) {
      var listMapAuthors = json.decode(response.body) as List;
      List<Author> listObjectAuthors = listMapAuthors
          .map((authors) => Author.fromJson(authors))
          .toList();
      return listObjectAuthors;
    } else {
      return Future.error('Erreur lors du chargement des auteurs');
    }
  }
}


// author_screen.dart
class _AuthorsScreenState extends State<AuthorsScreen> {
  String selectedCodeAuthor = "p_dick";
  String selectedAuthor;
  Future<List<Author>> listAuthors;
  Map<String, String> mapAuthors;

@override
  Widget build(BuildContext context) {
	return Scaffold(
		body: Container(
          		child: DropdownButtonHideUnderline(
            			child: dropDownAuthorsMenu(),
          		),
        	)
	);
}

Widget dropDownAuthorsMenu() {
    if (mapAuthors == null) {
      mapAuthors = Map<String, String>(); // initialise la map
      return FutureBuilder<List<Author>>(
        future: listAuthors,
        builder: (context, snapshot) {
          if (snapshot.hasError) {
            return DropdownMenuItem(
                child: Text(
              'Erreur lors du chargement des donn√©es : ${snapshot.error}',
              overflow: TextOverflow.ellipsis,
            ));
          } else if (snapshot.hasData) {
            for (int i = 0; i < snapshot.data.length; i++) {
              if (snapshot.data[i].nom != null) {
                mapAuthors.putIfAbsent(
                    snapshot.data[i].code, () => snapshot.data[i].nom);
              }
            }
            // ‚Üì le profil affich√© dans le menu d√©roulant
            selectedAuthor = mapAuthors[selectedCodeAuthor];
            return dropDownAuthorsButton();
            // ‚Üì on affiche du texte vide le temps du chargement des donn√©es
          } else
            return DropdownMenuItem(child: Text('Chargement des auteurs...'));
        },
      );
    } // si les donn√©es sont d√©j√† charg√©es, on les affiche
    return dropDownAuthorsButton();
  }

  Widget dropDownAuthorsButton() {
    return DropdownButton(
        value: selectedType,
        isExpanded: true,
        style: TextStyle(fontSize: 14.0),
        items: mapAuthors
            .map((String code, String nom) {
              return MapEntry(
                  code,
                  DropdownMenuItem<String>(
                    value: nom,
                    child: Text(
                      nom,
                      overflow: TextOverflow.ellipsis,
                      style: TextStyle(color: kTitleColor),
                    ),
                  ));
            })
            .values
            .toList(),
        onChanged: (value) {
          setState(() {
            selectedAuthor = value;
            selectedCodeAuthor = mapAuthors.keys.firstWhere(
                (key) => mapAuthors[key] == value,
                orElse: () => null);
          });
        });
  }
```
### REQUETE PUT AVEC BODY
```java
import 'package:http/http.dart' as http;

class Api {

  //static pour √©viter de cr√©er un nouvel objet Api()
  static Future updateArticle({int articleId, String articleTitle, int articleLines}) async {

    Map<String, String> headers = {"Content-type": "application/json; charset=UTF-8"};

  // comme convenu dans les headers, on envoie du json, d'o√π le jsonEncode
    var body = jsonEncode({
      "articleTitle": articleTitle,
	    "articleLines": articleLines,
    });

    http.Response response = await http.put(url/articleId, headers: headers, body: body);

    if (response.statusCode == 200) {
      return response.body;
    } else {
      return Future.error("Erreur lors de l'appel API : ${response.body}", StackTrace.fromString(response.body));
    }
  }
}
```
### STREAM BUILDER

* Stream = liste d'√©l√©ments promis, qui arriveront les uns apr√®s les autres, dans un temps ind√©fini
* En souscrivant √† une Stream, on re√ßoit les √©l√©ments au fil de l'eau, et la liste aggrandie se met √† jour r√©guli√®rement et automatiquement
* StreamBuilder Class Documentation : https://docs.flutter.io/flutter/widgets/StreamBuilder-class.html
* The async snapshot represents the most recent interaction with the Stream
* AsyncSnapshot Class Documentation : https://docs.flutter.io/flutter/widgets/AsyncSnapshot-class.html

## FIREBASE
* Installation : cours Bootcamp Flutter de Angela Yu
### TROUBLESHOOTING
* File > Project Structure > Project SDK > Android API [version propos√©e] // ex Android API 30

### FIREBASE MESSAGING
* https://pub.dev/packages/firebase_messaging
#### DOC
---
* Push notifications with Firebase messaging - Flutter : https://www.youtube.com/watch?v=wjJN1C9UxpY
* Push notifications with Firebase messaging II - Flutter : https://www.youtube.com/watch?v=4_2LlswlS2Q
---
* https://www.youtube.com/watch?v=PrnxksGQ210
* https://firebase.flutter.dev/docs/messaging/overview/
* https://www.raywenderlich.com/9227276-firebase-cloud-messaging-for-android-sending-push-notifications
* https://www.djamware.com/post/5e4b26e26cdeb308204b427f/flutter-tutorial-firebase-cloud-messaging-fcm-push-notification
* https://brandonlehr.com/flutter/Firebase/Push-Notifications/Android/iOS/2019/10/23/flutter-firebase-messaging
* https://fireship.io/lessons/flutter-push-notifications-fcm-guide/
#### TROUBLESHOOTING
* https://github.com/FirebaseExtended/flutterfire/issues/1904#issuecomment-604301777
```java
// Application.java
import io.flutter.plugins.firebasemessaging.FirebaseMessagingPlugin; // ++

// Instead of this method in application.java
    @Override
    public void registerWith(PluginRegistry registry) {
        GeneratedPluginRegistrant.registerWith(registry);
    }

// Put this method :
    @Override
    public void registerWith(PluginRegistry registry) {
        FirebaseMessagingPlugin.registerWith(registry.registrarFor("io.flutter.plugins.firebasemessaging.FirebaseMessagingPlugin"));
    }
```
#### EXEMPLES
* exemple 1
```java
// pubspec.yaml
firebase_messaging: <version>

// services/
import 'package:firebase_messaging/firebase_messaging.dart';

class PushNotificationsManager {

  PushNotificationsManager._();

  factory PushNotificationsManager() => _instance;

  static final PushNotificationsManager _instance = PushNotificationsManager._();

  final FirebaseMessaging _firebaseMessaging = FirebaseMessaging();
  bool _initialized = false;

  Future<void> init() async {
    if (!_initialized) {
      // For iOS request permission first.
      _firebaseMessaging.requestNotificationPermissions();
      // Notifications configurations
      _firebaseMessaging.configure(
        // l'utilisateur est sur l'application
        // il ne re√ßoit pas de notification
        // ‚Üì la propri√©t√© onMessage est appel√©e
        onMessage: (Map<String, dynamic> message) async {
          print("onMessage: $message");
          // {notification: {title: test3, body: test3}, data: {click_action: FLUTTER_NOTIFICATION_CLICK}}
          //TODO: sauvegarder le message
        },
        // l'application est inactive
        // ‚Üì lance l'application suite √† un clic sur la notification
        onLaunch: (Map<String, dynamic> message) async {
          print("onLaunch: $message");
          //TODO: redirection vers la page des messages
          // {notification: {}}
        },
        // l'application est active, mais en arri√®re-plan
        // ‚Üì affiche l'application suite √† un clic sur la notification
        onResume: (Map<String, dynamic> message) async {
          print("onResume: $message");
          //TODO: redirection vers la page des messages
          // {notification: {}
        },
      );

      // For testing purposes print the Firebase Messaging token
      String token = await _firebaseMessaging.getToken();
      print("FirebaseMessaging token: $token");

      _initialized = true;
    }
  }
}
```
* exemple2, avec SplashScreen
```java
// main.dart
MaterialApp(
      home: SplashScreen(),
      routes: {},
);

// splashscreen.dart
import 'package:flutter/material.dart';

import 'package:splashscreen/splashscreen.dart';
import 'package:firebase_messaging/firebase_messaging.dart';

/// Point d'entr√©e, routeur de l'application
/// Initialise la configuration Firebase
/// Affiche le SplashScreen puis redirige l'utilisateur vers :
///	- home_screen : si l'utilisateur se connecte sans appuyer sur une notification
///	- message_screen : si l'utilisateur se connecte en appuyant sur une notification
class MyApp extends StatefulWidget {
  @override
  _MyAppState createState() => _MyAppState();
}

class _MyAppState extends State<MyApp> {
  final FirebaseMessaging _firebaseMessaging = FirebaseMessaging();
  bool notification = false;

  @override
  void initState() {
    super.initState();
    firebaseConfiguration();
  }

  @override
  Widget build(BuildContext context) {
    return SplashScreen(
      seconds: 3,
      navigateAfterSeconds: notification ? MessageScreen() : HomeScreen(),
      image: Image.asset(
        "assets/images/image.png",
      ),
      photoSize: 60.0,
      backgroundColor: kPrimaryColor,
      loaderColor: Colors.white,
      loadingText: Text(
        "Chargement...",
        style: TextStyle(color: Colors.white, fontSize: 24.0),
      ),
    );
  }

  void firebaseConfiguration() {
    // For iOS request permission first.
    _firebaseMessaging.requestNotificationPermissions();
    _firebaseMessaging.onIosSettingsRegistered.listen((IosNotificationSettings settings) {
      print("iOS Settings registered: $settings");
    });
    // Notifications configurations
    _firebaseMessaging.configure(
      // l'application est inactive
      // ‚Üì lance l'application suite √† un clic sur la notification
      onLaunch: (Map<String, dynamic> message) async {
        notification = true;
        print("onLaunch: $message");
        // {notification: {}}
      },
      // l'application est active, mais en arri√®re-plan
      // ‚Üì affiche l'application suite √† un clic sur la notification
      onResume: (Map<String, dynamic> message) async {
        notification = true;
        print("onResume: $message");
        // {notification: {}
      },
    );
    // Fires when a new FCM token is generated
    _firebaseMessaging.onTokenRefresh.listen((String token) async {
      debugPrint("Mon token : $token");
      handleToken(token);
    });
  }

  /// R√©cup√©ration du Token Firebase + stockage dans User du LS (ou cr√©ation user Temporaire)
  void handleToken(String token) {
    User user = sharedPrefs.getUserProfile();
    if (user.firebaseId != null) {
      // token stock√© dans le profil utilisateur
      if (user.firebaseId != token) {
        // token diff√©rent, on doit mettre √† jour le compte stock√©
        user.firebaseId = token;
        sharedPrefs.setUserProfile(user);
      } else {
        debugPrint("token = user.firebaseId, rien √† changer !");
      }
    } else {
      // pas de token stock√© dans le profil de l'utilisateur
      // cr√©ation d'un profil utilisateur
      user.firebaseId = token;
      sharedPrefs.setUserProfile(user);
    }
  }
}
```

## PERSONNALISATION

### ICONE DE L'APPLI
* Aller sur appicon.co, s√©lectionner Iphone et Android
* https://www.udemy.com/course/flutter-bootcamp-with-dart/learn/lecture/14482060#bookmarks


## CODAMUSIC
* Objectif = cr√©er une application de musique qui affiche les chansons √† l'√©coute
* Trouver le player de musique => "audioplayer Flutter sur Google" => https://pub.dev/packages/audioplayer => onglet Installing
* pubspec.yaml
```yaml
name: coda_music
description: A new Flutter application.

dependencies:
  flutter:
    sdk: flutter
  audioplayer: ^0.8.1 # ajout de notre plugin audioplayer
  # pub get pour l'int√©grer au projet
  cupertino_icons: ^0.1.2

dev_dependencies:
  flutter_test:
    sdk: flutter

flutter:
  uses-material-design: true
  assets:
    - assets/ # pub get pour sauvegarder
  #  - assets/deux.jpg
  #  - assets/un.jpg
```
* main.dart
```java
import 'dart:async'; // permet de faire de l'asynchrone

import 'package:flutter/material.dart';
import 'musique.dart'; // classe Musique cr√©√©e dans notre lib/
import 'package:audioplayer/audioplayer.dart';

void main() => runApp(new MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      debugShowCheckedModeBanner: false,
      title: 'Coda Music',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: MyHomePage(title: 'Coda Music'),
    );
  }
}

class MyHomePage extends StatefulWidget {
  MyHomePage({Key key, this.title}) : super(key: key);

  final String title;

  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {
  List<Musique> maListeDeMusiques = [
    // cr√©ation de mes musiques
    Musique('Theme Swift', 'Codabee', 'assets/un.jpg',
        'https://codabee.com/wp-content/uploads/2018/06/un.mp3'),
    Musique('Theme Flutter', 'Codabee', 'assets/deux.jpg',
        'https://codabee.com/wp-content/uploads/2018/06/deux.mp3'),
  ];

  AudioPlayer audioPlayer;
  StreamSubscription positionSub;
  StreamSubscription stateSubscription;
  Musique maMusiqueActuelle;
  Duration position = Duration(seconds: 0);
  Duration duree = Duration(seconds: 10);
  PlayerState statut = PlayerState.stopped;
  int index = 0;

  @override
  void initState() {
    // quand l'√©tat de la page d'accueil s'initialise
    super.initState();
    maMusiqueActuelle = maListeDeMusiques[index];
    // on diffuse une musique de la liste (la premi√®re par d√©faut)
    configurationAudioPlayer();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        centerTitle: true,
        backgroundColor: Colors.grey[900],
        title: Text(widget.title), // variable title de notre widget
      ),
      backgroundColor: Colors.grey[800],
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.spaceEvenly,
          children: <Widget>[
            Card(
              elevation: 9.0,
              child: Container(
                width: MediaQuery.of(context).size.height / 2.5,
                child: Image.asset(maMusiqueActuelle.imagePath),
                // attention : le hot reload peut pr√©senter des erreurs avec le initState()
                // solution : relancer l'appli
              ),
            ),
            // ajoute le texte (personnalis√©) de l'appli, gr√¢ce √† la m√©thode texteAvecStyle()
            texteAvecStyle(maMusiqueActuelle.titre, 1.5),
            texteAvecStyle(maMusiqueActuelle.artiste, 1.0),
            // ‚Üì rang√©e des boutons
            Row(
              mainAxisAlignment: MainAxisAlignment.center, // align√©s au centre
              children: <Widget>[
                bouton(Icons.fast_rewind, 30.0, ActionMusic.rewind),
                // ‚Üì logique ternaire pour changer de bouton
                bouton((statut == PlayerState.playing) ? Icons.pause : Icons.play_arrow,
                    45.0,
                    (statut == PlayerState.playing) ? ActionMusic.pause : ActionMusic.play),
                bouton(Icons.fast_forward, 30.0, ActionMusic.forward)
              ],
            ),
            // ‚Üì rang√©e de la progression de la musique [00:00 - 00:22]
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: <Widget>[
                texteAvecStyle(fromDuration(position), 0.8),
                texteAvecStyle(fromDuration(duree), 0.8)
              ],
            ),
            // ‚Üì slider (progression de la musique sur une ligne)
            Slider(
                value: position.inSeconds.toDouble(),
                min: 0.0,
                max: 30.0,
                inactiveColor: Colors.white,
                activeColor: Colors.red,
                onChanged: (double d) {
                  setState(() {
                    audioPlayer.seek(d);
                  });
                })
          ],
        ),
      ),
    );
  }

  // fonction qui renvoie les boutons de l'appli
  // ActionMusic est un enum (choix = play, pause, ect.)
  IconButton bouton(IconData icone, double taille, ActionMusic action) {
    return IconButton(
      iconSize: taille,
      color: Colors.white,
      icon: Icon(icone),
      onPressed: () {
        switch (action) {
          case ActionMusic.play:
            play();
            break;
          case ActionMusic.pause:
            pause();
            break;
          case ActionMusic.forward:
            forward();
            break;
          case ActionMusic.rewind:
            rewind();
            break;
        }
      },
    );
  }

  // fonction pour ajouter le texte de l'application
  Text texteAvecStyle(String data, double scale) {
    return Text(
      data,
      textScaleFactor: scale,
      textAlign: TextAlign.center,
      style: TextStyle(
          color: Colors.white, fontSize: 20.0, fontStyle: FontStyle.italic),
    );
  }

  void configurationAudioPlayer() {
    audioPlayer = AudioPlayer();
    positionSub = audioPlayer.onAudioPositionChanged
        .listen((pos) => setState(() => position = pos));
    stateSubscription = audioPlayer.onPlayerStateChanged.listen((state) {
      if (state == AudioPlayerState.PLAYING) {
        setState(() {
          duree = audioPlayer.duration;
        });
      } else if (state == AudioPlayerState.STOPPED) {
        setState(() {
          statut = PlayerState.stopped;
        });
      }
    }, onError: (message) {
      print('erreur: $message');
      setState(() {
        statut = PlayerState.stopped;
        duree = Duration(seconds: 0);
        position = Duration(seconds: 0);
      });
    });
  }

  Future play() async {
    // attend la r√©ponse de la promesse (Future)
    await audioPlayer.play(maMusiqueActuelle.urlSong);
    // quand la promesse est r√©solue on lance ‚Üì
    setState(() {
      statut = PlayerState.playing;
    });
  }

  Future pause() async {
    await audioPlayer.pause();
    setState(() {
      statut = PlayerState.paused;
    });
  }

  void forward() {
    // si on est au dernier √©l√©ment de la liste
    if (index == maListeDeMusiques.length - 1) {
      index = 0;
    } else {
      index++;
    }
    maMusiqueActuelle = maListeDeMusiques[index];
    audioPlayer.stop();
    configurationAudioPlayer();
    play();
  }

  String fromDuration(Duration duree) {
    print(duree);
    return duree.toString().split('.').first;
  }

  void rewind() {
    // si la musique est lanc√©e depuis plus de 3 secondes
    if (position > Duration(seconds: 3)) {
      audioPlayer.seek(0.0);
    } else {
      if (index == 0) {
        index = maListeDeMusiques.length - 1;
      } else {
        index--;
      }
      maMusiqueActuelle = maListeDeMusiques[index];
      audioPlayer.stop();
      configurationAudioPlayer();
      play();
    }
  }
}

enum ActionMusic { play, pause, rewind, forward }

enum PlayerState { playing, stopped, paused }
```
* musique.dart
```java
// lib/musique.dart
class Musique {

  String titre;
  String artiste;
  String imagePath;
  String urlSong;

  Musique(this.titre, this.artiste, this.imagePath, this.urlSong);
  // constructeur simplifi√©
}
```


## CODA JEU DE QUIZZ
* Cr√©ation d'une application de Quizz
* Structure :
```py
quizz/
  lib/
    # ‚Üì nos objets
    models/ # lib => package => models
      questions.dart
    widgets/ # tous les Stateful Widgets
      custom_text.dart
      home.dart
      my_app.dart
      page_quizz.dart
    main.dart
quizz assets/
```
* pubspec.yaml
```yaml
# ...
  # To add assets to your application, add an assets section, like this:
  assets:
    - quizz assets/
```
* main.dart
```java
import 'package:flutter/material.dart';
import 'package:quizz/widgets/my_app.dart';
// ‚Üë chercher des fichiers hors package

void main() => runApp(MyApp());
```
* widgets/my_app.dart
```java
import 'package:flutter/material.dart';
import 'package:quizz/widgets/home.dart';

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      debugShowCheckedModeBanner: false,
      title: 'Flutter Demo',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: MyHomePage(title: 'Quizz vrai ou faux'),
    );
  }
}
```
* widgets/home.dart
```java
import 'package:flutter/material.dart';
import 'package:quizz/widgets/custom_text.dart';
import 'page_quizz.dart';

class MyHomePage extends StatefulWidget {

  MyHomePage({Key key, this.title}) : super(key: key);

  final String title;

  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.spaceEvenly,
          children: <Widget>[
            Card(
              elevation: 10.0,
              child: Container(
                height: MediaQuery.of(context).size.width * 0.8,
                width: MediaQuery.of(context).size.width * 0.8,
                child: Image.asset("quizz assets/cover.jpg",
                  fit: BoxFit.cover,
                ),
              ),
            ),
            RaisedButton(
              color: Colors.blue,
                onPressed: () {
                  Navigator.push(context, MaterialPageRoute(builder: (BuildContext context) {
                    return PageQuizz();
                  }));
                },
              // ‚Üì notre widget texte personnalis√©
              child: CustomText("Commencer le quizz", factor: 1.5),
            )
          ],
        ),
      ), // This trailing comma makes auto-formatting nicer for build methods.
    );
  }
}
```
* widgets/page_quizz.dart
```java
import 'dart:async';

import 'package:flutter/material.dart';
import 'custom_text.dart'; // pas de package: on est dans le m√™me package
import 'package:quizz/models/question.dart';

class PageQuizz extends StatefulWidget {

  @override
  _PageQuizzState createState() => _PageQuizzState();
  
}

class _PageQuizzState extends State<PageQuizz> {

  Question question;

  List<Question> listeQuestions = [
    Question('La devise de la Belgique est l\'union fait la force', true, '', 'belgique.JPG'),
    Question('La lune va finir par tomber sur terre √† cause de la gravit√©', false, 'Au contraire la lune s\'√©loigne', 'lune.jpg'),
    Question('La Russie est plus grande en superficie que Pluton', true, '', 'russie.jpg'),
    Question('Nyctalope est une race naine d\'antilope', false, 'C‚Äôest une aptitude √† voir dans le noir', 'nyctalope.jpg'),
    Question('Le Commodore 64 est l\‚Äôoridnateur de bureau le plus vendu', true, '', 'commodore.jpg'),
    Question('Le nom du drapeau des pirates es black skull', false, 'Il est appel√© Jolly Roger', 'pirate.png'),
    Question('Haddock est le nom du chien Tintin', false, 'C\'est Milou', 'tintin.jpg'),
    Question('La barbe des pharaons √©tait fausse', true, 'A l\'√©poque d√©j√† ils utilisaient des postiches', 'pharaon.jpg'),
    Question('Au Qu√©bec tire toi une b√ªche veut dire viens viens t\'asseoir', true, 'La b√ªche, fameuse chaise de bucheron', 'buche.jpg'),
    Question('Le module lunaire Eagle de poss√©dait de 4Ko de Ram', true, 'Dire que je me plains avec mes 8GO de ram sur mon mac', 'eagle.jpg'),
  ];

  int index = 0;
  int score = 0;

  // √† l'initialisation du widget
  @override
  void initState() {
    super.initState();
    question = listeQuestions[index];
  }
  
  @override
  Widget build(BuildContext context) {
    double taille = MediaQuery.of(context).size.width * 0.75;
    return Scaffold(
      appBar: AppBar(
        title: CustomText('Le Quizz'),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.spaceEvenly,
          children: <Widget>[
            CustomText("Question num√©ro ${index + 1}", color: Colors.grey[900],),
            CustomText("Score: $score / $index", color: Colors.grey[900],),
            Card(
              elevation: 10.0,
              child: Container(
                height: taille,
                width: taille,
                child: Image.asset(
                    "quizz assets/${question.imagePath}",
                  fit: BoxFit.cover,
                ),
              ),
            ),
            CustomText(question.question, color: Colors.grey[900], factor: 1.3,),
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceEvenly,
              children: <Widget>[
                boutonBool(true),
                boutonBool(false)
              ],
            )
          ],
        ),

      ),
    );
  }
  
  RaisedButton boutonBool (bool b) {
    return RaisedButton(
      elevation: 10.0,
      onPressed: (() => dialogue(b)),
      color: Colors.blue,
      child: CustomText((b) ? "Vrai": "Faux", factor: 1.25,),
    );
  }
  
  Future<Null> dialogue(bool b) async {
    bool bonneReponse = (b == question.reponse);
    String vrai = "quizz assets/vrai.jpg";
    String faux = "quizz assets/faux.jpg";
    if (bonneReponse) {
      score++;
    }

    return showDialog(
        context: context,
      barrierDismissible: false,
      builder: (BuildContext context) {
          return SimpleDialog(
            title: CustomText((bonneReponse) ? "C'est gagn√©!" : "Oups! perdu...",
              factor: 1.4, color: (bonneReponse) ? Colors.green : Colors.red,),
            contentPadding: EdgeInsets.all(20.0),
            children: <Widget>[
              Image.asset((bonneReponse)? vrai: faux, fit: BoxFit.cover,),
              Container(height: 25.0,),
              CustomText(question.explication, factor: 1.25, color: Colors.grey[900],),
              Container(height: 25.0,),
              RaisedButton(onPressed: () {
                Navigator.pop(context);
                questionSuivante();
              },
              child: CustomText("Au suivant", factor: 1.25,),
              color: Colors.blue,
                ),
            ],
          );
      }
    );
  }

  Future<void> alerte() async {
    return showDialog<void>(context: context,
      barrierDismissible: false,
      // ‚Üì buildContext = contexte (identifiant) du pop-up
      builder: (BuildContext buildContext) {
        return AlertDialog(
          title: CustomText("C'est fini", color: Colors.blue, factor: 1.25,),
          contentPadding: EdgeInsets.all(10.0),
          content: CustomText("Votre score: $score / $index", color: Colors.grey[900],),
          actions: <Widget>[
            FlatButton(
                onPressed: (() {
                  // ‚Üì on ferme l'identifiant du pop-up
                  // on revient en arri√®re sur la page
                  Navigator.pop(buildContext);
                  // ‚Üì on ferme l'identifiant de la page
                  // on revient sur la page pr√©c√©dent
                  Navigator.pop(context);
                }),
                child: CustomText("OK", factor: 1.25, color: Colors.blue,))
          ],
        );
      }
    );
  }

  void questionSuivante() {
    if (index < listeQuestions.length - 1) {
      index++;
      setState(() {
        question = listeQuestions[index];
      });
    } else {
      alerte();
    }
  }
  
}
```
* widgets/custom_text.dart
```java
import 'package:flutter/material.dart';

// widget Text personnalis√©
class CustomText extends Text {
                            // choix par d√©faut
  CustomText(String data, {color: Colors.white, textAlign: TextAlign.center, factor: 1.0}):
      super(data,
          textAlign: textAlign,
          textScaleFactor: factor,
          style: TextStyle(color: color)
      );
}
```
* models/question.dart
```java
class Question {
  String question;
  bool reponse;
  String explication;
  String imagePath;

  Question(this.question, this.reponse, this.explication, this.imagePath);
}
```

## CODA CALCUL CALORIES
* Calcule le besoin en calories selon le sexe, √¢ge, ect.
* pubspec.yaml
```yaml
dependencies:
  flutter:
    sdk: flutter
  flutter_localizations: # ++
    sdk: flutter
```
* main.dart
```java
import 'package:flutter/material.dart';
import 'package:flutter_localizations/flutter_localizations.dart'; // supporter les locales

void main() => runApp(new MyApp());

class MyApp extends StatelessWidget {
  // This widget is the root of your application.
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      debugShowCheckedModeBanner: false,
      localizationsDelegates: [ // ++
        GlobalMaterialLocalizations.delegate,
        GlobalWidgetsLocalizations.delegate,
      ],
      supportedLocales: [ // ++
        const Locale('en', 'US'),
        const Locale('ru', 'RU'),
        const Locale('fr', 'FR'),
      ],
      title: 'Flutter Demo',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: MyHomePage(title: 'Flutter Demo Home Page'),
    );
  }
}

class MyHomePage extends StatefulWidget {
  MyHomePage({Key key, this.title}) : super(key: key);
  final String title;

  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {

  int calorieBase;
  int calorieAvecActivite;
  int radioSelectionnee;
  double poids;
  double age;
  bool genre = false;
  double taille = 170.0;
  Map mapActivite = {
    0: "Faible",
    1: "Mod√©r√©e",
    2: "Forte"
  };

  @override
  Widget build(BuildContext context) {
    // ‚Üì pallier l'abscence de submit pour les numbers sur IOS
    return GestureDetector(
      onTap: (() => FocusScope.of(context).requestFocus(new FocusNode())),
      // ‚Üì le GestureDetector prend la taille du Scaffold
      child: Scaffold(
        appBar: AppBar(
          title: Text(widget.title),
          backgroundColor: setColor(),
        ),
        // ‚Üì avant : Center() mais erreur d'espace d√®s que l'on activait le clavier
        // ‚Üì √©l√©ment d√©roulable qui s'adapte √† la hauteur de l'√©cran
        // ‚Üì probl√®me (r√©solu avec le widget Padding()), tout est fix√© en haut
        body: SingleChildScrollView(
          padding: EdgeInsets.all(15.0),
          child: Column(
            mainAxisAlignment: MainAxisAlignment.spaceEvenly,
            children: <Widget>[
              padding(),
              texteAvecStyle("Remplissez tous les champs pour obtenir votre besoin journalier en calories."),
              padding(),
              Card(
                elevation: 10.0,
                child: Column(
                  children: <Widget>[
                    padding(),
                    Row(
                      mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                      children: <Widget>[
                        texteAvecStyle("Femme", color: Colors.pink),
                        Switch(
                            value: genre,
                            inactiveTrackColor: Colors.pink,
                            activeTrackColor: Colors.blue,
                            onChanged: (bool choice) {
                              setState(() {
                                genre = choice;
                              });
                            }),
                        texteAvecStyle("Homme", color: Colors.blue)
                      ],
                    ),
                    padding(),
                    RaisedButton(
                      color: setColor(),
                      child: texteAvecStyle((age == null) ? "Appuyez pour entrer votre age" :
                        "Votre age est de : ${age.toInt()}",
                        color: Colors.white
                      ),
                        onPressed: (() => montrerPicker())
                    ),
                    padding(),
                    texteAvecStyle("Votre taille est de: ${taille.toInt()} cm.", color: setColor()),
                    padding(),
                    Slider(
                        value: taille,
                        activeColor: setColor(),
                        onChanged: (double cursor) {
                          setState(() {
                            taille = cursor;
                          });
                        },
                      max: 215.0,
                      min: 100.0,
                    ),
                    padding(),
                    TextField(
                      keyboardType: TextInputType.number,
                      onChanged: (String string) {
                        setState(() {
                          poids = double.tryParse(string); // string => double
                        });
                      },
                      decoration: InputDecoration(
                        labelText: "Entrez votre poids en kilos."
                      ),
                    ),
                    padding(),
                    texteAvecStyle("Quelle est votre activit√© sportive?", color: setColor()),
                    padding(),
                    rowRadio(),
                    padding()
                  ],
                ),
              ),
              padding(),
              RaisedButton(
                color: setColor(),
                child: texteAvecStyle("Calculer", color: Colors.white),
                  onPressed: calculerNombreDeCalories,
              )
            ],
          ),
        ),
      ),
    );
  }


  Padding padding() {
    return Padding(padding: EdgeInsets.only(top: 20.0));
  }

  Future<void> montrerPicker() async {
    DateTime choix = await showDatePicker(
        context: context,
        initialDate: DateTime.now(),
        firstDate: DateTime(1900),
        lastDate: DateTime.now(),
        initialDatePickerMode: DatePickerMode.year,
        locale: const Locale('fr', 'FR'), // nomination fr
    );
    if (choix != null) {
      // ‚Üì temps √©coul√© entre today et la date choisie
      var difference = DateTime.now().difference(choix);
      var jours = difference.inDays;
      var ans = (jours / 365);
      setState(() {
        age = ans;
      });
    }
  }

  // change la couleur de l'appli selon le genre choisi
  Color setColor() {
    if (genre) {
      return Colors.blue;
    }
    return Colors.pink;
  }
  
  Text texteAvecStyle(String data, {color: Colors.black, fontSize: 15.0}) {
    return Text(
      data,
      textAlign: TextAlign.center,
      style: TextStyle(
        color: color,
        fontSize: fontSize
      )
    );
  }
  
  Row rowRadio() {
    List<Widget> listRadios = [];
    mapActivite.forEach((key, value) {
      Column colonne = Column(
        mainAxisAlignment: MainAxisAlignment.center,
        children: <Widget>[
          Radio(
            activeColor: setColor(),
            value: key,
            groupValue: radioSelectionnee,
            onChanged: (Object i) {
            setState(() {
              radioSelectionnee = i;
            });
          }),
          texteAvecStyle(value, color: setColor())
        ],
      );
      listRadios.add(colonne);
    });
    return Row(
      mainAxisAlignment: MainAxisAlignment.spaceEvenly,
      children: listRadios,
    );
  }

  void calculerNombreDeCalories() {
    if (age != null && poids != null && radioSelectionnee != null) {
      //Calculer
      if (genre) {
        calorieBase = (66.4730 + (13.7516 * poids) + (5.0033 * taille) - (6.7550 * age)).toInt();
      } else {
        calorieBase = (655.0955 + (9.5634 * poids) + (1.8496 * taille) - (4.6756 * age)).toInt();
      }
      switch(radioSelectionnee) {
        case 0:
          calorieAvecActivite = (calorieBase * 1.2).toInt();
          break;
        case 1:
          calorieAvecActivite = (calorieBase * 1.5).toInt();
          break;
        case 2:
          calorieAvecActivite = (calorieBase * 1.8).toInt();
          break;
        default:
          calorieAvecActivite = calorieBase;
          break;
      }

      setState(() {
        resultat();
      });

    } else {
      alerte();
    }
  }

  Future<void> resultat() async {
    return showDialog(
        context: context,
        barrierDismissible: false,
        builder: (BuildContext buildContext) {
          return SimpleDialog(
            title: texteAvecStyle("Votre besoin en calories", color: setColor()),
            contentPadding: EdgeInsets.all(15.0),
            children: <Widget>[
              padding(),
              texteAvecStyle("Votre besoin de base est de: $calorieBase"),
              padding(),
              texteAvecStyle("Votre besoin avec activit√© sportive est de : $calorieAvecActivite"),
              RaisedButton(onPressed: () {
                Navigator.pop(buildContext);
              },
              child: texteAvecStyle("OK", color: Colors.white),
                color: setColor(),
              )
            ],
          );
        }
    );
  }

  Future<void> alerte() async {
    return showDialog(
      context: context,
      barrierDismissible: false, // l'utilisateur doit appuyer sur le bouton !
      // ‚Üì buildcontext = #identifiant du pop-up
      builder: (BuildContext buildContext) {
          return AlertDialog(
            title: texteAvecStyle("Erreur"),
            content: texteAvecStyle("Tous les champs ne sont pas remplis"),
            actions: <Widget>[
              FlatButton(
                  onPressed: () {
                    Navigator.pop(buildContext); // on sort du pop-up
                  },
                  child: texteAvecStyle("OK", color: Colors.red))
            ],
          );
      }
    );
  }
}
```

## CODA NEWS

* Application de Flux RSS, mall√©able selon l'orientation de l'appareil et qui donne acc√®s √† une page d√©taill√©e de l'information cliqu√©e
* https://pub.dev/packages/webfeed
* https://codabee.com/convertir-string-date-swift/
* Structure :
```py
coda_news/
  lib/
    # ‚Üì nos objets
    models/ # lib => package => models
      date_convertisseur.dart
      parser.dart
    widgets/ # tous les Stateful Widgets
      chargement.dart
      grille.dart
      home.dart
      liste.dart
      my_app.dart
      page_detail.dart
      texte_codabee.dart
    main.dart
pubspec.yaml
```
* pubspec.yaml
```yaml
name: coda_news
description: A new Flutter application.

dependencies:
  flutter:
    sdk: flutter
  webfeed: # d√©pendances sans contraintes de versions
  html: # permet de parser un document du web
  intl: # permet de formater une date
  http:

  # The following adds the Cupertino Icons font to your application.
  # Use with the CupertinoIcons class for iOS style icons.
  cupertino_icons: ^0.1.2

dev_dependencies:
  flutter_test:
    sdk: flutter

# For information on the generic Dart part of this file, see the
# following page: https://www.dartlang.org/tools/pub/pubspec

# The following section is specific to Flutter.
flutter:

  # The following line ensures that the Material Icons font is
  # included with your application, so that you can use the icons in
  # the material Icons class.
  uses-material-design: true
```
* main.dart
```java
import 'package:flutter/material.dart';
import 'package:coda_news/widgets/my_app.dart';

void main() => runApp(MyApp());
```
* my_app.dart
```java
import 'package:flutter/material.dart';
import 'home.dart';

class MyApp extends StatelessWidget {
  // This widget is the root of your application.
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      debugShowCheckedModeBanner: false,
      title: 'Flutter Demo',
      theme: ThemeData(
        primarySwatch: Colors.indigo,
      ),
      home: Home(title: 'Coda News'),
    );
  }
}
```
* home.dart
```java
import 'package:flutter/material.dart';
import 'dart:async';
import 'package:coda_news/models/parser.dart';
import 'package:webfeed/webfeed.dart';
import 'chargement.dart';
import 'liste.dart';
import 'grille.dart';

class Home extends StatefulWidget {
  Home({Key key, this.title}) : super(key: key);
  final String title;

  @override
  _HomeState createState() => _HomeState();
}

class _HomeState extends State<Home> {

  RssFeed feed;

  @override
  void initState() {
    super.initState();
    parse(); // appelle le flux RSS au d√©marrage de l'appli
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        centerTitle: true,
        title: Text(widget.title),
        actions: <Widget>[
          // ‚Üì bouton pour rafra√Æchir la page
          IconButton(
              icon: Icon(Icons.refresh),
              onPressed: () {
                setState(() {
                  feed = null; // supprime les infos
                  parse(); // r√©cup√®re les nouvelles donn√©es
                });
              })
        ],
      ),
      body: choixDuBody(),
    );
  }

  Widget choixDuBody() {
    if (feed == null) {
      // ‚Üì renvoie un message de chargement
      return Chargement();
    } else {
      Orientation orientation = MediaQuery.of(context).orientation;
      if (orientation == Orientation.portrait) {
        // affichage d'une Liste
        return Liste(feed);
      } else {
        // afiichage d'une Grille
        return Grille(feed);
      }
    }
  }

  Future<void> parse() async {
    RssFeed recu = await Parser().chargerRSS();
    if (recu != null) {
      setState(() {
        feed = recu; // notre feed devient le fil RSS charg√©
        print(feed.items.length);
        feed.items.forEach((feedItem) {
          RssItem item = feedItem;
          print(item.title);
          print(item.description);
          print(item.pubDate);
          print(item.enclosure.url);
        });
      });
    }
  }
}
```
* chargement.dart
```java
import 'package:flutter/material.dart';
import 'texte_codabee.dart';

// Stateless car pas besoin de le rendre dynamique
class Chargement extends StatelessWidget {

  @override
  Widget build(BuildContext context) {
    return Center(
      child: TexteCodabee("Chargement en cours...",
        fontStyle: FontStyle.italic,
        fontSize: 30.0,
      ),
    );
  }

}
```
* texte_codabee.dart
```java
import 'package:flutter/material.dart';

class TexteCodabee extends Text {

  TexteCodabee(String data,
      {textAlign: TextAlign.center,
      color: Colors.indigo,
      fontSize: 15.0,
      fontStyle: FontStyle.normal})
      : super(data ?? "",
            // si data est vide, on le remplace par un string vide
            // pr√©vient des erreurs potentielles
            textAlign: textAlign,
            style: TextStyle(
                color: color, fontSize: fontSize, fontStyle: fontStyle));
}
```
* grille.dart
```java
import 'package:flutter/material.dart';
import 'texte_codabee.dart';
import 'package:coda_news/models/date_convertisseur.dart';
import 'package:webfeed/webfeed.dart';
import 'page_detail.dart';

class Grille extends StatefulWidget {
  RssFeed feed;

  Grille(this.feed);

  @override
  _GrilleState createState() => _GrilleState();
}

class _GrilleState extends State<Grille> {

  @override
  Widget build(BuildContext context) {
    return GridView.builder(
        itemCount: widget.feed.items.length,
        // slivers = parties d'une zone scrollable
        gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(crossAxisCount: 2),
        itemBuilder: (context, i) {
          RssItem item = widget.feed.items[i];
          return InkWell(
              // navigation vers le d√©tail de l'article
              onTap: () {
                Navigator.push(context, MaterialPageRoute(builder: (BuildContext context) {
                  return PageDetail(item);
                }));
              },
              child: Card(
                elevation: 10.0,
                child: Column(
                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                  children: <Widget>[
                    Row(
                      mainAxisAlignment: MainAxisAlignment.spaceBetween,
                      // ‚Üì How much space should be occupied in the main axis
                      // After allocating space to children,
                      // there might be some remaining free space
                      mainAxisSize: MainAxisSize.max,
                      children: <Widget>[
                        TexteCodabee(item.author),
                        TexteCodabee(DateConvertisseur().convertirDate(item.pubDate), color: Colors.red,)
                      ],
                    ),
                    TexteCodabee(item.title),
                    Card(
                      elevation: 7.5,
                      child: Container(
                        width: MediaQuery.of(context).size.width / 2.5,
                        child: Image.network(item.enclosure.url, fit:  BoxFit.fill,),
                      ),
                    )

                  ],
                ),
              )
          );

        });
  }
}
```
* liste.dart
```java
import 'package:flutter/material.dart';
import 'package:webfeed/webfeed.dart';
import 'texte_codabee.dart';
import 'package:coda_news/models/date_convertisseur.dart';
import 'page_detail.dart';

class Liste extends StatefulWidget {
  RssFeed feed;

  Liste(this.feed);

  @override
  _ListeState createState() => _ListeState();
}

class _ListeState extends State<Liste> {

  @override
  Widget build(BuildContext context) {
    final taille = MediaQuery.of(context).size.width / 2.5;
    return ListView.builder(
        // widget repr√©sente la classe Liste
        itemCount: widget.feed.items.length,
        itemBuilder: (context, i) {
          RssItem item = widget.feed.items[i];
          return Container(
            child: Card(
                elevation: 10.0,
                child: InkWell(
                  // navigation vers le d√©tail de l'article
                  onTap: () {
                    Navigator.push(context, MaterialPageRoute(builder: (BuildContext context) {
                      return PageDetail(item);
                    }));
                  },
                  child: Column(
                    children: <Widget>[
                      padding(),
                      Row(
                        mainAxisSize: MainAxisSize.max,
                        mainAxisAlignment: MainAxisAlignment.spaceBetween,
                        children: <Widget>[
                          TexteCodabee(item.author),
                          TexteCodabee(DateConvertisseur().convertirDate(item.pubDate), color: Colors.red,)
                        ],
                      ),
                      padding(),
                      Row(
                        mainAxisAlignment: MainAxisAlignment.spaceBetween,
                        children: <Widget>[
                          Card(
                            elevation: 7.5,
                            child: Container( // pour que Card ait une width
                              width: taille,
                              child: Image.network(item.enclosure.url, fit: BoxFit.fill,),
                            ),
                          ),
                          Container(
                            width: taille,
                            child: TexteCodabee(item.title),
                          )
                        ],

                      ),
                      padding(),
                    ],
                  ),
                )


            ),
            padding: EdgeInsets.only(right: 7.5, left: 7.5),
          );
        });
  }

  Padding padding() {
    return Padding(padding: EdgeInsets.only(top: 10.0));
  }
}
```
* page_detail.dart
```java
import 'package:flutter/material.dart';
import 'package:webfeed/webfeed.dart';
import 'texte_codabee.dart';
import 'package:coda_news/models/date_convertisseur.dart';

// pas d'√©l√©ments cliquables => StatelessWidget
// pas de classe State
class PageDetail extends StatelessWidget {
  RssItem item;

  PageDetail(this.item);

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text("D√©tail de l'article"),
      ),
      // ‚Üì avant : Center() | permet le scroll sur la page
      body: SingleChildScrollView(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.spaceEvenly,
          children: <Widget>[
            padding(),
            TexteCodabee(item.title, fontSize: 25.0, fontStyle: FontStyle.italic,),
            padding(),
            Card(
              elevation: 7.5,
              child: Container(
                width: MediaQuery.of(context).size.width / 1.5,
                child: Image.network(item.enclosure.url, fit: BoxFit.fill,),
              ),
            ),
            padding(),
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: <Widget>[
                TexteCodabee(item.author),
                TexteCodabee(DateConvertisseur().convertirDate(item.pubDate), color: Colors.red,),
              ],
            ),
            padding(),
            TexteCodabee(item.description),
            padding(),
          ],
        ),
      ),
    );
  }

  Padding padding() {
    return Padding(padding: EdgeInsets.only(top: 20.0));
  }

}
```
* parser.dart
```java
import 'package:webfeed/webfeed.dart'; // package webfeed
// librairie Dart qui parse des flux RSS
import 'package:http/http.dart'; // http package ++
import 'dart:async'; // plus obligatoire

class Parser {

  // url de notre feed RSS
  final url = "http://www.france24.com/fr/actualites/rss";

  Future chargerRSS() async {
    // tente de charger l'url
    final reponse = await get(url);
    // si tout est OK
    if (reponse.statusCode == 200) {
      // parse le r√©sultat
      final feed = RssFeed.parse(reponse.body);
      // renvoie le r√©sultat pars√©
      return feed;
    } else {
      print("erreur: ${reponse.statusCode}");
    }
  }
}
```
* date_convertisseur.dart
```java
import 'package:flutter/material.dart';
import 'package:intl/intl.dart';

class DateConvertisseur {

  String convertirDate(String string) {
    String il = "il y a";
    String format = "EEE, dd MMM yyyy HH:mm:ss Z";
    var formatter = DateFormat(format);
    DateTime dateTime = formatter.parse(string);
    if (dateTime == null) {
      return "Date inconnue";
    } else {
      var difference = new DateTime.now().difference(dateTime);
      var jours = difference.inDays;
      var heures = difference.inHours;
      var minutes = difference.inMinutes;

      if (jours > 1) {
        return "$il $jours jours";
      } else if (jours == 1) {
        return "$il 1 jour";
      } else if (heures > 1) {
        return "$il $heures heures";
      } else if (heures == 1) {
        return "$il 1 heure";
      } else if (minutes > 1) {
        return "$il $minutes minutes";
      } else if (minutes == 1) {
        return "$il 1 minute";
      } else {
        return "A l'instant";
      }
    }

  }

}
```

## CODA METEO
* Application qui donne les param√®tres m√©t√©rologiques d'une ville donn√©e
* https://pub.dev/packages/shared_preferences
* https://medium.com/flutterdevs/using-sharedpreferences-in-flutter-251755f07127
* https://medium.com/flutter-community/shared-preferences-how-to-save-flutter-application-settings-and-user-preferences-for-later-554d08671ae9
* https://codesource.io/getting-started-with-shared-preferences-in-flutter/
* Shared preferences :
```js
var preferences = await SharedPreferences.getInstance(); // Save a value
preferences.setString('value_key', 'hello preferences'); // Retrieve value later
var savedValue = preferences.getString('value_key');
```
* https://pub.dev/packages/location
* https://pub.dev/packages/geocoder
* https://openweathermap.org/
* https://pub.dev/packages/http
* Structure :
```py
weather_2020/
  assets/
    01.png
    02.png
    # ect.
  flutter-icons/
    fonts/
      MyFlutterApp.ttf # font des icones t√©l√©charg√©es
    config.json # liste des icones t√©l√©charg√©es
    # my_flutter_app_icons.dart a √©t√© d√©plac√© dans le lib/
  lib/
    main.dart
    my_flutter_app_icons.dart # classe qui permet d'importer les images
    temps.dart
.flutter-plugins
.flutter-plugins-dependencies
pubspec.yaml
```
* pubspec.yaml
```yaml
name: weather2020
description: A new Flutter application.

# The following line prevents the package from being accidentally published to
# pub.dev using `pub publish`. This is preferred for private packages.
publish_to: 'none' # Remove this line if you wish to publish to pub.dev

# The following defines the version and build number for your application.
# A version number is three numbers separated by dots, like 1.2.43
# followed by an optional build number separated by a +.
# Both the version and the builder number may be overridden in flutter
# build by specifying --build-name and --build-number, respectively.
# In Android, build-name is used as versionName while build-number used as versionCode.
# Read more about Android versioning at https://developer.android.com/studio/publish/versioning
# In iOS, build-name is used as CFBundleShortVersionString while build-number used as CFBundleVersion.
# Read more about iOS versioning at
# https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html
version: 1.0.0+1

environment:
  sdk: ">=2.7.0 <3.0.0"

dependencies:
  flutter:
    sdk: flutter
  shared_preferences: # permet d'enregister en XML des donn√©es simples (int, string, ect.)
  location:
  geocoder: # transforme noms de ville en position(lat, long)
  http: # pour les requ√™tes HTTP (API)


  # The following adds the Cupertino Icons font to your application.
  # Use with the CupertinoIcons class for iOS style icons.
  cupertino_icons: ^0.1.3

dev_dependencies:
  flutter_test:
    sdk: flutter

# For information on the generic Dart part of this file, see the
# following page: https://dart.dev/tools/pub/pubspec

# The following section is specific to Flutter.
flutter:

  # The following line ensures that the Material Icons font is
  # included with your application, so that you can use the icons in
  # the material Icons class.
  uses-material-design: true

  # ajout des ic√¥nes fonts :
  fonts:
    - family: MyFlutterApp # retrouvable dans la classe my_flutter_app_icons
      fonts:
        - asset: flutter-icons/fonts/MyFlutterApp.ttf

  # To add assets to your application, add an assets section, like this:
  assets:
    - assets/
```
* main.dart
```java
import 'package:flutter/material.dart';
import 'dart:async'; // plus obligatoire
import 'package:shared_preferences/shared_preferences.dart';
// ‚Üë import des shared preferences pour stocker des donn√©es simples
import 'package:flutter/services.dart';
import 'package:location/location.dart';
import 'package:geocoder/geocoder.dart';
import 'package:http/http.dart' as http;
// ‚Üë alias, permet d'√™tre utilis√© directement dans le code
import 'temps.dart';
import 'dart:convert'; // convertit le JSON
import 'my_flutter_app_icons.dart';

void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  // package Location ‚Üë s'assurer que tout est initialis√©
  SystemChrome.setPreferredOrientations([DeviceOrientation.portraitUp]);
  // ‚Üì initialisation du package Location suite :
  Location location = Location();
  LocationData position; // objet re√ßu vis-√†-vis de notre localisation
  try {
    position = (await location.getLocation());
    print(position);
  } on PlatformException catch (e) {
    print("Erreur: $e");
  }
  if (position != null) {
    final latitude = position.latitude;
    final longitude = position.longitude;
    final Coordinates coordinates = Coordinates(latitude, longitude);
    final ville = await Geocoder.local.findAddressesFromCoordinates(coordinates);
    if (ville != null) {
      print(ville.first.locality);
      runApp(new MyApp(ville.first.locality));
    }

  }
}

class MyApp extends StatelessWidget {
  MyApp(String ville) {
    this.ville = ville;
  }

  String ville;

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      debugShowCheckedModeBanner: false,
      title: 'Flutter Demo',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: MyHomePage(ville, title: 'Coda M√©t√©o'),
    );
  }
}

class MyHomePage extends StatefulWidget {
  MyHomePage(String ville, {Key key, this.title}) : super(key: key) {
    this.villeDeLutilisateur = ville;
  }

  String villeDeLutilisateur;
  final String title;

  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {
  String key = "villes";
  List<String> villes = [];
  String villeChoisie;
  Temps tempsActuel;

  @override
  void initState() {
    super.initState();
    obtenir(); // obtenir shared preferences
    appelApi();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        centerTitle: true,
        title: Text(widget.title),
      ),
      // ‚Üì notre drawer √† gauche (voir endDrawer pour la droite), menu coulissant
      drawer: Drawer(
        child: Container(
          child: ListView.builder(
              itemCount: villes.length + 2, // car ajout d'un header + ville actuelle
              // qui seront compris dans la liste
              itemBuilder: (context, i) {
                if (i == 0) { // 1er √©l√©ment de la liste => header du Drawer
                  return DrawerHeader(
                    child: Column(
                      mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                      children: <Widget>[
                        texteAvecStyle("Mes Villes", fontSize: 22.0),
                        RaisedButton(
                            color: Colors.white,
                            elevation: 8.0,
                            child: texteAvecStyle("Ajouter une ville", color: Colors.blue),
                            onPressed: ajoutVille
                        )
                      ],
                    ),
                  );
                } else if (i == 1) { // => 2√®me √©l√®ment de la liste => ville actuelle
                  return ListTile(
                    title: texteAvecStyle(widget.villeDeLutilisateur),
                    onTap: () {
                      setState(() {
                        villeChoisie = null;
                        appelApi();
                        Navigator.pop(context);
                      });
                    },
                  );
                } else { // autres √©l√©ments de la liste = les villes repertori√©es
                  String ville = villes[i - 2];
                  return ListTile(
                    title: texteAvecStyle(ville),
                    trailing: IconButton(
                        icon: Icon(Icons.delete, color: Colors.white,),
                        onPressed: (() => supprimer(ville))),
                    onTap: () {
                      setState(() {
                        villeChoisie = ville;
                        appelApi();
                        Navigator.pop(context);
                      });
                    },
                  );
                }
              }),
          color: Colors.blue,
        ),
      ),
      endDrawer: // drawer √† droite
      body: (tempsActuel == null)
          ? Center(
        child: Text((villeChoisie == null)? widget.villeDeLutilisateur: villeChoisie),
      )
          : Container(
        width: MediaQuery.of(context).size.width, // width auto
        height: MediaQuery.of(context).size.height, // height auto
        // ‚Üì permet l'image de fond
        decoration: BoxDecoration(
          image: DecorationImage(
              image: AssetImage(getBackground()),
              fit: BoxFit.cover
          ),
        ),
        padding: EdgeInsets.all(20.0),
        child: Column(
          mainAxisAlignment: MainAxisAlignment.spaceEvenly,
          children: <Widget>[
            texteAvecStyle(tempsActuel.name, fontSize: 30.0),
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceEvenly,
              children: <Widget>[
                texteAvecStyle("${tempsActuel.temp.toInt()}¬∞C", fontSize: 60.0),
                // pour r√©cup√©rer sur le web (et non en local) :
                // Image.network(http://openweathermap.org/img/wn/${tempsActuel.icon}.png)
                Image.asset(getIconImage())
              ],
            ),
            texteAvecStyle(tempsActuel.main, fontSize: 30.0),
            texteAvecStyle(tempsActuel.description, fontSize: 25.0),
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceEvenly,
              children: <Widget>[
                Column(
                  children: <Widget>[
                    // appel de la classe MyFlutterApp
                    // et de ses constantes qui repr√©sentent des ic√¥nes
                    Icon(MyFlutterApp.temperature, color: Colors.white, size: 30.0,),
                    texteAvecStyle("${tempsActuel.pressure}", fontSize: 20.0)
                  ],
                ),
                Column(
                  children: <Widget>[
                    Icon(MyFlutterApp.droplet, color: Colors.white, size: 30.0,),
                    texteAvecStyle("${tempsActuel.humidity}", fontSize: 20.0)
                  ],
                ),
                Column(
                  children: <Widget>[
                    Icon(MyFlutterApp.arrow_upward, color: Colors.white, size: 30.0,),
                    texteAvecStyle("${tempsActuel.temp_max}", fontSize: 20.0)
                  ],
                ),
                Column(
                  children: <Widget>[
                    Icon(MyFlutterApp.arrow_downward, color: Colors.white, size: 30.0,),
                    texteAvecStyle("${tempsActuel.temp_min}", fontSize: 20.0)
                  ],
                ),
              ],
            )
          ],
        ),
      ), // This trailing comma makes auto-formatting nicer for build methods.
    );
  }

  // ‚Üì choix des images de fond selon les ic√¥nes r√©cup√©r√©es de l'API
  String getBackground() {
    print(tempsActuel.icon);
    // ‚Üì si c'est un night icon (ex. 01n.png)
    if (tempsActuel.icon.contains("n")) {
      return "assets/n.jpg"; // image de nuit stock√©e en local
    } else if (tempsActuel.icon.contains("01") || tempsActuel.icon.contains("02") || tempsActuel.icon.contains("03")) {
      return "assets/d1.jpg"; // image beau temps
    } else {
      return "assets/d2.jpg"; // image pluie
    }
  }

  // remplace le string de l'icone API (01d.png, 01n.png, ect.)
  // par une image correspondante stock√©e en local (01.png)
  String getIconImage() {
    return "assets/${tempsActuel.icon.replaceAll("d", "").replaceAll("n", "")}.png";
  }

  String monAssetName() { // ma proposition (remplac√©e plus haut)
    // je le laisse pour l'exemple de contains + regex
    // les images 01.png, 02.png et 03.png repr√©sentent le beau temps
    if (tempsActuel.icon.contains("01") || tempsActuel.icon.contains("02") || tempsActuel.icon.contains("03")) {
      return "assets/d1.jpg";
    // regex avec contains
    // on va chercher les fichiers 04.png, 09.png, 10.png, 13.png, 50.png, ect.
    // qui repr√©sentent la pluie
    } else if (tempsActuel.icon.contains(new RegExp(r'\b(0[5-9]|[12][0-9]|50)\b'))) {
      return "assets/d2.jpg";
    // si aucun ic√¥nes, alors il fait nuit
    } else {
      return "assets/n.jpg";
    }
  }

  Text texteAvecStyle(String data, {color: Colors.white, fontSize: 18.0, fontStyle: FontStyle.italic, textAlign: TextAlign.center}) {
    return Text(
      data,
      textAlign: textAlign,
      style: TextStyle(
          color: color,
          fontStyle: fontStyle,
          fontSize: fontSize
      ),
    );
  }

  // simple dialog d'ajout d'une ville
  Future<void> ajoutVille() async {
    return showDialog(
        barrierDismissible: true,
        builder: (BuildContext buildcontext) {
          return SimpleDialog(
            contentPadding: EdgeInsets.all(20.0),
            title: texteAvecStyle("Ajoutez une ville", fontSize: 22.0, color: Colors.blue),
            children: <Widget>[
              TextField(
                decoration: InputDecoration(labelText: "ville: "),
                onSubmitted: (String str) {
                  ajouter(str); // ajout ville au shared preferences
                  Navigator.pop(buildcontext);
                },
              )
            ],

          );
        },
        context: context);
  }

  // obtenir mes shared preferences
  // la sauvegarde s'effectue par le couplage cl√©-valeur
  // en asynchrone car pas obtenu automatiquement
  void obtenir() async {
    SharedPreferences sharedPreferences = await SharedPreferences.getInstance();
    // ‚Üë sauvegarde une valeur
    List<String> liste = await sharedPreferences.getStringList(key);
    // ‚Üë key = key de la valeur sauvegard√©
    // la key de la List<String> sauvegard√©e est la variable key (= "villes")
    if (liste != null) {
      setState(() {
        villes = liste;
      });
    }
  }

  // ajout d'une ville √† notre shared preferences
  void ajouter(String str) async {
    SharedPreferences sharedPreferences = await SharedPreferences.getInstance();
    villes.add(str); // augmente notre liste
    // ‚Üì remplace la liste sauvegard√©e par la liste augment√©e
    await sharedPreferences.setStringList(key, villes);
    obtenir(); // rappelle la liste sauvegard√©e
  }

  // supprimer une ville du shared preferences
  void supprimer(String str) async {
    SharedPreferences sharedPreferences = await SharedPreferences.getInstance();
    villes.remove(str); // r√©duit notre liste
    // ‚Üì remplace la liste sauvegard√©e par notre liste r√©duite
    await sharedPreferences.setStringList(key, villes);
    obtenir(); // rappelle la liste sauvegard√©e
  }

  void appelApi() async {
    String str;
    if (villeChoisie == null) {
      str = widget.villeDeLutilisateur;
    } else {
      str = villeChoisie;
    }
    List<Address> coord = await Geocoder.local.findAddressesFromQuery(str);
    if (coord != null) {
      final lat = coord.first.coordinates.latitude;
      final lon = coord.first.coordinates.longitude;
      // ‚Üì code langue de l'application
      String lang = Localizations.localeOf(context).languageCode;
      print("La langue utilis√©e est $lang");
      // ‚Üë La langue utilis√©e est en
      // ‚Üì cl√© de l'API
      final key = "636bf265ae916d48a0c7e6d872fa1fd6";
      // ‚Üì url personnalis√©e de l'API
      String urlApi = "http://api.openweathermap.org/data/2.5/weather?lat=$lat&lon=$lon&units=metric&lang=$lang&APPID=$key";
      // ‚Üì r√©ponse de l'API, avec l'alias http (objet Http)
      final reponse = await http.get(urlApi);
      if (reponse.statusCode == 200) {
        Temps temps = Temps();
        // ‚Üì on convertit le JSON avec convert
        Map map = json.decode(reponse.body);
        temps.fromJSON(map);
        // ‚Üë on stocke les donn√©es de la r√©ponse convertie
        // dans un objet Temps
        setState(() {
          tempsActuel = temps;
        });
      }
    }
  }
}
```
* temps.dart
```java
class Temps {

  String name;
  String main;
  String description;
  String icon;
  var temp;
  var pressure;
  var humidity;
  var temp_min;
  var temp_max;

  Temps();

  // ‚Üì la r√©ponse API est une Map, que l'on nomme map
  void fromJSON(Map map) {
    this.name = map["name"];

    List weather = map["weather"];
    Map mapWeather = weather[0];
    this.main = mapWeather["main"];
    this.description = mapWeather["description"];
    // ‚Üì repr√©sentation string de l'ic√¥ne dans la r√©ponse JSON
    // https://openweathermap.org/weather-conditions
    String monIcone = mapWeather["icon"];
    this.icon = monIcone;

    Map main = map["main"];
    this.temp = main["temp"];
    this.pressure = main["pressure"];
    this.humidity = main["humidity"];
    this.temp_min = main["temp_min"];
    this.temp_max = main["temp_max"];
  }
}
```
* my_flutter_app_icons.dart
```java
/// Flutter icons MyFlutterApp
/// Copyright (C) 2018 by original authors @ fluttericon.com, fontello.com
/// This font was generated by FlutterIcon.com, which is derived from Fontello.
///
/// To use this font, place it in your fonts/ directory and include the
/// following in your pubspec.yaml
///
/// flutter:
///   fonts:
///    - family:  MyFlutterApp
///      fonts:
///       - asset: fonts/MyFlutterApp.ttf
///
///
/// * Typicons, (c) Stephen Hutchings 2012
///         Author:    Stephen Hutchings
///         License:   SIL (http://scripts.sil.org/OFL)
///         Homepage:  http://typicons.com/
/// * Entypo, Copyright (C) 2012 by Daniel Bruce
///         Author:    Daniel Bruce
///         License:   SIL (http://scripts.sil.org/OFL)
///         Homepage:  http://www.entypo.com
/// * Material Design Icons, Copyright (C) Google, Inc
///         Author:    Google
///         License:   Apache 2.0 (https://www.apache.org/licenses/LICENSE-2.0)
///         Homepage:  https://design.google.com/icons/
///
import 'package:flutter/widgets.dart';

class MyFlutterApp {
  MyFlutterApp._();

  static const _kFontFam = 'MyFlutterApp';
  // family: 'MyFlutterApp' dans yaml

  static const IconData temperature = const IconData(0xe800, fontFamily: _kFontFam);
  static const IconData droplet = const IconData(0xe801, fontFamily: _kFontFam);
  static const IconData arrow_upward = const IconData(0xe802, fontFamily: _kFontFam);
  static const IconData arrow_downward = const IconData(0xe803, fontFamily: _kFontFam);
}
```

## CODE SQFLITE
* Application de listing d'articles, selon des th√®mes
* https://medium.com/flutter-community/using-sqlite-in-flutter-187c1a82e8b
* Instantly parse JSON in any language : https://app.quicktype.io/#l=dart, exemple : https://app.quicktype.io/?share=4Ik8Upww0mN33e2CBVmq
* Probl√®me Image Picker = flutter packages get + flutter clean = https://github.com/flutter/flutter/issues/24859
* Structure :
```py
je_veux/
  images/
    no_image.png
  lib/
    model/
      article.dart
      databaseClient.dart
      item.dart
    widget/
      ajout_article.dart
      donnees_vides.dart
      home_controller.dart
      item_detail.dart
    main.dart
pubspec.yaml
```
* pubspec.yaml
```yaml
name: je_veux
description: A new Flutter application.

publish_to: 'none' # Remove this line if you wish to publish to pub.dev

version: 1.0.0+1

environment:
  sdk: ">=2.7.0 <3.0.0"

dependencies:
  flutter:
    sdk: flutter
  sqflite: # sqlite
  path_provider: # acc√©der √† des chemins dans mon appli
  image_picker: ^0.6.0+9 # acc√©der aux images du t√©l√©phone

  cupertino_icons: ^0.1.3

dev_dependencies:
  flutter_test:
    sdk: flutter

# The following section is specific to Flutter.
flutter:
  uses-material-design: true

  # To add assets to your application, add an assets section, like this:
  assets:
    - images/no_image.jpg
```
* main.dart
```java
import 'package:je_veux/widget/home_controller.dart';

void main() => runApp(new MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return new MaterialApp(
      debugShowCheckedModeBanner: false,
      title: 'Flutter Demo',
      theme: new ThemeData(
        primarySwatch: Colors.red,
      ),
      home: new HomeController(title: 'Je veux...'),
    );
  }
}
```
* home_controller.dart
```java
import 'package:flutter/material.dart';
import 'dart:async';
import 'package:je_veux/model/item.dart';
import 'package:je_veux/widget/donnees_vides.dart';
import 'package:je_veux/model/databaseClient.dart';
import 'item_detail.dart';

class HomeController extends StatefulWidget {
  HomeController({Key key, this.title}) : super(key: key);
  final String title;

  @override
  _HomeControllerState createState() => _HomeControllerState();
}

class _HomeControllerState extends State<HomeController> {

  // ‚Üì cat√©gorie d'une liste, qui comprendra plusieurs articles
  // (ex. Jeux, Chaussures, etc.)
  String newItem;
  List<Item> items; // toutes les cat√©gories

  @override
  void initState() {
    // TODO: implement initState
    super.initState();
    recuperer();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
        appBar: AppBar(
          title: Text(widget.title),
          actions: <Widget>[
            FlatButton(
                onPressed: (() => ajouter(null)), 
                child: Text("Ajouter", style: TextStyle(color: Colors.white),)
            ),
          ],
        ),
        body: (items == null||items.length == 0)
            ? DonneesVides()
            : ListView.builder(
            itemCount: items.length,
            itemBuilder: (context, i) {
              Item item = items[i];
              return ListTile(
                title: Text(item.nom),
                trailing: IconButton(
                    icon: Icon(Icons.delete),
                    onPressed: () {
                      DatabaseClient().delete(item.id, 'item').then((int) {
                        recuperer();
                      });
                    }),
                leading: IconButton(icon: Icon(Icons.edit), onPressed: (() => ajouter(item))),
                // ‚Üì appui sur le ListTile de l'item => ouvre sa page en d√©tails
                onTap: () {
                  Navigator.push(context, MaterialPageRoute(builder: (BuildContext buildContext) {
                    return ItemDetail(item);
                  }));
                },
              );
            }
        )

    );
  }

  Future<Null> ajouter(Item item) async {
    await showDialog(
        context: context,
        barrierDismissible: false,
        builder: (BuildContext buildContext) {
          return AlertDialog(
            title: Text('Ajouter une liste de souhaits'),
            content: TextField(
              decoration: InputDecoration(
                labelText: "liste:",
                // ‚Üì sorte de placeholder
                hintText: (item == null)? "ex: mes prochains jeux vid√©os": item.nom,
              ),
              // ‚Üì r√©ponse de l'utilisateur
              onChanged: (String answer) {
                newItem = answer;
              },
            ),
            actions: <Widget>[
              // ‚Üì BOUTON ANNULER
              FlatButton(onPressed: (() => Navigator.pop(buildContext)), child: Text('Annuler')),
              // ‚Üì BOUTON VALIDER
              FlatButton(onPressed: () {
                // Ajouter le code pour pouvoir ajouter √† la BDD
                if (newItem != null) {
                  // ‚Üì simple ajout
                  if (item == null) {
                    item = Item();
                    Map<String, dynamic> map = {'nom': newItem};
                    item.fromMap(map);
                  } else {
                    item.nom = newItem;
                  }
                  // ‚Üì UPDATE le nom de l'item sauvegard√© en base
                  DatabaseClient().upsertItem(item).then((i) => recuperer());
                  newItem = null;
                }
                Navigator.pop(buildContext);
              }, child: Text('Valider', style: TextStyle(color: Colors.blue),))
            ],
          );
        }
    );
  }

  void recuperer() {
    DatabaseClient().allItem().then((items) {
      setState(() {
        this.items = items;
      });
    });
  }
}
```
* donnees_vides.dart
```java
import 'package:flutter/material.dart';

class DonneesVides extends StatelessWidget {

  @override
  Widget build(BuildContext context) {
    // TODO: implement build
    return new Center(
      child: new Text("Aucune donn√©e n'est pr√©sente",
        textScaleFactor: 2.5,
        textAlign: TextAlign.center,
        style: new TextStyle(
            color: Colors.red,
            fontStyle: FontStyle.italic
        ),
      ),
    );
  }
}
```
* item_detail.dart
```java
import 'package:flutter/material.dart';
import 'package:je_veux/model/item.dart';
import 'package:je_veux/model/article.dart';
import 'donnees_vides.dart';
import 'ajout_article.dart';
import 'package:je_veux/model/databaseClient.dart';
import 'dart:io';

class ItemDetail extends StatefulWidget {
  Item item;

  ItemDetail(this.item);

  @override
  _ItemDetailState createState() => _ItemDetailState();

}

class _ItemDetailState extends State<ItemDetail> {
  List<Article> articles;

  @override
  void initState() {
    super.initState();
    // ‚Üì r√©cup√®re la liste d'articles enregistr√©s en BDD
    // en renseignant l'id de l'item renseign√© dans le StatefulWidget
    DatabaseClient().allArticles(widget.item.id).then((liste) {
      setState(() {
        articles = liste;
      });
    });
  }

  @override
  Widget build(BuildContext context) {
    // TODO: implement build
    return Scaffold(
        appBar: AppBar(
          title: Text(widget.item.nom),
          actions: <Widget>[
            FlatButton(
              child: Text('ajouter', style: TextStyle(color: Colors.white),),
              onPressed: () {
              Navigator.push(context, MaterialPageRoute(builder: (BuildContext context) {
                // ‚Üì id de l'item s√©lectionn√©
                // renvoie vers la page d'ajout d'un article associ√© √† l'item
                return Ajout(widget.item.id);
                // push = fonction asynchrone par d√©finition
                // les changements sont donc pris en compte, mais plus tard
                // solution = then((value)) { affichage du r√©sultat }
              })).then((value) {
                print('On est de retour, avec les articles mis √† jour');
                DatabaseClient().allArticles(widget.item.id).then((liste) {
                  setState(() {
                    articles = liste;
                  });
                });
              });
              },
            )
          ],
        ),
        body: (articles == null || articles.length == 0)
            ? DonneesVides()
            : GridView.builder(
            itemCount: articles.length,
            gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(crossAxisCount: 1),
            itemBuilder: (context, i) {
              Article article = articles[i];
              return Card(
                child: Column(
                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                  children: <Widget>[
                    Text(article.nom, textScaleFactor: 1.4,),
                    Container(
                      height: MediaQuery.of(context).size.height / 2.5,
                      // ‚Üì affichage conditionnel de l'image de l'article
                      child: (article.image == null)
                          ? Image.asset('images/no_image.jpg')
                          : Image.file(File(article.image)),
                    ),

                    Text((article.prix == null)? 'Aucun prix renseign√©': "Prix: ${article.prix}"),
                    Text((article.magasin == null)? 'Aucun magasin renseign√©': "Magasin: ${article.magasin}")
                  ],
                ),
              );
            })
    );
  }

}
```
* ajout_article.dart
```java
import 'dart:async';

import 'package:flutter/material.dart';
import 'dart:io';
import 'package:je_veux/model/article.dart';
import 'package:je_veux/model/databaseClient.dart';
import 'package:image_picker/image_picker.dart';

class Ajout extends StatefulWidget {

  int id;

  Ajout(this.id);

  @override
  _AjoutState createState() => _AjoutState();

}

class _AjoutState extends State<Ajout> {

  String image;
  String nom;
  String magasin;
  String prix;

  @override
  Widget build(BuildContext context) {
    // TODO: implement build
    return Scaffold(
      appBar: AppBar(
        // ‚Üì BOUTON AJOUT du formulaire
        title: Text('Ajouter'),
        actions: <Widget>[
          // ajouter() g√®re la logique du form
          FlatButton(onPressed: ajouter, child: Text('Valider', style: TextStyle(color: Colors.white),))
        ],
      ),
      body: SingleChildScrollView(
        padding: EdgeInsets.all(20.0),
        child: Column(
            children: <Widget>[
              Text('Article √† ajouter', textScaleFactor: 1.4, style: TextStyle(color: Colors.red, fontStyle: FontStyle.italic),),
              Card(
                elevation: 10.0,
                child: Column(
                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                  children: <Widget>[
                    (image == null)
                        ? Image.asset('images/no_image.jpg')
                        : Image.file(new File(image)),
                    Row(
                      mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                      children: <Widget>[
                        IconButton(icon: Icon(Icons.camera_enhance),
                            // ‚Üì ImageSource = renseigne la source de la photo √† r√©cup√©rer
                            onPressed: (() => getImage(ImageSource.camera))
                            // ‚Üë .camera => ouvre la camera
                        ),
                        IconButton(icon: Icon(Icons.photo_library),
                            // ‚Üì ImageSource = renseigne la source de la photo √† r√©cup√©rer
                            onPressed: (() => getImage(ImageSource.gallery))
                            // ‚Üë .gallery => ouvre la gallerie de l'utilisateur
                        )
                      ],
                    ),
                    textField(TypeTextField.nom, 'Nom de l\'article'),
                    textField(TypeTextField.prix, 'Prix'),
                    textField(TypeTextField.magasin, 'Magasin')
                  ],
                ),
              )
            ]

        ),
      ),
    );
  }

  TextField textField(TypeTextField type, String label) {
    return TextField(
      decoration: InputDecoration(labelText: label),
      onChanged: (String string) {
        switch (type) {
          case TypeTextField.nom:
            nom = string;
            break;
          case TypeTextField.prix:
            prix = string;
            break;
          case TypeTextField.magasin:
            magasin = string;
            break;
        }
      },
    );
  }

  void ajouter() {
    print('Ajouter un article');
    if (nom != null) {
      Map<String, dynamic> map = {'nom': nom, 'item': widget.id};
      if (magasin != null) {
        map['magasin'] = magasin;
      }
      if (prix != null) {
        map['prix'] = prix;
      }
      if (image != null) {
        map['image'] = image;
      }
      Article article = Article();
      article.fromMap(map); // on cr√©e notre objet √† partir d'une map
      // on envoie notre objet sur la BDD
      DatabaseClient().upsertArticle(article).then((value) {
        // d√®s que le processus renvoie une valeur
        // on efface toutes les propri√©t√©s enregistr√©es
        image = null;
        nom = null;
        magasin = null;
        prix = null;
        Navigator.pop(context);
      });
    }
  }

  // get image with image picker
  Future getImage(ImageSource source) async {
    var nouvelleIMage = await ImagePicker.pickImage(source: source);
    setState(() {
      image = nouvelleIMage.path;
    });
  }

}

enum TypeTextField {nom, prix, magasin}
```
* article.dart
```java
class Article {

  int id;
  String nom;
  int item;
  var prix;
  String magasin;
  String image;

  Article();

  // ‚Üì on r√©cup√®re de la BDD
  void fromMap(Map<String, dynamic> map) {
    this.id = map['id'];
    this.nom = map['nom'];
    this.item = map['item'];
    this.prix = map['prix'];
    this.magasin = map['magasin'];
    this.image = map['image'];
  }

  // ‚Üì convertit l'objet Article en map pour l'envoyer en BDD
  Map<String, dynamic> toMap() {
    Map<String, dynamic> map = {
      'nom': this.nom,
      'item': this.item,
      'magasin': this.magasin,
      'prix': this.prix,
      'image': this.image
    };

    // si l'article a d√©j√† √©t√© persist√© dans la BDD
    if (id != null) {
      map['id'] = this.id;
    }
    return map;
  }
}
```
* item.dart
```java
class Item {

  int id;
  String nom;

  Item();

  // ‚Üì on r√©cup√®re de la BDD
  void fromMap(Map<String, dynamic> map) {
    this.id = map['id'];
    this.nom = map['nom'];
  }

  // ‚Üì convertit l'objet Item en map pour l'envoyer en BDD
  Map<String, dynamic> toMap() {
    Map<String, dynamic> map = {
      'nom': this.nom
    };
    // si on a un id
    if (id != null) {
      map['id'] = this.id;
    }
    return map;
  }

}
```
* databaseClient.dart
```java
// classe de la BDD
import 'dart:async';
import 'dart:io';
import 'package:je_veux/model/item.dart';
import 'package:sqflite/sqflite.dart'; // SQLITE
import 'package:path/path.dart'; // r√©cup√©rer nos chemins
import 'package:path_provider/path_provider.dart';
import 'article.dart';

class DatabaseClient {

  Database _database;

  // Getter de _database
  Future<Database> get database async {
    if (_database != null) {
      return _database;
    } else {
      print("LA BDD n'a pas √©t√© cr√©e");
      // ‚Üì Cr√©ation de la BDD
      _database = await create();
      return _database;
    }
  }

  // cr√©ation de la BDD
  Future create() async {
    // ‚Üì chemin du dossier de mes documents
    Directory directory = await getApplicationDocumentsDirectory();
    // ‚Üì cr√©ation d'un chemin pour la BDD
    String database_directory = join(directory.path, 'database.db');
    // ‚Üì opening a database
    var bdd = await openDatabase(database_directory, version: 1, onCreate: _onCreate);
    return bdd;
  }

  // cr√©ation de la table item et article pour la BDD
  Future _onCreate(Database db, int version) async {
    // cr√©ation table item
    await db.execute('''
    CREATE TABLE item (
    id INTEGER PRIMARY KEY, 
    nom TEXT NOT NULL )
    '''
    );

    // cr√©ation table article
    await db.execute('''
     CREATE TABLE article (
     id INTEGER PRIMARY KEY,
     nom TEXT NOT NULL,
     item INTEGER,
     prix TEXT,
     magasin TEXT,
     image TEXT )
     '''
    );
  }

  /* ECRITURE DES DONNEES */

  // INSERT INTO
  Future<Item> ajoutItem(Item item) async {
    // ‚Üì appelle le getter de _database
    Database maDatabase = await database;
    // INSERT INTO TABLE item
    // insert renvoie un Future<int>
    item.id = await maDatabase.insert('item', item.toMap());
    return item;
  }

  // UPDATE
  Future<int> updateItem(Item item) async {
    Database maDatabase = await database;
    return maDatabase.update('item', item.toMap(), where: 'id = ?', whereArgs: [item.id]);
  }

  // UPDATE OR INSERT
  Future<Item> upsertItem(Item item) async {
    Database maDatabase = await database;
    if (item.id == null) {
      item.id = await maDatabase.insert('item', item.toMap());
    } else {
      await maDatabase.update('item', item.toMap(), where: 'id = ?', whereArgs: [item.id]);
    }
    return item;
  }

  Future<Article> upsertArticle(Article article) async {
    Database maDatabase = await database;
    // si l'article n'a pas d'id, il n'a jamais √©t√© persist√© en BDD
    (article.id == null)
        // INSERT INTO renvoie un id
        // toMap pour le transformer en map pour l'envoyer en BDD
        ? article.id = await maDatabase.insert('article', article.toMap())
        // sinon, UPDATE
        : await maDatabase.update('article', article.toMap(), where: 'id = ?', whereArgs: [article.id]);
    return article;
  }

  // DELETE
  Future<int> delete(int id, String table) async {
    Database maDatabase = await database;
    // ‚Üì supprime l'ensemble des articles li√©s √† une item
    await maDatabase.delete('article', where: 'item = ?', whereArgs: [id]);
    // ‚Üì puis supprime l'item (DELETE ON CASCADE sans contrainte ON DELETE CASCADE)
    return await maDatabase.delete(table, where: 'id = ?', whereArgs: [id]);
  }


/* LECTURE DES DONNEES */

  // SELECT *
  Future<List<Item>> allItem() async {
    Database maDatabase = await database;
    // ‚Üì QUERY
    List<Map<String, dynamic>> resultat = await maDatabase.rawQuery('SELECT * FROM item');
    List<Item> items =[];
    resultat.forEach((map) {
      Item item = new Item();
      // ‚Üì enregistre l'objet grace aux infos de la BDD
      item.fromMap(map);
      items.add(item);
    });
    return items;
  }

  // SELECT * WHERE ITEM = int
  Future<List<Article>> allArticles(int item) async {
    // appel BDD
    Database maDatabase = await database;
    // r√©cup√©ration des √©l√©ments de la query
    List<Map<String, dynamic>> resultat = await maDatabase.query(
        'article',
        where: 'item = ?',
        whereArgs: [item]
    );
    // cr√©ation d'un liste d'articles
    List<Article> articles = [];
    // remplissage de la liste d'articles
    resultat.forEach((map) {
      Article article = Article();
      article.fromMap(map);
      articles.add(article);
    });
    return articles;
  }

}
```
## BOOTCAMP BMI CALCULATOR
* Application de calcul de Body Mass Index
* Une page formulaire, une page r√©sultat
* Structure :
```py
BMI-calculator/
  lib/
    components/
      bottom_button.dart
      icon_content.dart
      reusable_card.dart
      round_icon_button.dart
    screens/
      input_page.dart
      results_page.dart
  calculator_brain.dart # calculateur
  constants.dart # r√©pertorie toutes les constantes de l'appli
  main.dart
pubspec.yaml
```
* pubspec.yaml
```yaml
name: bmi_calculator
description: A new Flutter application.

version: 1.0.0+1

environment:
  sdk: ">=2.1.0 <3.0.0"

dependencies:
  flutter:
    sdk: flutter

  cupertino_icons: ^0.1.2
  font_awesome_flutter: ^8.4.0 # ++

dev_dependencies:
  flutter_test:
    sdk: flutter

flutter:
  uses-material-design: true
```
* main.dart
```java
// page pour les pr√©f√©rences, le th√®me, ect.

import 'package:flutter/material.dart';
import 'package:bmi_calculator/screens/input_page.dart';

void main() => runApp(BMICalculator());

class BMICalculator extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      theme: ThemeData.dark().copyWith(
        primaryColor: Color(0xFF0A0E21),
        scaffoldBackgroundColor: Color(0xFF0A0E21),
      ),
      home: InputPage(),
    );
  }
}
```
* constants.dart
```java
import 'package:flutter/material.dart';

// r√®gle = kCamelCaseQuiCommenceAvecUnK
const kBottomContainerHeight = 80.0;
const kActiveCardColour = Color(0xFF1D1E33);
const kInactiveCardColour = Color(0xFF111328);
const kBottomContainerColour = Color(0xFFEB1555);

const kLabelTextStyle = TextStyle(
  fontSize: 18.0,
  color: Color(0xFF8D8E98),
);

const kNumberTextStyle = TextStyle(
  fontSize: 50.0,
  fontWeight: FontWeight.w900,
);

const kLargeButtonTextStyle = TextStyle(
  fontSize: 25.0,
  fontWeight: FontWeight.bold,
);

const kTitleTextStyle = TextStyle(
  fontSize: 50.0,
  fontWeight: FontWeight.bold,
);

const kResultTextStyle = TextStyle(
  color: Color(0xFF24D876),
  fontSize: 22.0,
  fontWeight: FontWeight.bold,
);

const kBMITextStyle = TextStyle(
  fontSize: 100.0,
  fontWeight: FontWeight.bold,
);

const kBodyTextStyle = TextStyle(
  fontSize: 22.0,
);
```
* calculator_brain.dart
```java
import 'dart:math';

class CalculatorBrain {
  CalculatorBrain({this.height, this.weight});

  final int height;
  final int weight;

  double _bmi;

  String calculateBMI() {
                  // ‚Üì (height / 100) * 2
    _bmi = weight / pow(height / 100, 2);
    // ‚Üì string => double avec 1 chiffre apr√®s la virgule
    return _bmi.toStringAsFixed(1);
  }

  String getResult() {
    if (_bmi >= 25) {
      return 'Overweight';
    } else if (_bmi > 18.5) {
      return 'Normal';
    } else {
      return 'Underweight';
    }
  }

  String getInterpretation() {
    if (_bmi >= 25) {
      return 'You have a higher than normal body weight. Try to exercise more.';
    } else if (_bmi >= 18.5) {
      return 'You have a normal body weight. Good job!';
    } else {
      return 'You have a lower than normal body weight. You can eat a bit more.';
    }
  }
}
```
* lib/screens/input_page.dart
```java
import 'package:flutter/material.dart';
import 'package:font_awesome_flutter/font_awesome_flutter.dart';
import 'package:bmi_calculator/components/icon_content.dart';
import 'package:bmi_calculator/components/reusable_card.dart';
import 'package:bmi_calculator/constants.dart';
import 'package:bmi_calculator/screens/results_page.dart';
import 'package:bmi_calculator/components/bottom_button.dart';
import 'package:bmi_calculator/components/round_icon_button.dart';
import 'package:bmi_calculator/calculator_brain.dart';

enum Gender {
  male,
  female,
}

class InputPage extends StatefulWidget {
  @override
  _InputPageState createState() => _InputPageState();
}

class _InputPageState extends State<InputPage> {
  Gender selectedGender;
  int height = 180;
  int weight = 60;
  int age = 20;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('BMI CALCULATOR'),
      ),
      body: Column(
        crossAxisAlignment: CrossAxisAlignment.stretch,
        children: <Widget>[
          Expanded(
              child: Row(
            children: <Widget>[
              Expanded(
                child: ReusableCard(
                  onPress: () {
                    setState(() {
                      selectedGender = Gender.male;
                    });
                  },
                  colour: selectedGender == Gender.male
                      ? kActiveCardColour
                      : kInactiveCardColour,
                  cardChild: IconContent(
                    icon: FontAwesomeIcons.mars,
                    label: 'MALE',
                  ),
                ),
              ),
              Expanded(
                child: ReusableCard(
                  onPress: () {
                    setState(() {
                      selectedGender = Gender.female;
                    });
                  },
                  colour: selectedGender == Gender.female
                      ? kActiveCardColour
                      : kInactiveCardColour,
                  cardChild: IconContent(
                    icon: FontAwesomeIcons.venus,
                    label: 'FEMALE',
                  ),
                ),
              ),
            ],
          )),
          Expanded(
            child: ReusableCard(
              colour: kActiveCardColour,
              cardChild: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: <Widget>[
                  Text(
                    'HEIGHT',
                    style: kLabelTextStyle,
                  ),
                  Row(
                    mainAxisAlignment: MainAxisAlignment.center,
                    crossAxisAlignment: CrossAxisAlignment.baseline,
                    textBaseline: TextBaseline.alphabetic,
                    children: <Widget>[
                      Text(
                        height.toString(),
                        style: kNumberTextStyle,
                      ),
                      Text(
                        'cm',
                        style: kLabelTextStyle,
                      )
                    ],
                  ),
                  SliderTheme(
                    // copie de l'affichage par d√©faut ‚Üì
                    data: SliderTheme.of(context).copyWith(
                      inactiveTrackColor: Color(0xFF8D8E98),
                      activeTrackColor: Colors.white,
                      thumbColor: Color(0xFFEB1555),
                      // ‚Üì 0x29 : transparence de 16%
                      overlayColor: Color(0x29EB1555),
                      thumbShape:
                          RoundSliderThumbShape(enabledThumbRadius: 15.0),
                      overlayShape:
                          RoundSliderOverlayShape(overlayRadius: 30.0),
                    ),
                    child: Slider(
                      value: height.toDouble(),
                      min: 120.0,
                      max: 220.0,
                      onChanged: (double newValue) {
                        setState(() {
                          height = newValue.round();
                        });
                      },
                    ),
                  ),
                ],
              ),
            ),
          ),
          Expanded(
            child: Row(
              children: <Widget>[
                Expanded(
                  child: ReusableCard(
                    colour: kActiveCardColour,
                    cardChild: Column(
                      mainAxisAlignment: MainAxisAlignment.center,
                      children: <Widget>[
                        Text(
                          'WEIGHT',
                          style: kLabelTextStyle,
                        ),
                        Text(
                          weight.toString(),
                          style: kNumberTextStyle,
                        ),
                        Row(
                          mainAxisAlignment: MainAxisAlignment.center,
                          children: <Widget>[
                            RoundIconButton(
                                icon: FontAwesomeIcons.minus,
                                onPressed: () {
                                  setState(() {
                                    weight--;
                                  });
                                }),
                            SizedBox(
                              width: 10.0,
                            ),
                            RoundIconButton(
                              icon: FontAwesomeIcons.plus,
                              onPressed: () {
                                setState(() {
                                  weight++;
                                });
                              },
                            ),
                          ],
                        ),
                      ],
                    ),
                  ),
                ),
                Expanded(
                  child: ReusableCard(
                    colour: kActiveCardColour,
                    cardChild: Column(
                      mainAxisAlignment: MainAxisAlignment.center,
                      children: <Widget>[
                        Text(
                          'AGE',
                          style: kLabelTextStyle,
                        ),
                        Text(
                          age.toString(),
                          style: kNumberTextStyle,
                        ),
                        Row(
                          mainAxisAlignment: MainAxisAlignment.center,
                          children: <Widget>[
                            RoundIconButton(
                              icon: FontAwesomeIcons.minus,
                              onPressed: () {
                                setState(
                                  () {
                                    age--;
                                  },
                                );
                              },
                            ),
                            SizedBox(
                              width: 10.0,
                            ),
                            RoundIconButton(
                                icon: FontAwesomeIcons.plus,
                                onPressed: () {
                                  setState(() {
                                    age++;
                                  });
                                })
                          ],
                        )
                      ],
                    ),
                  ),
                ),
              ],
            ),
          ),
          BottomButton(
            buttonTitle: 'CALCULATE',
            onTap: () {
              CalculatorBrain calc =
                  CalculatorBrain(height: height, weight: weight);

              Navigator.push(
                context,
                MaterialPageRoute(
                  // passage d'arguments √† la route
                  builder: (context) => ResultsPage(
                        bmiResult: calc.calculateBMI(),
                        resultText: calc.getResult(),
                        interpretation: calc.getInterpretation(),
                      ),
                ),
              );
            },
          ),
        ],
      ),
    );
  }
}
```
* lib/screens/results_page.dart
```java
import 'package:flutter/material.dart';
import 'package:bmi_calculator/constants.dart';
import 'package:bmi_calculator/components/reusable_card.dart';
import 'package:bmi_calculator/components/bottom_button.dart';

class ResultsPage extends StatelessWidget {
  ResultsPage(
      {@required this.interpretation,
      @required this.bmiResult,
      @required this.resultText});

  final String bmiResult;
  final String resultText;
  final String interpretation;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('BMI CALCULATOR'),
      ),
      body: Column(
        mainAxisAlignment: MainAxisAlignment.spaceEvenly,
        crossAxisAlignment: CrossAxisAlignment.stretch,
        children: <Widget>[
          Expanded(
            child: Container(
              padding: EdgeInsets.all(15.0),
              alignment: Alignment.bottomLeft,
              child: Text(
                'Your Result',
                style: kTitleTextStyle,
              ),
            ),
          ),
          Expanded(
            flex: 5,
            child: ReusableCard(
              colour: kActiveCardColour,
              cardChild: Column(
                mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                crossAxisAlignment: CrossAxisAlignment.center,
                children: <Widget>[
                  Text(
                    resultText.toUpperCase(),
                    style: kResultTextStyle,
                  ),
                  Text(
                    bmiResult,
                    style: kBMITextStyle,
                  ),
                  Text(
                    interpretation,
                    textAlign: TextAlign.center,
                    style: kBodyTextStyle,
                  ),
                ],
              ),
            ),
          ),
          BottomButton(
            buttonTitle: 'RE-CALCULATE',
            onTap: () {
              Navigator.pop(context);
            },
          )
        ],
      ),
    );
  }
}
```
* lib/components/bottom_button.dart
```java
import 'package:flutter/material.dart';
import 'package:bmi_calculator/constants.dart';

class BottomButton extends StatelessWidget {
  BottomButton({@required this.onTap, @required this.buttonTitle});

  final Function onTap;
  final String buttonTitle;

  @override
  Widget build(BuildContext context) {
    // ‚Üì permet d'ajouter de l'int√©ractivit√© √† un Container
    return GestureDetector(
      onTap: onTap,
      child: Container(
        child: Center(
          child: Text(
            buttonTitle,
            style: kLargeButtonTextStyle,
          ),
        ),
        color: kBottomContainerColour,
        margin: EdgeInsets.only(top: 10.0),
        padding: EdgeInsets.only(bottom: 20.0),
        width: double.infinity,
        height: kBottomContainerHeight,
      ),
    );
  }
}
```
* lib/components/icon_content.dart
```java
import 'package:flutter/material.dart';
import 'package:bmi_calculator/constants.dart';

class IconContent extends StatelessWidget {
  IconContent({this.icon, this.label});

  final IconData icon;
  final String label;

  @override
  Widget build(BuildContext context) {
    return Column(
      mainAxisAlignment: MainAxisAlignment.center,
      children: <Widget>[
        Icon(
          icon,
          size: 80.0,
        ),
        SizedBox(
          height: 15.0,
        ),
        Text(
          label,
          style: kLabelTextStyle,
        )
      ],
    );
  }
}
```
* lib/components/reusable_card.dart
```java
import 'package:flutter/material.dart';

class ReusableCard extends StatelessWidget {
  ReusableCard({@required this.colour, this.cardChild, this.onPress});

  final Color colour;
  final Widget cardChild;
  final Function onPress;

  @override
  Widget build(BuildContext context) {
    return GestureDetector(
      onTap: onPress,
      child: Container(
        child: cardChild,
        margin: EdgeInsets.all(15.0),
        decoration: BoxDecoration(
          color: colour,
          borderRadius: BorderRadius.circular(10.0),
        ),
      ),
    );
  }
}
```
* lib/components/round_icon_button.dart
```java
import 'package:flutter/material.dart';

class RoundIconButton extends StatelessWidget {
  RoundIconButton({@required this.icon, @required this.onPressed});

  final IconData icon;
  final Function onPressed; // ajout d'une fonction aux propri√©t√©s

  @override
  Widget build(BuildContext context) {
    return RawMaterialButton(
      elevation: 0.0,
      child: Icon(icon),
      onPressed: onPressed,
      constraints: BoxConstraints.tightFor(
        width: 56.0,
        height: 56.0,
      ),
      shape: CircleBorder(),
      fillColor: Color(0xFF4C4F5E),
    );
  }
}
```

## BOOTCAMP CLIMA API
* Application de m√©t√©o r√©cup√©rant les donn√©es d'une API
* Une page formulaire, une page r√©sultat
* Structure :
```py
Clima-Flutter-Completed/
  fonts/
    SpartanMB-Black.otf
  images/
    city_background.jpg
    location_background.jpg
  lib/
    screens/
      city_screen.dart
      loading_screen.dart
      location_screen.dart
    services/
      location.dart
      networking.dart # appel externe (API)
      weather.dart
    utilities/
      constants.dart
  main.dart
pubspec.yaml
```
* pubspec.yaml
```yaml
name: clima
description: A new Flutter application.

version: 1.0.0+1

environment:
  sdk: ">=2.1.0 <3.0.0"

dependencies:
  flutter:
    sdk: flutter

  cupertino_icons: ^0.1.2
  geolocator: ^3.0.1
  http: ^0.12.0+2
  flutter_spinkit: ^3.1.0 # for the spinner

dev_dependencies:
  flutter_test:
    sdk: flutter

flutter:
  uses-material-design: true

  assets:
  - images/

  fonts:
  - family: Spartan MB
    fonts:
    - asset: fonts/SpartanMB-Black.otf
      weight: 900
```
* main.dart
```java
import 'package:flutter/material.dart';
import 'package:clima/screens/loading_screen.dart';

void main() => runApp(MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      theme: ThemeData.dark(),
      home: LoadingScreen(),
    );
  }
}
```
* scratch.dart
```java
// fichier qui teste du code asynchrone
import 'dart:io';

void main() {
  performTasks();
}

void performTasks() async {
  task1();
  // ‚Üë m√©thode synchrone qui sera ex√©cut√©e instantan√©ment
  String task2Result = await task2();
  // ‚Üë la variable task2Result attendra la compl√©tion de task2()
  // pour avoir une valeur
  // et passer √† la ligne suivante
  // task2 = pour l'instant Instance of 'Future<String>'
  // elle deviendra un String une fois task2() compl√©t√©e
  task3(task2Result);
  // gr√¢ce au temps d'attente, task3 peut recevoir une variable non nulle
}

void task1() {
  String result = 'task 1 data';
  print('Task 1 complete');
}

Future<String> task2() async {
  Duration threeSeconds = Duration(seconds: 3);

  String result;

  await Future.delayed(threeSeconds, () {
    result = 'task 2 data';
    print('Task 2 complete');
  });

  return result;
}

void task3(String task2Data) {
  String result = 'task 3 data';
  print('Task 3 complete with $task2Data');
}

// console :
// Task 1 complete
// 3 secondes s'√©coulent...
// Task 2 complete
// Task 3 complete with task 2 data (en m√™me temps que Task2)
```
* utilities/constants.dart
```java
import 'package:flutter/material.dart';

const kTempTextStyle = TextStyle(
  fontFamily: 'Spartan MB',
  fontSize: 100.0,
);

const kMessageTextStyle = TextStyle(
  fontFamily: 'Spartan MB',
  fontSize: 60.0,
);

const kButtonTextStyle = TextStyle(
  fontSize: 30.0,
  fontFamily: 'Spartan MB',
);

const kConditionTextStyle = TextStyle(
  fontSize: 100.0,
);

// InputDecoration of TextField
const kTextFieldInputDecoration = InputDecoration(
  filled: true,
  fillColor: Colors.white,
  icon: Icon(
    Icons.location_city,
    color: Colors.white,
  ),
  hintText: 'Enter City Name',
  hintStyle: TextStyle(
    color: Colors.grey,
  ),
  border: OutlineInputBorder(
    borderRadius: BorderRadius.all(
      Radius.circular(10.0),
    ),
    borderSide: BorderSide.none,
  ),
);
```
* screens/loading_screen.dart
```java
import 'package:flutter/material.dart';
import 'location_screen.dart';
import 'package:flutter_spinkit/flutter_spinkit.dart';
import 'package:clima/services/weather.dart';

class LoadingScreen extends StatefulWidget {
  @override
  State<StatefulWidget> createState() {
    return _LoadingScreenState();
  }
}

class _LoadingScreenState extends State<LoadingScreen> {
  @override
  void initState() {
    super.initState();
    getLocationData();
  }

  // m√©thode asynchrone (suffixe async et pr√©fixe await dans son body)
  void getLocationData() async {
    var weatherData = await WeatherModel().getLocationWeather();
    // await permet d'attendre pour ex√©cuter ce qui suit
    // par exemple, faire un print(weatherData)
    // si Future<dynamic> weatherData est utilis√©
    // alors print(weatherData) = instance of Future<dynamic>

    Navigator.push(context, MaterialPageRoute(builder: (context) {
      return LocationScreen(
        locationWeather: weatherData,
      );
    }));
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Center(
        // ‚Üì spinner for the waiting
        child: SpinKitDoubleBounce(
          color: Colors.white,
          size: 100.0,
        ),
      ),
    );
  }
}
```
* screens/location_screen.dart
```java
import 'package:flutter/material.dart';
import 'package:clima/utilities/constants.dart';
import 'package:clima/services/weather.dart';
import 'city_screen.dart';

class LocationScreen extends StatefulWidget {
  LocationScreen({this.locationWeather});
  // ‚Üì accessible dans le State avec widget.locationWeather
  final locationWeather;

  @override
  _LocationScreenState createState() => _LocationScreenState();
}

class _LocationScreenState extends State<LocationScreen> {
  WeatherModel weather = WeatherModel();
  int temperature;
  String weatherIcon;
  String cityName;
  String weatherMessage;

  @override
  void initState() {
    super.initState();

    updateUI(widget.locationWeather);
  }

  void updateUI(dynamic weatherData) {
    setState(() {
      // ‚Üì √©vite √† l'application de crasher
      if (weatherData == null) {
        temperature = 0;
        weatherIcon = 'Error';
        weatherMessage = 'Unable to get weather data';
        cityName = '';
        return; // permet de sortir de la fonction
      }
      double temp = weatherData['main']['temp'];
      temperature = temp.toInt();
      var condition = weatherData['weather'][0]['id'];
      weatherIcon = weather.getWeatherIcon(condition);
      weatherMessage = weather.getMessage(temperature);
      cityName = weatherData['name'];
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Container(
        decoration: BoxDecoration(
          image: DecorationImage(
            image: AssetImage('images/location_background.jpg'),
            fit: BoxFit.cover,
            colorFilter: ColorFilter.mode(
                Colors.white.withOpacity(0.8), BlendMode.dstATop),
          ),
        ),
        constraints: BoxConstraints.expand(),
        child: SafeArea( // Afficher le contenu dans la partie visible de l'√©cran
          child: Column(
            mainAxisAlignment: MainAxisAlignment.spaceBetween,
            crossAxisAlignment: CrossAxisAlignment.stretch,
            children: <Widget>[
              Row(
                mainAxisAlignment: MainAxisAlignment.spaceBetween,
                children: <Widget>[
                  FlatButton(
                    // ‚Üì MAJ de la localisation
                    onPressed: () async {
                      var weatherData = await weather.getLocationWeather();
                      updateUI(weatherData);
                    },
                    child: Icon(
                      Icons.near_me,
                      size: 50.0,
                    ),
                  ),
                  FlatButton(
                    onPressed: () async {
                      // ‚Üì r√©cup√®re la data de la page cityScreen
                      // quand elle revient en arri√®re (Navigator.pop)
                      var typedName = await Navigator.push(
                        context,
                        MaterialPageRoute(
                          builder: (context) {
                            return CityScreen();
                          },
                        ),
                      );
                      // si retour non vide
                      // on recherche le weather data by city name
                      if (typedName != null) {
                        var weatherData =
                            await weather.getCityWeather(typedName);
                        updateUI(weatherData);
                      }
                    },
                    child: Icon(
                      Icons.location_city,
                      size: 50.0,
                    ),
                  ),
                ],
              ),
              Padding(
                padding: EdgeInsets.only(left: 15.0),
                child: Row(
                  children: <Widget>[
                    Text(
                      '$temperature¬∞',
                      style: kTempTextStyle,
                    ),
                    Text(
                      weatherIcon,
                      style: kConditionTextStyle,
                    ),
                  ],
                ),
              ),
              Padding(
                padding: EdgeInsets.only(right: 15.0),
                child: Text(
                  '$weatherMessage in $cityName',
                  textAlign: TextAlign.right,
                  style: kMessageTextStyle,
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}
```
* screens/city_screen.dart
```java
import 'package:flutter/material.dart';
import 'package:clima/utilities/constants.dart';

class CityScreen extends StatefulWidget {
  @override
  _CityScreenState createState() => _CityScreenState();
}

class _CityScreenState extends State<CityScreen> {
  String cityName;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Container(
        decoration: BoxDecoration(
          image: DecorationImage(
            image: AssetImage('images/city_background.jpg'),
            fit: BoxFit.cover,
          ),
        ),
        constraints: BoxConstraints.expand(),
        child: SafeArea( // Afficher le contenu dans la partie visible de l'√©cran
          child: Column(
            children: <Widget>[
              Align(
                alignment: Alignment.topLeft,
                child: FlatButton(
                  onPressed: () {
                    Navigator.pop(context);
                  },
                  child: Icon(
                    Icons.arrow_back_ios,
                    size: 50.0,
                  ),
                ),
              ),
              Container(
                padding: EdgeInsets.all(20.0),
                child: TextField(
                  style: TextStyle(
                    color: Colors.black,
                  ),
                  decoration: kTextFieldInputDecoration,
                  onChanged: (value) {
                    cityName = value;
                  },
                ),
              ),
              FlatButton(
                onPressed: () {
                  // transmet la data dans la page pr√©c√©dente
                  Navigator.pop(context, cityName);
                },
                child: Text(
                  'Get Weather',
                  style: kButtonTextStyle,
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}
```
* services/location.dart
```java
import 'package:geolocator/geolocator.dart';

class Location {
  double latitude;
  double longitude;

  Future<void> getCurrentLocation() async {
    try {
      Position position = await Geolocator()
          .getCurrentPosition(desiredAccuracy: LocationAccuracy.low);
      // plus la localisation est pr√©cise (ex. LocationAccuracy.high)
      // plus elle demande des ressources
      // await permet ensuite d'assigner les diff√©rentes variables
      latitude = position.latitude;
      longitude = position.longitude;
    } catch (e) {
      print(e);
    }
  }
}
```
* services/networking.dart
```java
import 'package:http/http.dart' as http;
// on utilise l'alias http pour mieux
// expliciter d'o√π vient la m√©thode get
// et les √©l√©ments li√©s au package http
import 'dart:convert';

class NetworkHelper {
  NetworkHelper(this.url);

  final String url;

  Future getData() async {
    // http.get est plus explicte que get
    http.Response response = await http.get(url);

    if (response.statusCode == 200) {
      String data = response.body;
      // ‚Üì gr√¢ce au package convert
      // jsonDecode(data)['coord']['lon']
      // pour avoir la longitude
      // jsonDecode(data)['weather'][0]['description']
      // pour avoir la description du temps, qui est encapsul√© dans une liste
      // 'weather': [{'description' : XXX, ...}]
      return jsonDecode(data);
    } else {
      print(response.statusCode);
    }
  }
}
```
* services/weather.dart
```java
import 'package:clima/services/location.dart';
import 'package:clima/services/networking.dart';

//TODO: use your own key !
const apiKey = 'e72ca729af228beabd5d20e3b7749713';
const openWeatherMapURL = 'https://api.openweathermap.org/data/2.5/weather';

class WeatherModel {
  Future<dynamic> getCityWeather(String cityName) async {
    NetworkHelper networkHelper = NetworkHelper(
        '$openWeatherMapURL?q=$cityName&appid=$apiKey&units=metric');

    var weatherData = await networkHelper.getData();
    return weatherData;
  }

  // Future car le retour d√©pend de plusieurs await
  // dynamic = le type de weatherData
  Future<dynamic> getLocationWeather() async {
    Location location = Location();
    await location.getCurrentLocation();

    NetworkHelper networkHelper = NetworkHelper(
        '$openWeatherMapURL?lat=${location.latitude}&lon=${location.longitude}&appid=$apiKey&units=metric');

    var weatherData = await networkHelper.getData();
    return weatherData;
  }

  String getWeatherIcon(int condition) {
    if (condition < 300) {
      return 'üå©';
    } else if (condition < 400) {
      return 'üåß';
    } else if (condition < 600) {
      return '‚òîÔ∏è';
    } else if (condition < 700) {
      return '‚òÉÔ∏è';
    } else if (condition < 800) {
      return 'üå´';
    } else if (condition == 800) {
      return '‚òÄÔ∏è';
    } else if (condition <= 804) {
      return '‚òÅÔ∏è';
    } else {
      return 'ü§∑‚Äç';
    }
  }

  String getMessage(int temp) {
    if (temp > 25) {
      return 'It\'s üç¶ time';
    } else if (temp > 20) {
      return 'Time for shorts and üëï';
    } else if (temp < 10) {
      return 'You\'ll need üß£ and üß§';
    } else {
      return 'Bring a üß• just in case';
    }
  }
}
```

## BOOTCAMP BITCOIN API
* Application de convertisseur de cyberdevise en devise (ex. bitcoin en euros) r√©cup√©rant les donn√©es d'une API
* Une page formulaire, une page de calcul
* Structure :
```py
bitcoin-flutter-final/
  lib/
    coin_data.dart
    main.dart
    price_screen.dart
pubspec.yaml
```
* pubspec.yaml
```yaml
name: bitcoin_ticker
description: A new Flutter application.
version: 1.0.0+1
environment:
  sdk: ">=2.1.0 <3.0.0"

dependencies:
  flutter:
    sdk: flutter

  cupertino_icons: ^0.1.2
  http: ^0.12.0+2

dev_dependencies:
  flutter_test:
    sdk: flutter
flutter:
  uses-material-design: true
```
* main.dart
```java
import 'package:flutter/material.dart';
import 'price_screen.dart';

void main() => runApp(MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      theme: ThemeData.dark().copyWith(
          primaryColor: Colors.lightBlue,
          scaffoldBackgroundColor: Colors.white),
      home: PriceScreen(),
    );
  }
}
```
* price_screen.dart
```java
import 'package:flutter/material.dart';
// ‚Üì cupertino package
import 'package:flutter/cupertino.dart';
import 'coin_data.dart';
// ‚Üì pour r√©cup√©rer les param√®tres (OS) de l'appli
// seulement la classe Platform
import 'dart:io' show Platform;

class PriceScreen extends StatefulWidget {
  @override
  _PriceScreenState createState() => _PriceScreenState();
}

class _PriceScreenState extends State<PriceScreen> {
  // Update the default currency to AUD, the first item in the currencyList.
  String selectedCurrency = 'AUD';

  DropdownButton<String> androidDropdown() {
    List<DropdownMenuItem<String>> dropdownItems = [];
    for (String currency in currenciesList) {
      var newItem = DropdownMenuItem(
        child: Text(currency),
        value: currency,
      );
      dropdownItems.add(newItem);
    }

    return DropdownButton<String>(
      value: selectedCurrency,
      items: dropdownItems,
      onChanged: (value) {
        setState(() {
          selectedCurrency = value;
          // Call getData() when the picker/dropdown changes.
          getData();
        });
      },
    );
  }

  CupertinoPicker iOSPicker() {
    List<Text> pickerItems = [];
    for (String currency in currenciesList) {
      pickerItems.add(Text(currency));
    }

    return CupertinoPicker(
      backgroundColor: Colors.lightBlue,
      itemExtent: 32.0,
      onSelectedItemChanged: (selectedIndex) {
        setState(() {
          // Save the selected currency to the property selectedCurrency
          selectedCurrency = currenciesList[selectedIndex];
          // Call getData() when the picker/dropdown changes.
          getData();
        });
      },
      children: pickerItems,
    );
  }

  // value had to be updated into a Map to store the values of all three cryptocurrencies
  Map<String, String> coinValues = {};
  // Figure out a way of displaying a '?' on screen while we're waiting for the price data to come back.
  // First we have to create a variable to keep track of when we're waiting on the request to complete.
  bool isWaiting = false;

  // Create an async method here await the coin data from coin_data.dart
  void getData() async {
    isWaiting = true;
    try {
      var data = await CoinData().getCoinData(selectedCurrency);
      isWaiting = false;
      // We can't await in a setState(). So you have to separate it out into two steps.
      setState(() {
        coinValues = data;
      });
    } catch (e) {
      print(e);
    }
  }

  @override
  void initState() {
    super.initState();
    // Call getData() when the screen loads up.
    // We can't call CoinData().getCoinData() directly here because
    // we can't make initState() async.
    getData();
  }

  // use a Column Widget to contain the three CryptoCards
  Column makeCards() {
    List<CryptoCard> cryptoCards = [];
    for (String crypto in cryptoList) {
      cryptoCards.add(
        CryptoCard(
          cryptoCurrency: crypto,
          selectedCurrency: selectedCurrency,
          // ternary operator to check if we are waiting and if so,
          // we'll display a '?' otherwise we'll show the actual price data.
          value: isWaiting ? '?' : coinValues[crypto],
        ),
      );
    }
    return Column(
      crossAxisAlignment: CrossAxisAlignment.stretch,
      children: cryptoCards,
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('ü§ë Coin Ticker'),
      ),
      body: Column(
        mainAxisAlignment: MainAxisAlignment.spaceBetween,
        crossAxisAlignment: CrossAxisAlignment.stretch,
        children: <Widget>[
          makeCards(),
          Container(
            height: 150.0,
            alignment: Alignment.center,
            padding: EdgeInsets.only(bottom: 30.0),
            color: Colors.lightBlue,
            // ‚Üì check platform
            child: Platform.isIOS ? iOSPicker() : androidDropdown(),
          ),
        ],
      ),
    );
  }
}

// Refactor this Padding Widget into a separate Stateless Widget called CryptoCard,
// so we can create 3 of them, one for each cryptocurrency.
class CryptoCard extends StatelessWidget {
  const CryptoCard({
    this.value,
    this.selectedCurrency,
    this.cryptoCurrency,
  });

  final String value;
  final String selectedCurrency;
  final String cryptoCurrency;

  @override
  Widget build(BuildContext context) {
    return Padding(
      padding: EdgeInsets.fromLTRB(18.0, 18.0, 18.0, 0),
      child: Card(
        color: Colors.lightBlueAccent,
        elevation: 5.0,
        shape: RoundedRectangleBorder(
          borderRadius: BorderRadius.circular(10.0),
        ),
        child: Padding(
          padding: EdgeInsets.symmetric(vertical: 15.0, horizontal: 28.0),
          child: Text(
            // Update the currency name depending on the selectedCurrency.
            '1 $cryptoCurrency = $value $selectedCurrency',
            textAlign: TextAlign.center,
            style: TextStyle(
              fontSize: 20.0,
              color: Colors.white,
            ),
          ),
        ),
      ),
    );
  }
}
```
* coin_data.dart
```java
import 'dart:convert';
import 'package:http/http.dart' as http;

const List<String> currenciesList = [
  'AUD',
  'BRL',
  'CAD',
  'CNY',
  'EUR',
  'GBP',
  'HKD',
  'IDR',
  'ILS',
  'INR',
  'JPY',
  'MXN',
  'NOK',
  'NZD',
  'PLN',
  'RON',
  'RUB',
  'SEK',
  'SGD',
  'USD',
  'ZAR'
];
// contains a List of Strings that represent 3 cryptocurrency symbols.
// BTC - Bitcoin, ETH - Ethereum and LTC - Litecoin
const List<String> cryptoList = ['BTC', 'ETH', 'LTC'];
// url API
const coinAPIURL = 'https://rest.coinapi.io/v1/exchangerate';
const apiKey = 'YOUR-API-KEY-HERE';

class CoinData {
  // Create the Asynchronous method getCoinData() that returns a Future (the price data).
  Future getCoinData(String selectedCurrency) async {
    // Return a Map of the results instead of a single value.
    Map<String, String> cryptoPrices = {};
    // Use a for loop here to loop through the cryptoList and request the data for each of them in turn.
    for (String crypto in cryptoList) {
      // Update the URL to use the crypto symbol from the cryptoList
      String requestURL =
          '$coinAPIURL/$crypto/$selectedCurrency?apikey=$apiKey';
      http.Response response = await http.get(requestURL);
      if (response.statusCode == 200) {
        // Use the 'dart:convert' package to decode the JSON data that comes back from coinapi.io
        var decodedData = jsonDecode(response.body);
        double price = decodedData['rate'];
        // Create a new key value pair, with the key being the crypto symbol
        // and the value being the lastPrice of that crypto currency.
        cryptoPrices[crypto] = price.toStringAsFixed(0); // supprime les d√©cimales (5.25 => 5)
      } else {
        // Handle any errors that occur during the request.
        print(response.statusCode);
        // Optional: throw an error if our request fails.
        throw 'Problem with the get request';
      }
    }
    return cryptoPrices;
  }
}
```

## BOOTCAMP FLASH CHAT
* Application de Chat avec Firebase
* Hero Animations : https://flutter.dev/docs/development/ui/animations/hero-animations
```java
// Hero 1
Hero(
  // tag permet l'association avec le 2√®me Hero
  tag: 'logo',
  child: Container(
    child: Image.asset('images/logo.png'),
    height: 60.0,
  ),
),

// le lien entre les 2
RoundedButton(
  title: 'Register',
  colour: Colors.blueAccent,
  onPressed: () {
    // pushNamed + id property
    Navigator.pushNamed(context, RegistrationScreen.id);
  },
)

// Hero 2
Flexible(
  child: Hero(
    tag: 'logo',
    child: Container(
      height: 200.0,
      child: Image.asset('images/logo.png'),
    ),
  ),
),                
```
* Curves Class Documentation : https://api.flutter.dev/flutter/animation/Curves-class.html
* CurvedAnimation Class Documentation : https://docs.flutter.io/flutter/animation/CurvedAnimation-class.html
* Tween Animation Class : https://docs.flutter.io/flutter/animation/Tween-class.html
* https://pub.dev/flutter/packages?q=animate
* Showing a Spinner: The Modal Progress HUD : https://pub.dev/packages/modal_progress_hud
* Firebase Documentation : https://firebase.google.com/docs/
* Structure :
```py
Flash-Chat-Flutter-Complete/
  lib/
    components/
      rounded_button.dart
    screens/
      chat_screen.dart
      login_screen.dart
      registration_screen.dart
      welcome_screen.dart
    constants.dart
    main.dart
  pubspec.yaml
```
* pubspec.yaml
```yaml
name: flash_chat
description: A new Flutter application.

version: 1.0.0+1

environment:
  sdk: ">=2.0.0 <3.0.0"

dependencies:
  flutter:
    sdk: flutter

  cupertino_icons: ^0.1.2
  animated_text_kit: ^1.3.0 # text animation
  firebase_core: ^0.3.4 # obligatoire pour toute application firebase
  firebase_auth: ^0.8.4+4
  cloud_firestore: ^0.9.13+1
  modal_progress_hud: ^0.1.3 # loading spinner

dev_dependencies:
  flutter_test:
    sdk: flutter

flutter:
  uses-material-design: true

  assets:
  - images/
```
* constants.dart
```java
import 'package:flutter/material.dart';

const kSendButtonTextStyle = TextStyle(
  color: Colors.lightBlueAccent,
  fontWeight: FontWeight.bold,
  fontSize: 18.0,
);

const kMessageTextFieldDecoration = InputDecoration(
  contentPadding: EdgeInsets.symmetric(vertical: 10.0, horizontal: 20.0),
  hintText: 'Type your message here...',
  border: InputBorder.none,
);

const kMessageContainerDecoration = BoxDecoration(
  border: Border(
    top: BorderSide(color: Colors.lightBlueAccent, width: 2.0),
  ),
);

const kTextFieldDecoration = InputDecoration(
  // ‚Üì valeur de base
  hintText: 'Enter a value',
  contentPadding: EdgeInsets.symmetric(vertical: 10.0, horizontal: 20.0),
  border: OutlineInputBorder(
    borderRadius: BorderRadius.all(Radius.circular(32.0)),
  ),
  enabledBorder: OutlineInputBorder(
    borderSide: BorderSide(color: Colors.blueAccent, width: 1.0),
    borderRadius: BorderRadius.all(Radius.circular(32.0)),
  ),
  focusedBorder: OutlineInputBorder(
    borderSide: BorderSide(color: Colors.blueAccent, width: 2.0),
    borderRadius: BorderRadius.all(Radius.circular(32.0)),
  ),
);
```
* main.dart
```java
import 'package:flutter/material.dart';
import 'package:flash_chat/screens/welcome_screen.dart';
import 'package:flash_chat/screens/login_screen.dart';
import 'package:flash_chat/screens/registration_screen.dart';
import 'package:flash_chat/screens/chat_screen.dart';

void main() => runApp(FlashChat());

class FlashChat extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      initialRoute: WelcomeScreen.id,
      // routes nominatives moins sujette √† l'erreur
      routes: {
        // static const String id = 'welcome_screen';
        // gr√¢ce √† static, pas besoin de cr√©er un objet WelcomeScreen()
        WelcomeScreen.id: (context) => WelcomeScreen(),
        LoginScreen.id: (context) => LoginScreen(),
        RegistrationScreen.id: (context) => RegistrationScreen(),
        ChatScreen.id: (context) => ChatScreen(),
      },
    );
  }
}
```
* screens/welcome_screen.dart
```java
import 'package:flutter/material.dart';
import 'login_screen.dart';
import 'registration_screen.dart';
import 'package:animated_text_kit/animated_text_kit.dart';
import 'package:flash_chat/components/rounded_button.dart';

class WelcomeScreen extends StatefulWidget {
  static const String id = 'welcome_screen';

  @override
  _WelcomeScreenState createState() => _WelcomeScreenState();
}

class _WelcomeScreenState extends State<WelcomeScreen>
    with SingleTickerProviderStateMixin {
  // ‚Üë add ability to act like a ticker for a single animation
  // TickerProviderStateMixin for multiple animations
  // un mixin (ou plusieurs) ajoute une capacit√© √† la classe
  AnimationController controller;
  Animation animation;

  @override
  void initState() {
    super.initState();
    // ‚Üì manager de l'application
    controller =
        AnimationController(
            // dur√©e de l'animation
            duration: Duration(seconds: 1),
            // ticker (minuteur) = this object
            vsync: this,
            // upperBound: 100, + Text('${controller.value.toInt()}%') pour cr√©er un compte √† rebours
        );
    // controller.value va d√©buter √† 0 (lowerBound) et finir √† 1 (upperBound)

    // animation = CurvedAnimation(parent: controller, curve: Curves.decelerate);
    // sp√©cificit√© = lowerBound doit √™tre √† 0, upperBound √† 1
    // pour utiliser la valeur de l'animation, utiliser animation.value
    // ex. Container(height: animation.value * 100, )
    // le container va grandir selon le choix de la courbe

    // widget avec une couleur de fin et une couleur de d√©but
    // Tween = widget avec une valeur de d√©but et une valeur de fin
    // et un processus qui relie les deux valeurs de fa√ßon fluide
    animation = ColorTween(begin: Colors.blueGrey, end: Colors.white)
        .animate(controller);

    // cr√©er une boucle
    animation.addStatusListener((status) {
      // dismissed for reverse animation ‚Üì
      if (status == AnimationStatus.completed) {
        controller.reverse(from: 1.0); // revient en arri√®re
      } else if (status == AnimationStatus.dismissed) {
        controller.forward(); // repart en avant
      }
    });

    controller.forward(); // de value = 0 (lowerBound) √† value = 1 (upperBound)
    // (reverse(from: 1.0) pour aller de 1 √† 0)

    // ‚Üì called every time the value changes
    controller.addListener(() {
      setState(() {}); // change the widget where the value is stored
      // (backgroundColor of Scaffold begin 'blueGrey' and finish 'white'
    });
  }

  // d√©truit notre animation
  // lors de la destruction de notre page
  // important pour la performance de l'appli
  @override
  void dispose() {
    controller.dispose(); // d√©truit notre manager
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: animation.value, // change with the changes of animation value
      body: Padding(
        padding: EdgeInsets.symmetric(horizontal: 24.0),
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          crossAxisAlignment: CrossAxisAlignment.stretch,
          children: <Widget>[
            Row(
              children: <Widget>[
                // Hero animation
                Hero(
                  // tag permet l'association avec le 2√®me Hero
                  tag: 'logo',
                  child: Container(
                    child: Image.asset('images/logo.png'),
                    height: 60.0,
                  ),
                ),
                // ‚Üì text animati_ (one by one character of the list called 'text')
                TypewriterAnimatedTextKit(
                  text: ['Flash Chat'],
                  textStyle: TextStyle(
                    fontSize: 45.0,
                    fontWeight: FontWeight.w900,
                  ),
                ),
              ],
            ),
            SizedBox(
              height: 48.0,
            ),
            RoundedButton(
              title: 'Log In',
              colour: Colors.lightBlueAccent,
              onPressed: () {
                // pushNamed + id property
                Navigator.pushNamed(context, LoginScreen.id);
              },
            ),
            RoundedButton(
              title: 'Register',
              colour: Colors.blueAccent,
              onPressed: () {
                // pushNamed + id property
                Navigator.pushNamed(context, RegistrationScreen.id);
              },
            ),
          ],
        ),
      ),
    );
  }
}
```
* screens/registration_screen.dart
```java
import 'package:flutter/material.dart';
import 'package:flash_chat/components/rounded_button.dart';
import 'package:flash_chat/constants.dart';
import 'package:firebase_auth/firebase_auth.dart';
import 'chat_screen.dart';
import 'package:modal_progress_hud/modal_progress_hud.dart'; // loading spinner

class RegistrationScreen extends StatefulWidget {
  static const String id = 'registration_screen';
  @override
  _RegistrationScreenState createState() => _RegistrationScreenState();
}

class _RegistrationScreenState extends State<RegistrationScreen> {
  final _auth = FirebaseAuth.instance; // authentication of Firebase
  bool showSpinner = false;
  String email;
  String password;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: Colors.white,
      body: ModalProgressHUD( // loading spinner for the all page
        inAsyncCall: showSpinner, // loading spinner = false for starting
        child: Padding(
          padding: EdgeInsets.symmetric(horizontal: 24.0),
          child: Column(
            mainAxisAlignment: MainAxisAlignment.center,
            crossAxisAlignment: CrossAxisAlignment.stretch,
            children: <Widget>[
              // ‚Üì si 200px n'est pas disponible, alors le widget s'adapte
              Flexible(
                child: Hero(
                  tag: 'logo',
                  child: Container(
                    height: 200.0,
                    child: Image.asset('images/logo.png'),
                  ),
                ),
              ),
              SizedBox(
                height: 48.0,
              ),
              TextField(
                // ‚Üì keyboard sp√©cial mail
                keyboardType: TextInputType.emailAddress,
                textAlign: TextAlign.center,
                onChanged: (value) {
                  email = value;
                },
                decoration:
                    // inputDecoration personnalis√©e
                    kTextFieldDecoration.copyWith(hintText: 'Enter your email'),
              ),
              SizedBox(
                height: 8.0,
              ),
              TextField(
                obscureText: true, // textfield secret ‚Ä¢‚Ä¢‚Ä¢‚Ä¢
                textAlign: TextAlign.center,
                onChanged: (value) {
                  password = value;
                },
                decoration: kTextFieldDecoration.copyWith(
                    hintText: 'Enter your password'),
              ),
              SizedBox(
                height: 24.0,
              ),
              RoundedButton(
                title: 'Register',
                colour: Colors.blueAccent,
                onPressed: () async {
                  setState(() {
                    showSpinner = true; // activate the loading spinner
                  });
                  try {
                    final newUser = await _auth.createUserWithEmailAndPassword(
                        email: email, password: password);
                    if (newUser != null) {
                      Navigator.pushNamed(context, ChatScreen.id);
                    }

                    setState(() {
                      showSpinner = false; // deactivate the loading spinner
                    });
                  } catch (e) {
                    print(e);
                  }
                },
              ),
            ],
          ),
        ),
      ),
    );
  }
}
```
* screens/login_screen.dart
```java
import 'package:flutter/material.dart';
import 'package:flash_chat/components/rounded_button.dart';
import 'package:flash_chat/constants.dart';
import 'package:firebase_auth/firebase_auth.dart';
import 'chat_screen.dart';
import 'package:modal_progress_hud/modal_progress_hud.dart';

class LoginScreen extends StatefulWidget {
  static const String id = 'login_screen';
  @override
  _LoginScreenState createState() => _LoginScreenState();
}

class _LoginScreenState extends State<LoginScreen> {
  bool showSpinner = false;
  final _auth = FirebaseAuth.instance;
  String email;
  String password;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: Colors.white,
      body: ModalProgressHUD(
        inAsyncCall: showSpinner,
        child: Padding(
          padding: EdgeInsets.symmetric(horizontal: 24.0),
          child: Column(
            mainAxisAlignment: MainAxisAlignment.center,
            crossAxisAlignment: CrossAxisAlignment.stretch,
            children: <Widget>[
              Flexible(
                child: Hero(
                  tag: 'logo',
                  child: Container(
                    height: 200.0,
                    child: Image.asset('images/logo.png'),
                  ),
                ),
              ),
              SizedBox(
                height: 48.0,
              ),
              TextField(
                keyboardType: TextInputType.emailAddress,
                textAlign: TextAlign.center,
                onChanged: (value) {
                  email = value;
                },
                decoration:
                    kTextFieldDecoration.copyWith(hintText: 'Enter your email'),
              ),
              SizedBox(
                height: 8.0,
              ),
              TextField(
                obscureText: true,
                textAlign: TextAlign.center,
                onChanged: (value) {
                  password = value;
                },
                decoration: kTextFieldDecoration.copyWith(
                    hintText: 'Enter your password'),
              ),
              SizedBox(
                height: 24.0,
              ),
              RoundedButton(
                title: 'Log In',
                colour: Colors.lightBlueAccent,
                onPressed: () async {
                  setState(() {
                    showSpinner = true;
                  });
                  try {
                    final user = await _auth.signInWithEmailAndPassword(
                        email: email, password: password);
                    if (user != null) {
                      Navigator.pushNamed(context, ChatScreen.id);
                    }

                    setState(() {
                      showSpinner = false;
                    });
                  } catch (e) {
                    print(e);
                  }
                },
              ),
            ],
          ),
        ),
      ),
    );
  }
}
```
* screens/chat_screen.dart
```java
import 'package:flutter/material.dart';
import 'package:flash_chat/constants.dart';
import 'package:firebase_auth/firebase_auth.dart';
import 'package:cloud_firestore/cloud_firestore.dart';

// d√©plac√©s ici pour que toutes les classes y aient acc√®s
final _firestore = Firestore.instance; // instance pour envoyer les messages sur le cloud
FirebaseUser loggedInUser; // instance pour r√©cup√©rer l'utilisateur courant

class ChatScreen extends StatefulWidget {
  static const String id = 'chat_screen';
  @override
  _ChatScreenState createState() => _ChatScreenState();
}

class _ChatScreenState extends State<ChatScreen> {
  // controller of a text field
  final messageTextController = TextEditingController();
  final _auth = FirebaseAuth.instance;

  String messageText;

  @override
  void initState() {
    super.initState();

    getCurrentUser();
  }

  void getCurrentUser() async {
    try {
      final user = await _auth.currentUser();
      if (user != null) {
        loggedInUser = user;
      }
    } catch (e) {
      print(e);
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        leading: null,
        actions: <Widget>[
          IconButton(
              icon: Icon(Icons.close),
              onPressed: () {
                _auth.signOut();
                Navigator.pop(context);
              }),
        ],
        title: Text('‚ö°Ô∏èChat'),
        backgroundColor: Colors.lightBlueAccent,
      ),
      body: SafeArea( // Afficher le contenu dans la partie visible de l'√©cran
        child: Column(
          mainAxisAlignment: MainAxisAlignment.spaceBetween,
          crossAxisAlignment: CrossAxisAlignment.stretch,
          children: <Widget>[
            MessagesStream(),
            Container(
              decoration: kMessageContainerDecoration,
              child: Row(
                crossAxisAlignment: CrossAxisAlignment.center,
                children: <Widget>[
                  Expanded(
                    child: TextField(
                      controller: messageTextController, // 1. add controller
                      onChanged: (value) {
                        messageText = value;
                      },
                      decoration: kMessageTextFieldDecoration,
                    ),
                  ),
                  FlatButton(
                    onPressed: () {
                      messageTextController.clear(); // 2. use controller to clear TextField
                      _firestore.collection('messages').add({
                        'text': messageText,
                        'sender': loggedInUser.email,
                      });
                    },
                    child: Text(
                      'Send',
                      style: kSendButtonTextStyle,
                    ),
                  ),
                ],
              ),
            ),
          ],
        ),
      ),
    );
  }
}

class MessagesStream extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    // StreamBuilder of QuerySnapshot (Firebase class)
    // because snapshots = Stream<QuerySnapshot>
    // so a snapshot = QuerySnapshot
    return StreamBuilder<QuerySnapshot>(
      // ‚Üì where's the date coming from ?
      stream: _firestore.collection('messages').snapshots(),
      builder: (context, snapshot) {
        if (!snapshot.hasData) {
          return Center(
            child: CircularProgressIndicator(
              backgroundColor: Colors.lightBlueAccent,
            ),
          );
        }
        // ‚Üì l'ensemble des documents du snapshot (tous les messages)
        // en commen√ßant par les plus r√©cents
        final messages = snapshot.data.documents.reversed;
        List<MessageBubble> messageBubbles = [];
        // messages = liste de map<'text': String, 'sender': String>
        for (var message in messages) {
          final messageText = message.data['text'];
          final messageSender = message.data['sender'];

          final currentUser = loggedInUser.email;

          final messageBubble = MessageBubble(
            sender: messageSender,
            text: messageText,
            isMe: currentUser == messageSender,
          );

          messageBubbles.add(messageBubble);
        }
        return Expanded(
          child: ListView(
            reverse: true, // affichage de la liste focalis√© sur la fin de liste
            padding: EdgeInsets.symmetric(horizontal: 10.0, vertical: 20.0),
            children: messageBubbles,
          ),
        );
      },
    );
  }
}

class MessageBubble extends StatelessWidget {
  MessageBubble({this.sender, this.text, this.isMe});

  final String sender;
  final String text;
  final bool isMe;

  @override
  Widget build(BuildContext context) {
    return Padding(
      padding: EdgeInsets.all(10.0),
      child: Column(
        crossAxisAlignment:
            isMe ? CrossAxisAlignment.end : CrossAxisAlignment.start,
        children: <Widget>[
          Text(
            sender,
            style: TextStyle(
              fontSize: 12.0,
              color: Colors.black54,
            ),
          ),
          // ‚Üì widget de base, auquel on peut ajouter de la couleur, elevation, ect.
          Material(
            borderRadius: isMe
                ? BorderRadius.only(
                    topLeft: Radius.circular(30.0),
                    bottomLeft: Radius.circular(30.0),
                    bottomRight: Radius.circular(30.0))
                : BorderRadius.only(
                    bottomLeft: Radius.circular(30.0),
                    bottomRight: Radius.circular(30.0),
                    topRight: Radius.circular(30.0),
                  ),
            elevation: 5.0,
            color: isMe ? Colors.lightBlueAccent : Colors.white,
            child: Padding(
              padding: EdgeInsets.symmetric(vertical: 10.0, horizontal: 20.0),
              child: Text(
                text,
                style: TextStyle(
                  color: isMe ? Colors.white : Colors.black54,
                  fontSize: 15.0,
                ),
              ),
            ),
          ),
        ],
      ),
    );
  }
}
```
* components/rounded_button.dart
```java
import 'package:flutter/material.dart';

class RoundedButton extends StatelessWidget {
  RoundedButton({this.title, this.colour, @required this.onPressed});

  final Color colour;
  final String title;
  final Function onPressed;

  @override
  Widget build(BuildContext context) {
    return Padding(
      padding: EdgeInsets.symmetric(vertical: 16.0),
      child: Material(
        elevation: 5.0,
        color: colour,
        borderRadius: BorderRadius.circular(30.0),
        child: MaterialButton(
          onPressed: onPressed,
          minWidth: 200.0,
          height: 42.0,
          child: Text(
            title,
            style: TextStyle(
              color: Colors.white,
            ),
          ),
        ),
      ),
    );
  }
}
```

## BOOTCAMP TODOEY
* Application de TODO
* Flutter BottomSheet Class : https://api.flutter.dev/flutter/material/BottomSheet-class.html
* The Provider Package : https://pub.dev/packages/provider
* Provider package =  recommandation de l'√©quipe de Google pour g√©rer le State d'une application
* Avec Provider, certains widgets peuvent s'abonner √† un State, ce qui √©vite que l'information traverse TOUS les widgets s'intercalant entre le widget qui a besoin de l'information et la source d'information
* Provider permet une circulation limit√©e de l'information, ce qui fait que moins de Widgets sont modifi√©s en cons√©quence, et la performance de l'application se trouve grandement am√©lior√©e
* Le Provider doit √™tre plac√© le plus haut possible dans le widget tree pour que les descendants qui ont besoin de l'information y aient acc√®s
* 
```
      ‚óò -- State
      ‚Üì‚Üí ‚óò level 1, qui appelle level 2
        ‚Üì‚Üí ‚óò level 2, qui appelle level 3 
          ‚Üì‚Üí ‚óò level 3 -- widget qui s'abonne au State
```
Ex. un level 3 s'abonne √† un State (haut de la pyramide) > le State change > level 3 est notifi√© > il est modifi√©/reconstruit, sans que level 1 et level 2 ne subissent √©galement une reconstruction
* The InheritedWidget Class : https://api.flutter.dev/flutter/widgets/InheritedWidget-class.html
* InheritedWidget : widget qui permet de faire passer des donn√©es dans les diff√©rents niveaux du tree sans modifier les widgets interm√©diaires
* Positioning the BottomSheet above the Keyboard :
```java
// By default, the BottomSheet will take up half the screen:
onPressed: () {
  showModalBottomSheet(
    context: context,
    builder: (context) => AddTaskScreen(),
  );
}

// For certain screen sizes, this may mean the Add button is obscured. 
// Setting the isScrolledControlled property to true you can make the modal take up the full screen:
onPressed: () {
  showModalBottomSheet(
    context: context,
    isScrollControlled: true,
    builder: (context) => AddTaskScreen(),
  );
}

// To have the AddTaskScreen sit just above the keyboard, you can wrap it inside 
// SingleChildScrollView, which determines the padding at the bottom using a MediaQuery
onPressed: () {
  showModalBottomSheet(
    context: context,
    isScrollControlled: true,
    builder: (context) => SingleChildScrollView(
      child:Container(
        padding: EdgeInsets.only(bottom: MediaQuery.of(context).viewInsets.bottom),
        // ajoute un padding bottom qui fait la taille du keyboard
        // et permet de se placer par-dessus
        // When a mobile device's keyboard is visible viewInsets.bottom corresponds 
        // to the top of the keyboard
        child: AddTaskScreen(),
      )
    )
  );
}
```
* Structure :
```py
todoey-flutter/
  lib/
    models/
      task.dart
      task_data.dart
    screens/
      add_task_screen.dart
      tasks_screen.dart
    widgets/
      task_tile.dart
      tasks_list.dart
    main.dart
  pubspec.yaml
```
* pubspec.yaml
```yaml
name: todoey_flutter
description: A new Flutter application.

version: 1.0.0+1

environment:
  sdk: ">=2.1.0 <3.0.0"

dependencies:
  flutter:
    sdk: flutter

  # The following adds the Cupertino Icons font to your application.
  # Use with the CupertinoIcons class for iOS style icons.
  cupertino_icons: ^0.1.2
  provider: ^3.0.0+1 # ++

dev_dependencies:
  flutter_test:
    sdk: flutter


# For information on the generic Dart part of this file, see the
# following page: https://dart.dev/tools/pub/pubspec

# The following section is specific to Flutter.
flutter:

  # The following line ensures that the Material Icons font is
  # included with your application, so that you can use the icons in
  # the material Icons class.
  uses-material-design: true
```
* main.dart
```java
import 'package:flutter/material.dart';
import 'package:todoey_flutter/screens/tasks_screen.dart';
import 'package:provider/provider.dart';
import 'package:todoey_flutter/models/task_data.dart';

void main() => runApp(MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    // ‚Üì permet de s'abonner √† des donn√©es
    // qui, lorsqu'elles sont modifi√©es,
    // vont cr√©er une notification
    return ChangeNotifierProvider(
      // ici plac√© tout en haut du widget tree,
      // tous les widgets descendants y ont acc√®s
      builder: (context) => TaskData(),
      // ‚Üë TaskData est la donn√©e √† √©couter
      // elle est √† pr√©sent √©coutable dans toute l'application
      // le widget qui √©coute TaskData sera inform√© de ses changements
      child: MaterialApp(
        home: TasksScreen(),
      ),
    );
  }
}
```
* screens/tasks_screen.dart
```java
import 'package:flutter/material.dart';
import 'package:todoey_flutter/widgets/tasks_list.dart';
import 'package:todoey_flutter/screens/add_task_screen.dart';
import 'package:provider/provider.dart'; // importe Provider
import 'package:todoey_flutter/models/task_data.dart';

class TasksScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: Colors.lightBlueAccent,
      floatingActionButton: FloatingActionButton(
        backgroundColor: Colors.lightBlueAccent,
        child: Icon(Icons.add),
          onPressed: () {
          // d√©clenche un modal BottomSheet
            showModalBottomSheet(
                context: context,
                // ‚Üì make the modal take up the full screen
                isScrollControlled: true,
                // display a SingleChildScrollView
                // to have the AddTaskScreen sit just above the keyboard
                builder: (context) => SingleChildScrollView(
                    child:Container(
                      // which determines the padding at the bottom using a MediaQuery
                      padding: EdgeInsets.only(bottom: MediaQuery.of(context).viewInsets.bottom),
                      // ajoute un padding bottom qui fait la taille du keyboard
                      // et permet de se placer par-dessus
                      // When a mobile device's keyboard is visible viewInsets.bottom corresponds to the top of the keyboard
                      child: AddTaskScreen(),
                    )
                )
            );
          }
      ),
      body: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: <Widget>[
          Container(
            padding: EdgeInsets.only(
                top: 60.0, left: 30.0, right: 30.0, bottom: 30.0),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: <Widget>[
                CircleAvatar(
                  child: Icon(
                    Icons.list,
                    size: 30.0, // aggrandir le cercle
                    color: Colors.lightBlueAccent,
                  ),
                  backgroundColor: Colors.white,
                  radius: 30.0,
                ),
                SizedBox(
                  height: 10.0,
                ),
                Text(
                  'Todoey',
                  style: TextStyle(
                    color: Colors.white,
                    fontSize: 50.0,
                    fontWeight: FontWeight.w700,
                  ),
                ),
                Text(
                  // ‚Üì √©coute le provider (et son getter taskCount)
                  // pour se mettre √† jour √† chaque changement de la classe TaskData
                  '${Provider.of<TaskData>(context).taskCount} Tasks',
                  style: TextStyle(
                    color: Colors.white,
                    fontSize: 18,
                  ),
                ),
              ],
            ),
          ),
          Expanded(
            child: Container(
              padding: EdgeInsets.symmetric(horizontal: 20.0),
              decoration: BoxDecoration(
                color: Colors.white,
                borderRadius: BorderRadius.only(
                  topLeft: Radius.circular(20.0),
                  topRight: Radius.circular(20.0),
                ),
              ),
              child: TasksList(),
            ),
          ),
        ],
      ),
    );
  }
}
```
* screens/add_task_screen.dart
```java
import 'package:flutter/material.dart';
import 'package:todoey_flutter/models/task.dart';
import 'package:provider/provider.dart';
import 'package:todoey_flutter/models/task_data.dart';

class AddTaskScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    String newTaskTitle;

    return Container(
      // rend un background gris
      color: Color(0xff757575),
      // pour pouvoir donner une bordure ronde au container plac√© au-dessus
      child: Container(
        padding: EdgeInsets.all(20.0),
        decoration: BoxDecoration(
          color: Colors.white,
          borderRadius: BorderRadius.only(
              topLeft: Radius.circular(20.0),
            topRight: Radius.circular(20.0),
          ),
        ),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.stretch,
          children: <Widget>[
            Text(
              'Add Task',
              textAlign: TextAlign.center,
              style: TextStyle(
                fontSize: 30.0,
                color: Colors.lightBlueAccent,
              ),
            ),
            TextField(
              autofocus: true,
              // l'utilisateur est automatiquement dirig√© dans le TextField
              // ce qui ouvre instantan√©ment le clavier
              textAlign: TextAlign.center, // curseur au milieu
              onChanged: (newText) {
                newTaskTitle = newText;
              },
            ),
            FlatButton(
              child: Text(
                'Add',
                style: TextStyle(
                  color: Colors.white,
                ),
              ),
              color: Colors.lightBlueAccent,
              onPressed: () {
                // ‚Üì utilise le Provider et sa m√©thode qui avertit les √©couteurs
                // des changements dans la classe du Provider
                Provider.of<TaskData>(context).addTask(newTaskTitle);
                Navigator.pop(context);
              },
            ),
          ],
        ),
      ),
    );
  }
}
```
* widgets/tasks_list.dart
```java
import 'package:flutter/material.dart';
import 'package:todoey_flutter/widgets/task_tile.dart';
import 'package:provider/provider.dart';
import 'package:todoey_flutter/models/task_data.dart';

class TasksList extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    // enroule les widgets qui ont besoin d'√©couter et agir avec le provider
    // par un widget Consumer (qui provient de provider.dart)
    // qui √©vite de r√©p√©ter du code lourd
    // du genre Provider.of<TaskData>(context).tasks[index].name
    return Consumer<TaskData>( // sp√©cifie les donn√©es √† √©couter
      builder: (context, taskData, child) {
        // taskData = Provider.of<TaskData>(context)
        // quand taskData met √† jour son State,
        // ListView.builder est appel√© de nouveau
        return ListView.builder(
          itemBuilder: (context, index) {
            final task = taskData.tasks[index];
            return TaskTile(
              taskTitle: task.name, // + l√©ger
              isChecked: task.isDone,
              checkboxCallback: (checkboxState) {
                // ‚Üë callback de l'objet TaskTile
                // ‚Üì acc√®de √† la m√©thode de la classe de notre Provider
                taskData.updateTask(task);
                // isChecked = !isChecked
              },
              longPressCallback: () {
                // ‚Üì acc√®de √† la m√©thode de la classe de notre Provider
                taskData.deleteTask(task);
              },
            );
          },
          itemCount: taskData.taskCount, // _tasks.length
        );
      },
    );
  }
}
```
* widgets/task_tile.dart
```java
import 'package:flutter/material.dart';

class TaskTile extends StatelessWidget {
  // StatelessWidget = si le tile est amen√© √† changer,
  // l'objet TaskTile sera d√©truit et remplac√© par un autre objet TaskTile
  final bool isChecked;
  // ‚Üë global state = variable pr√©sente dans les widget Text() et Checkbox()
  final String taskTitle;
  final Function checkboxCallback;
  // ‚Üë pr√©sent ici car le Stateless emp√™che l'utilisation du setState()
  // utilis√© en amont dans tasks_list.dart
  // TaskTile(
  //   checkboxCallback: (checkboxState) {
  //     taskData.updateTask(task);
  //  },
  final Function longPressCallback;
  // si une de ses propri√©t√©s change,
  // l'objet TaskTile est d√©truit
  // puis remplac√© de nouveau gr√¢ce √† la fonction build

  TaskTile(
      {this.isChecked,
      this.taskTitle,
      this.checkboxCallback,
      this.longPressCallback});

  @override
  Widget build(BuildContext context) {
    return ListTile(
      onLongPress: longPressCallback,
      title: Text(
        taskTitle,
        style: TextStyle(
            // ‚Üì barr√© si checked
            decoration: isChecked ? TextDecoration.lineThrough : null),
      ),
      trailing: Checkbox(
        activeColor: Colors.lightBlueAccent,
        value: isChecked,
        onChanged: checkboxCallback,
      ),
    );
  }
}
```
* models/task.dart
```java
class Task {
  final String name;
  bool isDone;

  Task({this.name, this.isDone = false});

  void toggleDone() {
    isDone = !isDone;
  }
}
```
* models/task_data.dart
```java
import 'package:flutter/foundation.dart'; // utiliser ChangeNotifier
// (!) material.dart inclut foundation.dart
import 'package:todoey_flutter/models/task.dart';
import 'dart:collection';

// classe √† part pour pouvoir √™tre r√©cup√©r√©e
// partout dans l'application
// notamment dans AddTaskScreen() et TasksList()
class TaskData extends ChangeNotifier {
  // ChangeNotifier permet √† la classe de pouvoir √™tre √©cout√©e
  // partout dans l'application

  // _tasks est priv√©e pour forcer le dev √† utiliser les m√©thodes publiques
  // ex. addTask, plut√¥t que d'utiliser directement tasks.add(value)
  // la contrainte est l√† pour ne pas oublier la ligne notifyListeners()
  // minimise les erreurs
  List<Task> _tasks = [
    Task(name: 'Buy milk'),
    Task(name: 'Buy eggs'),
    Task(name: 'Buy bread'),
  ];

  // ‚Üì retourne une copie en read-only de la liste
  // pour une nouvelle fois √©viter toute action sur la liste de base
  // et utiliser les m√©thodes publiques √† la place
  UnmodifiableListView<Task> get tasks {
    return UnmodifiableListView(_tasks);
  }

  int get taskCount {
    return _tasks.length;
  }

  void addTask(String newTaskTitle) {
    final task = Task(name: newTaskTitle);
    _tasks.add(task);
    notifyListeners(); // envoie une notif' aux widgets qui √©coute la classe
    // ils sont alors reconstruits
  }

  void updateTask(Task task) {
    task.toggleDone();
    notifyListeners(); // envoie une notif' aux widgets qui √©coute la classe
    // ils sont alors reconstruits
  }

  void deleteTask(Task task) {
    _tasks.remove(task);
    notifyListeners(); // envoie une notif' aux widgets qui √©coute la classe
    // ils sont alors reconstruits
  }
}
```